<!DOCTYPE html>
<html lang="en"><head>
<script src="03_datawrangling_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_datawrangling_files/libs/quarto-html/tabby.min.js"></script>
<script src="03_datawrangling_files/libs/quarto-html/popper.min.js"></script>
<script src="03_datawrangling_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="03_datawrangling_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_datawrangling_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="03_datawrangling_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="David Rossell">
  <title>Modern Statistical Computing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="03_datawrangling_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="03_datawrangling_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="03_datawrangling_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="03_datawrangling_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="03_datawrangling_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="03_datawrangling_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="03_datawrangling_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Modern Statistical Computing</h1>
  <p class="subtitle">3. Data wrangling</p>
  <p class="author">David Rossell</p>
  <p class="institute">Pompeu Fabra University</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/dplyr-summary" id="/toc-dplyr-summary">dplyr summary</a></li>
<li><a href="#/summarizing-data" id="/toc-summarizing-data">Summarizing data</a></li>
<li><a href="#/further-examples" id="/toc-further-examples">Further examples</a></li>
<li><a href="#/exercise" id="/toc-exercise">Exercise</a></li>
<li><a href="#/data-import-and-export" id="/toc-data-import-and-export">Data import and export</a></li>
<li><a href="#/tidying-data" id="/toc-tidying-data">Tidying data</a></li>
<li><a href="#/relational-data" id="/toc-relational-data">Relational data</a></li>
</ul>
</nav>
</section>
<section id="reproducing-these-lecture-notes" class="slide level2">
<h2>Reproducing these lecture notes</h2>
<p>Load the required R packages.</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-1_5d14556fb9d9e666a276353dbc8b14f5">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lahman)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<p>Before doing data analysis you need to put data in the right format, define variables etc.</p>
<ul>
<li><p>R offers a number of base functions</p></li>
<li><p>Tidyverse package <code>dplyr</code> adds many convenient functions</p></li>
</ul>
</section>
<section id="dataset-nyc-flights" class="slide level2">
<h2>Dataset NYC flights</h2>
<p>All 336,776 flights departing from New York in 2013. We display a few rows (type <code>View(flights)</code> to open the full data in RStudio)</p>
<p>The data are stored in a <code>tibble</code>, an extension of <code>data.frame</code> that prints nicer and shows some info: <code>int</code> means integer, <code>dbl</code> real numbers, <code>chr</code> character vectors,<code>lgl</code> logical, <code>fctr</code> factor, <code>date</code> dates, <code>dttm</code> date-time</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-2_271668d7907ef5709e374b6d6edb2493">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</section>
<section>
<section id="dplyr-summary" class="title-slide slide level1 center">
<h1>dplyr summary</h1>
<p>The 5 main functions</p>
<ul>
<li><p>Select observations (rows) in a dataset: <code>filter()</code></p></li>
<li><p>Reorder the rows: <code>arrange()</code></p></li>
<li><p>Select variables by their names: <code>select()</code></p></li>
<li><p>Create new variables: <code>mutate()</code></p></li>
<li><p>Compute numerical summaries: <code>summarise()</code>. If used with <code>group_by()</code>, it operates by groups</p></li>
</ul>
<p>Other functions: <code>rename</code>, <code>transmute</code></p>
</section>
<section id="filter" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Filter</h2>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-3_bbd556e1fd480d268231e85b3884d926">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb4-1" class="hljs-ln-code"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>jan1<span class="ot">=</span> <span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span>, day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb4-2" class="hljs-ln-code"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>jan1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 842 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 832 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</section>
<section id="filter-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Filter</h2>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-4_1fa74c60a95b973a8863aacb00c0735f">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb6-1" class="hljs-ln-code"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>jan1<span class="ot">=</span> <span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> day <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb6-2" class="hljs-ln-code"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>jan1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 842 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 832 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</section>
<section id="data-frames-and-matrices" class="slide level2">
<h2>Data frames and matrices</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">data.frame</a></li><li><a href="#tabset-1-2">matrix</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-6_4d46202e853485e666b7035e098b6466">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>flightsdf<span class="ot">=</span> <span class="fu">as.data.frame</span>(flights)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(flightsdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> day <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 842 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 832 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<p><code>filter</code> doesn’t work on matrices</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-7_46a939610dfdc019bbadbf9bbddd5e8d">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>flightsm<span class="ot">=</span> <span class="fu">as.matrix</span>(flights[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flightsm, month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> day <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in UseMethod("filter"): no applicable method for 'filter' applied to an object of class "c('matrix', 'array', 'integer', 'numeric')"</code></pre>
</div>
</div>
<p>But we can easily select rows/columns with R’s base functionality</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-8_71a186a80b459e6259376e125ab543b4">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sel<span class="ot">=</span> (flights[,<span class="st">'month'</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">&amp;</span> (flightsm[,<span class="st">'day'</span>]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>flightsel<span class="ot">=</span> flightsm[sel,]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>flightsel[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     year month day
[1,] 2013     1   1
[2,] 2013     1   1
[3,] 2013     1   1
[4,] 2013     1   1
[5,] 2013     1   1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="missing-values" class="slide level2">
<h2>Missing values</h2>
<p><code>filter</code> returns rows where the specified criterion is <code>TRUE</code>. Missing’s (<code>NA</code>) are excluded</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-9_4a46c330626b8fa5d10b89702137df0c">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let x be Mary's age. We don't know how old she is.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> <span class="dv">20</span> <span class="co">#is Mary 20?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let y be John's age. We don't know how old he is.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> y <span class="co"># Are John and Mary the same age?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>To select rows with missing values, use <code>is.na</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-10_d73454cd497012d46da592cbc50c86eb">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df, <span class="fu">is.na</span>(x) <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 1
      x
  &lt;dbl&gt;
1    NA
2     3</code></pre>
</div>
</div>
</section>
<section id="arrange" class="slide level2">
<h2>Arrange</h2>
<p>You can sort by several variables</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-11_3d6f5330bc47f174d1d717a93612dbf7">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, year, month, day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p>To sort in a descending fashion use <code>desc</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-12_cc23b4d03c3e0e46f40ddee6d7772974">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(year), <span class="fu">desc</span>(month), <span class="fu">desc</span>(day))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013    12    31       13       2359      14     439     437       2 B6     
 2  2013    12    31       18       2359      19     449     444       5 DL     
 3  2013    12    31       26       2245     101     129    2353      96 B6     
 4  2013    12    31      459        500      -1     655     651       4 US     
 5  2013    12    31      514        515      -1     814     812       2 UA     
 6  2013    12    31      549        551      -2     925     900      25 UA     
 7  2013    12    31      550        600     -10     725     745     -20 AA     
 8  2013    12    31      552        600      -8     811     826     -15 EV     
 9  2013    12    31      553        600      -7     741     754     -13 DL     
10  2013    12    31      554        550       4    1024    1027      -3 B6     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</section>
<section id="rs-base-order" class="slide level2">
<h2>R’s base order</h2>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-13_ad5dab36693e94283e623db46eec772f">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>o<span class="ot">=</span> <span class="fu">order</span>(flights<span class="sc">$</span>year, flights<span class="sc">$</span>month, flights<span class="sc">$</span>day, <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>flights[o,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013    12    31       13       2359      14     439     437       2 B6     
 2  2013    12    31       18       2359      19     449     444       5 DL     
 3  2013    12    31       26       2245     101     129    2353      96 B6     
 4  2013    12    31      459        500      -1     655     651       4 US     
 5  2013    12    31      514        515      -1     814     812       2 UA     
 6  2013    12    31      549        551      -2     925     900      25 UA     
 7  2013    12    31      550        600     -10     725     745     -20 AA     
 8  2013    12    31      552        600      -8     811     826     -15 EV     
 9  2013    12    31      553        600      -7     741     754     -13 DL     
10  2013    12    31      554        550       4    1024    1027      -3 B6     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</section>
<section id="select" class="slide level2">
<h2>Select</h2>
<p>Selecting a subset of variables</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-14_43192b136697745772606e6f8a803abd">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year, month, day, dep_delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 4
    year month   day dep_delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;
 1  2013     1     1         2
 2  2013     1     1         4
 3  2013     1     1         2
 4  2013     1     1        -1
 5  2013     1     1        -6
 6  2013     1     1        -4
 7  2013     1     1        -5
 8  2013     1     1        -3
 9  2013     1     1        -3
10  2013     1     1        -2
# … with 336,766 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Useful functions to select variables by name</p>
<ul>
<li><p>starts_with(“abc”): matches names that begin with “abc”</p></li>
<li><p>ends_with(“abc”): matches names that end with “abc”</p></li>
<li><p>contains(“abc”): matches names that contain “abc”</p></li>
<li><p>num_range(“x”, 1:3): matches x1, x2 and x3.</p></li>
</ul>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-15_b2dfd6b8f95e0b73eedf8b9884bd7c13">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">contains</span>(<span class="st">"delay"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 2
   dep_delay arr_delay
       &lt;dbl&gt;     &lt;dbl&gt;
 1         2        11
 2         4        20
 3         2        33
 4        -1       -18
 5        -6       -25
 6        -4        12
 7        -5        19
 8        -3       -14
 9        -3        -8
10        -2         8
# … with 336,766 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Trick to put some columns at the start. Select them, then use <code>everything</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-16_aeae833704005fe9e4a251f9b4919c0a">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, time_hour, air_time, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
   time_hour           air_t…¹  year month   day dep_t…² sched…³ dep_d…⁴ arr_t…⁵
   &lt;dttm&gt;                &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;
 1 2013-01-01 05:00:00     227  2013     1     1     517     515       2     830
 2 2013-01-01 05:00:00     227  2013     1     1     533     529       4     850
 3 2013-01-01 05:00:00     160  2013     1     1     542     540       2     923
 4 2013-01-01 05:00:00     183  2013     1     1     544     545      -1    1004
 5 2013-01-01 06:00:00     116  2013     1     1     554     600      -6     812
 6 2013-01-01 05:00:00     150  2013     1     1     554     558      -4     740
 7 2013-01-01 06:00:00     158  2013     1     1     555     600      -5     913
 8 2013-01-01 06:00:00      53  2013     1     1     557     600      -3     709
 9 2013-01-01 06:00:00     140  2013     1     1     557     600      -3     838
10 2013-01-01 06:00:00     138  2013     1     1     558     600      -2     753
# … with 336,766 more rows, 10 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, and abbreviated
#   variable names ¹​air_time, ²​dep_time, ³​sched_dep_time, ⁴​dep_delay, ⁵​arr_time</code></pre>
</div>
</div>
</section>
<section id="rename" class="slide level2">
<h2>Rename</h2>
<p>Change variable names</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-17_291de3c879aa3f74e592e06be38070de">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(flights, <span class="at">deptime =</span> dep_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day deptime sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1     517         515       2     830     819      11 UA     
 2  2013     1     1     533         529       4     850     830      20 UA     
 3  2013     1     1     542         540       2     923     850      33 AA     
 4  2013     1     1     544         545      -1    1004    1022     -18 B6     
 5  2013     1     1     554         600      -6     812     837     -25 DL     
 6  2013     1     1     554         558      -4     740     728      12 UA     
 7  2013     1     1     555         600      -5     913     854      19 B6     
 8  2013     1     1     557         600      -3     709     723     -14 EV     
 9  2013     1     1     557         600      -3     838     846      -8 B6     
10  2013     1     1     558         600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</section>
<section id="mutate" class="slide level2">
<h2>Mutate</h2>
<p>We select a subset of columns and create 2 new ones</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-18_c2905a4711d4d4225ad2e9234293a576">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>flights_sml<span class="ot">=</span> <span class="fu">select</span>(flights, year<span class="sc">:</span>day, <span class="fu">contains</span>(<span class="st">"delay"</span>), distance, air_time)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(flights_sml, <span class="at">gain=</span>dep_delay <span class="sc">-</span> arr_delay, <span class="at">speed =</span> distance <span class="sc">/</span> air_time <span class="sc">*</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 9
    year month   day dep_delay arr_delay distance air_time  gain speed
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227    -9  370.
 2  2013     1     1         4        20     1416      227   -16  374.
 3  2013     1     1         2        33     1089      160   -31  408.
 4  2013     1     1        -1       -18     1576      183    17  517.
 5  2013     1     1        -6       -25      762      116    19  394.
 6  2013     1     1        -4        12      719      150   -16  288.
 7  2013     1     1        -5        19     1065      158   -24  404.
 8  2013     1     1        -3       -14      229       53    11  259.
 9  2013     1     1        -3        -8      944      140     5  405.
10  2013     1     1        -2         8      733      138   -10  319.
# … with 336,766 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>To only keep the new variables use <code>transmute</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-19_9e5e7953feb241043576ae717e8296fb">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(flights, <span class="at">gain =</span> dep_delay <span class="sc">-</span> arr_delay, <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 2
    gain hours
   &lt;dbl&gt; &lt;dbl&gt;
 1    -9 3.78 
 2   -16 3.78 
 3   -31 2.67 
 4    17 3.05 
 5    19 1.93 
 6   -16 2.5  
 7   -24 2.63 
 8    11 0.883
 9     5 2.33 
10   -10 2.3  
# … with 336,766 more rows</code></pre>
</div>
</div>
</section>
<section id="beyond-trasmute" class="slide level2">
<h2>Beyond trasmute</h2>
<p>Sometimes easier to create a variable separately, then add it to the tibble</p>
<p><strong>Example.</strong> Companies get fined 100eur per hour of delay in departure, and 200eur/h of delay in arrival. There’s no reward for being early</p>
<ul>
<li><p>United airlines negotiates a discount from 100 to 75</p></li>
<li><p>American airlines gets a discount from 200 to 150</p></li>
</ul>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-20_653841e053205af099519c00787d75ff">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>uaflight<span class="ot">=</span> (flights<span class="sc">$</span>carrier <span class="sc">==</span> <span class="st">'UA'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>finedep<span class="ot">=</span> finearr<span class="ot">=</span> <span class="fu">double</span>(<span class="fu">nrow</span>(flights))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>finedep[uaflight]<span class="ot">=</span> <span class="dv">75</span> <span class="sc">*</span> flights<span class="sc">$</span>dep_delay[uaflight]<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>finedep[<span class="sc">!</span>uaflight]<span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> flights<span class="sc">$</span>dep_delay[<span class="sc">!</span>uaflight]<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>finedep[finedep<span class="sc">&lt;</span><span class="dv">0</span>]<span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>aaflight<span class="ot">=</span> flights<span class="sc">$</span>carrier <span class="sc">==</span> <span class="st">'AA'</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>finearr[aaflight]<span class="ot">=</span> <span class="dv">150</span> <span class="sc">*</span> flights<span class="sc">$</span>arr_delay[aaflight]<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>finearr[<span class="sc">!</span>aaflight] <span class="ot">=</span> <span class="dv">200</span> <span class="sc">*</span> flights<span class="sc">$</span>arr_delay[<span class="sc">!</span>aaflight]<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>finearr[finearr<span class="sc">&lt;</span><span class="dv">0</span>]<span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>flights<span class="sc">$</span>fine<span class="ot">=</span> finedep <span class="sc">+</span> finearr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Let’s inspect the results</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-21_6bfc424a8d8a839b2b1b7789601dff84">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, carrier, dep_delay, arr_delay, fine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 4
   carrier dep_delay arr_delay  fine
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 UA              2        11  39.2
 2 UA              4        20  71.7
 3 AA              2        33  85.8
 4 B6             -1       -18   0  
 5 DL             -6       -25   0  
 6 UA             -4        12  40  
 7 B6             -5        19  63.3
 8 EV             -3       -14   0  
 9 B6             -3        -8   0  
10 AA             -2         8  20  
# … with 336,766 more rows</code></pre>
</div>
</div>
</section></section>
<section>
<section id="summarizing-data" class="title-slide slide level1 center">
<h1>Summarizing data</h1>

</section>
<section id="overall-summaries" class="slide level2">
<h2>Overall summaries</h2>
<p>Package <code>skimr</code> provides a nice function <code>skim()</code> to compute basic stats for all variables in a dataset. <code>skim_with()</code> has further customization options</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-22_4f396c715a178d54438e8a63a5163955">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span> <span class="fu">skim</span>(flights)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">flights</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">336776</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">carrier</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tailnum</td>
<td style="text-align: right;">2512</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4043</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">origin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dest</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table style="width:100%;">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">year</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2013.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">2013.00</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">2013.00</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.55</td>
<td style="text-align: right;">3.41</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: left;">▇▆▆▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">15.71</td>
<td style="text-align: right;">8.77</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">16.00</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: left;">▇▇▇▇▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">dep_time</td>
<td style="text-align: right;">8255</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1349.11</td>
<td style="text-align: right;">488.28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">907</td>
<td style="text-align: right;">1401.00</td>
<td style="text-align: right;">1744</td>
<td style="text-align: right;">2400.00</td>
<td style="text-align: left;">▁▇▆▇▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sched_dep_time</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1344.25</td>
<td style="text-align: right;">467.34</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">1359.00</td>
<td style="text-align: right;">1729</td>
<td style="text-align: right;">2359.00</td>
<td style="text-align: left;">▁▇▇▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">dep_delay</td>
<td style="text-align: right;">8255</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">12.64</td>
<td style="text-align: right;">40.21</td>
<td style="text-align: right;">-43</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-2.00</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1301.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arr_time</td>
<td style="text-align: right;">8713</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1502.05</td>
<td style="text-align: right;">533.26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1104</td>
<td style="text-align: right;">1535.00</td>
<td style="text-align: right;">1940</td>
<td style="text-align: right;">2400.00</td>
<td style="text-align: left;">▁▃▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">sched_arr_time</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1536.38</td>
<td style="text-align: right;">497.46</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1124</td>
<td style="text-align: right;">1556.00</td>
<td style="text-align: right;">1945</td>
<td style="text-align: right;">2359.00</td>
<td style="text-align: left;">▁▃▇▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arr_delay</td>
<td style="text-align: right;">9430</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">6.90</td>
<td style="text-align: right;">44.63</td>
<td style="text-align: right;">-86</td>
<td style="text-align: right;">-17</td>
<td style="text-align: right;">-5.00</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1272.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">flight</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1971.92</td>
<td style="text-align: right;">1632.47</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">553</td>
<td style="text-align: right;">1496.00</td>
<td style="text-align: right;">3465</td>
<td style="text-align: right;">8500.00</td>
<td style="text-align: left;">▇▃▃▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">air_time</td>
<td style="text-align: right;">9430</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">150.69</td>
<td style="text-align: right;">93.69</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">129.00</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">695.00</td>
<td style="text-align: left;">▇▂▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">distance</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1039.91</td>
<td style="text-align: right;">733.23</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">502</td>
<td style="text-align: right;">872.00</td>
<td style="text-align: right;">1389</td>
<td style="text-align: right;">4983.00</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hour</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">13.18</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">23.00</td>
<td style="text-align: left;">▁▇▇▇▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">minute</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">26.23</td>
<td style="text-align: right;">19.30</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">29.00</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">59.00</td>
<td style="text-align: left;">▇▃▆▃▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fine</td>
<td style="text-align: right;">9430</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">78.09</td>
<td style="text-align: right;">189.10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">6408.33</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">time_hour</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2013-01-01 05:00:00</td>
<td style="text-align: left;">2013-12-31 23:00:00</td>
<td style="text-align: left;">2013-07-03 10:00:00</td>
<td style="text-align: right;">6936</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="summarizing-by-groups" class="slide level2">
<h2>Summarizing by groups</h2>
<p>Base R has <code>aggregate</code> to compute a single summary (e.g.&nbsp;the mean)</p>
<ul>
<li><p>For &gt;1 summaries <code>dplyr</code> is more convenient</p></li>
<li><p><code>dplyr</code> also runs faster</p></li>
</ul>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-23_e81fdc71b9b4a8d1cbf1b68dfa8e8a11">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(dep_delay <span class="sc">~</span> year <span class="sc">+</span> month <span class="sc">+</span> day, <span class="at">data=</span>flights, <span class="at">FUN=</span>mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    year month day   dep_delay
1   2013     1   1 11.54892601
2   2013     2   1 10.85290889
3   2013     3   1 11.01588983
4   2013     4   1 12.42143600
5   2013     5   1  2.90342679
6   2013     6   1  2.77822045
7   2013     7   1 56.23382520
8   2013     8   1 34.57403433
9   2013     9   1  4.23291492
10  2013    10   1 -0.09895833
11  2013    11   1 13.27291886
12  2013    12   1  9.00407747
13  2013     1   2 13.85882353
14  2013     2   2  5.42205882
15  2013     3   2  8.02652520
16  2013     4   2  8.26020408
17  2013     5   2  6.38854806
18  2013     6   2 34.01336574
19  2013     7   2 19.28509719
20  2013     8   2 13.25434116
21  2013     9   2 53.02955083
22  2013    10   2 -0.91991786
23  2013    11   2  0.24486804
24  2013    12   2  9.02197802
25  2013     1   3 10.98783186
26  2013     2   3  7.01886792
27  2013     3   3  6.06593407
28  2013     4   3  3.45252525
29  2013     5   3 14.18153527
30  2013     6   3 25.30969760
31  2013     7   3 24.29599178
32  2013     8   3 12.14643304
33  2013     9   3  6.97991543
34  2013    10   3 10.04133065
35  2013    11   3  2.14222222
36  2013    12   3  5.97525773
37  2013     1   4  8.95159516
38  2013     2   4 10.92407809
39  2013     3   4  4.75391032
40  2013     4   4  6.96326531
41  2013     5   4  8.82027027
42  2013     6   4  4.11192469
43  2013     7   4  4.34059946
44  2013     8   4  9.39045553
45  2013     9   4  0.60233298
46  2013    10   4  3.73407482
47  2013    11   4  2.36382323
48  2013    12   4  5.36631579
49  2013     1   5  5.73221757
50  2013     2   5  5.32272727
51  2013     3   5  5.01816239
52  2013     4   5  5.90510204
53  2013     5   5  4.57738749
54  2013     6   5  4.87875648
55  2013     7   5  4.85836386
56  2013     8   5  6.71543086
57  2013     9   5 -0.38779731
58  2013    10   5  3.53275109
59  2013    11   5 -0.18314256
60  2013    12   5 52.32799014
61  2013     1   6  7.14801444
62  2013     2   6  5.62150056
63  2013     3   6 21.01262626
64  2013     4   6  4.95052083
65  2013     5   6  7.59570113
66  2013     6   6  5.05675955
67  2013     7   6  7.02528445
68  2013     8   6  7.41515152
69  2013     9   6 -0.39792746
70  2013    10   6  4.28336980
71  2013    11   6  0.46376812
72  2013    12   6 16.13450937
73  2013     1   7  5.41720430
74  2013     2   7  6.49676724
75  2013     3   7 20.37074830
76  2013     4   7  2.85903084
77  2013     5   7  2.10714286
78  2013     6   7 27.54329004
79  2013     7   7 36.61744966
80  2013     8   7  8.68040201
81  2013     9   7 -0.25036390
82  2013    10   7 39.14670982
83  2013    11   7 13.55635988
84  2013    12   7  4.86032689
85  2013     1   8  2.55307263
86  2013     2   8 14.85589520
87  2013     3   8 83.53692115
88  2013     4   8  2.42430484
89  2013     5   8 43.21777778
90  2013     6   8  8.41321244
91  2013     7   8 37.29664570
92  2013     8   8 43.34994698
93  2013     9   8  2.08305648
94  2013    10   8  1.80625000
95  2013    11   8  4.11632653
96  2013    12   8 21.51533742
97  2013     1   9  2.27647715
98  2013     2   9 18.52577320
99  2013     3   9 11.27645503
100 2013     4   9  9.42708333
101 2013     5   9 20.71325052
102 2013     6   9  6.24172185
103 2013     7   9 30.71149897
104 2013     8   9 34.69189765
105 2013     9   9  0.79474216
106 2013    10   9  5.50258532
107 2013    11   9 -0.62885154
108 2013    12   9 34.80022075
109 2013     1  10  2.84499462
110 2013     2  10 15.17559153
111 2013     3  10 10.73311185
112 2013     4  10 33.02367531
113 2013     5  10 11.49175258
114 2013     6  10 30.61945032
115 2013     7  10 52.86070215
116 2013     8  10 10.00373134
117 2013     9  10  3.52187500
118 2013    10  10 19.49897541
119 2013    11  10  5.66591928
120 2013    12  10 26.46549391
121 2013     1  11  2.81719260
122 2013     2  11 39.07359813
123 2013     3  11  6.91197544
124 2013     4  11 25.41194969
125 2013     5  11 24.32859175
126 2013     6  11 13.50986501
127 2013     7  11 23.60939168
128 2013     8  11  7.20950324
129 2013     9  11  9.60369164
130 2013    10  11 31.23183761
131 2013    11  11  3.33877551
132 2013    12  11  7.05826271
133 2013     1  12  1.59649123
134 2013     2  12  4.66741826
135 2013     3  12 26.30684327
136 2013     4  12 34.83842795
137 2013     5  12  3.45566779
138 2013     6  12  5.46066253
139 2013     7  12 25.09615385
140 2013     8  12  8.30815710
141 2013     9  12 49.95875000
142 2013    10  12  5.24925816
143 2013    11  12  8.54668050
144 2013    12  12  7.52751817
145 2013     1  13 19.87315271
146 2013     2  13  3.66187845
147 2013     3  13  6.46480331
148 2013     4  13  6.42764016
149 2013     5  13  8.23432682
150 2013     6  13 45.79082774
151 2013     7  13 21.53500000
152 2013     8  13 22.99680511
153 2013     9  13 17.03388090
154 2013    10  13  5.34927697
155 2013    11  13  2.60307692
156 2013    12  13  5.25699482
157 2013     1  14  2.79265659
158 2013     2  14  5.61974790
159 2013     3  14 12.00305810
160 2013     4  14  7.97149123
161 2013     5  14  5.21518987
162 2013     6  14 21.93181818
163 2013     7  14 13.22594595
164 2013     8  14  9.01913394
165 2013     9  14  1.38888889
166 2013    10  14  4.09949239
167 2013    11  14  2.16227181
168 2013    12  14 28.36155203
169 2013     1  15  0.12372304
170 2013     2  15  5.93670886
171 2013     3  15 12.43563337
172 2013     4  15  4.90202020
173 2013     5  15 10.05473684
174 2013     6  15  8.75345912
175 2013     7  15  5.67907445
176 2013     8  15  9.22211055
177 2013     9  15  2.30493274
178 2013    10  15  4.53500522
179 2013    11  15  0.58697864
180 2013    12  15 19.57387057
181 2013     1  16 24.61286550
182 2013     2  16  7.00814111
183 2013     3  16 10.16601307
184 2013     4  16 10.19762419
185 2013     5  16 10.75942915
186 2013     6  16  6.35768811
187 2013     7  16 11.20626896
188 2013     8  16  8.02119072
189 2013     9  16  2.48174442
190 2013    10  16  0.60206186
191 2013    11  16  1.69620253
192 2013    12  16 11.74112735
193 2013     1  17  7.64814815
194 2013     2  17 10.34375000
195 2013     3  17  7.93429844
196 2013     4  17 12.05130890
197 2013     5  17  7.93367347
198 2013     6  17 25.32142857
199 2013     7  17 13.67070707
200 2013     8  17  6.54440154
201 2013     9  17 -0.09707724
202 2013    10  17 10.10898083
203 2013    11  17 21.87214612
204 2013    12  17 40.70560191
205 2013     1  18  6.76586433
206 2013     2  18  8.52592593
207 2013     3  18 30.11795962
208 2013     4  18 34.91536050
209 2013     5  18  4.02005348
210 2013     6  18 35.95076586
211 2013     7  18 20.62678937
212 2013     8  18  7.97461369
213 2013     9  18  2.32234809
214 2013    10  18  5.95262097
215 2013    11  18  5.58817427
216 2013    12  18 14.00839454
217 2013     1  19  3.47548291
218 2013     2  19 17.37823276
219 2013     3  19 23.60818084
220 2013     4  19 46.12782805
221 2013     5  19 25.82945736
222 2013     6  19  7.94364754
223 2013     7  19 19.37500000
224 2013     8  19  4.31919192
225 2013     9  19 13.73408624
226 2013    10  19 -0.10703812
227 2013    11  19  0.43904959
228 2013    12  19 16.37216495
229 2013     1  20  6.78388747
230 2013     2  20  9.46367521
231 2013     3  20  8.44409613
232 2013     4  20  7.77748344
233 2013     5  20 16.52004111
234 2013     6  20  3.71515152
235 2013     7  20 13.77904040
236 2013     8  20  5.92174797
237 2013     9  20  9.87155963
238 2013    10  20  1.61092896
239 2013    11  20  1.77663934
240 2013    12  20 17.26625387
241 2013     1  21  7.83185841
242 2013     2  21 10.60596379
243 2013     3  21 10.68036999
244 2013     4  21  7.77801959
245 2013     5  21 13.54105263
246 2013     6  21 10.00000000
247 2013     7  21 18.89438944
248 2013     8  21  2.87195122
249 2013     9  21  4.32318841
250 2013    10  21  0.95445344
251 2013    11  21  3.10932798
252 2013    12  21 20.34495641
253 2013     1  22 12.49943503
254 2013     2  22 12.07872340
255 2013     3  22 10.64542652
256 2013     4  22 30.64255319
257 2013     5  22 24.56060606
258 2013     6  22  7.91212871
259 2013     7  22 46.66704675
260 2013     8  22 33.60042061
261 2013     9  22  4.88235294
262 2013    10  22  1.83038502
263 2013    11  22 11.00805639
264 2013    12  22 29.23986486
265 2013     1  23 10.61036036
266 2013     2  23 11.61081081
267 2013     3  23 14.22120419
268 2013     4  23 19.75432900
269 2013     5  23 51.14471969
270 2013     6  23 12.57065217
271 2013     7  23 44.74168514
272 2013     8  23  5.55589431
273 2013     9  23  5.27152989
274 2013    10  23  0.97940268
275 2013    11  23  3.48582996
276 2013    12  23 32.25414938
277 2013     1  24 19.46542261
278 2013     2  24  6.80482204
279 2013     3  24 15.03919373
280 2013     4  24 18.89293362
281 2013     5  24 30.34071730
282 2013     6  24 47.15741789
283 2013     7  24 15.95939086
284 2013     8  24  4.12823834
285 2013     9  24 -1.32983193
286 2013    10  24  3.57591093
287 2013    11  24 14.68961625
288 2013    12  24  6.76595745
289 2013     1  25 21.89853439
290 2013     2  25  6.19936709
291 2013     3  25 22.16255605
292 2013     4  25 23.33956386
293 2013     5  25 11.42365887
294 2013     6  25 43.06302521
295 2013     7  25 19.67413442
296 2013     8  25  5.76444444
297 2013     9  25  0.47412008
298 2013    10  25 10.06903553
299 2013    11  25  3.31590181
300 2013    12  25  7.55244755
301 2013     1  26  7.21311475
302 2013     2  26  7.80374862
303 2013     3  26  2.17476732
304 2013     4  26 18.59244127
305 2013     5  26  0.24142661
306 2013     6  26 30.61175236
307 2013     7  26 12.06268959
308 2013     8  26  4.45081967
309 2013     9  26  2.36958711
310 2013    10  26  5.04105572
311 2013    11  26  7.97464503
312 2013    12  26 14.41720430
313 2013     1  27  8.37794300
314 2013     2  27 37.76327434
315 2013     3  27  2.78666667
316 2013     4  27  3.12582781
317 2013     5  27  3.05070119
318 2013     6  27 40.89123196
319 2013     7  27  8.02357320
320 2013     8  27  3.29540710
321 2013     9  27  3.61693548
322 2013    10  27  6.24145535
323 2013    11  27 16.69765066
324 2013    12  27 10.93762994
325 2013     1  28 15.13853318
326 2013     2  28  5.54926625
327 2013     3  28  6.23926380
328 2013     4  28  4.81668496
329 2013     5  28 10.21443299
330 2013     6  28 48.82778416
331 2013     7  28 37.71016166
332 2013     8  28 40.52689352
333 2013     9  28  0.70250368
334 2013    10  28  2.56588355
335 2013    11  28  6.06151420
336 2013    12  28  7.98154982
337 2013     1  29  2.49714937
338 2013     3  29  2.93298969
339 2013     4  29  7.22085890
340 2013     5  29  7.39318885
341 2013     6  29 19.26767677
342 2013     7  29 15.68232891
343 2013     8  29 10.07889344
344 2013     9  29  5.76070252
345 2013    10  29 -0.34932221
346 2013    11  29  0.14523449
347 2013    12  29 22.30955121
348 2013     1  30 28.62344140
349 2013     3  30  2.17708333
350 2013     4  30  1.91753653
351 2013     5  30  9.59836901
352 2013     6  30 44.18817853
353 2013     7  30  7.38399189
354 2013     8  30  5.22940563
355 2013     9  30  2.65349544
356 2013    10  30  0.56553148
357 2013    11  30  2.78571429
358 2013    12  30 10.69811321
359 2013     1  31 28.65836299
360 2013     3  31  5.60514541
361 2013     5  31  9.27422680
362 2013     7  31  6.28084253
363 2013     8  31  4.58727811
364 2013    10  31  5.16357688
365 2013    12  31  6.99605263</code></pre>
</div>
</div>
</section>
<section id="summarizing-by-groups-1" class="slide level2">
<h2>Summarizing by groups</h2>
<p>dplyr has two key functions: <code>summarise</code> and <code>group_by</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-24_e98dc865a85b8450c649aa0a9aa2683b">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>by_day<span class="ot">=</span> <span class="fu">group_by</span>(flights, year, month, day) <span class="co">#create new (grouped) tibble</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_day, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2013     1     1 11.5 
 2  2013     1     2 13.9 
 3  2013     1     3 11.0 
 4  2013     1     4  8.95
 5  2013     1     5  5.73
 6  2013     1     6  7.15
 7  2013     1     7  5.42
 8  2013     1     8  2.55
 9  2013     1     9  2.28
10  2013     1    10  2.84
# … with 355 more rows</code></pre>
</div>
</div>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>Flight distance vs.&nbsp;delay, for each destination airport with &gt;20 flights other than Honolulu. Note the use of <code>n()</code></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">R code</a></li><li><a href="#tabset-2-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-25_d155a7fd574e2c72012e45762854e3ff">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>by_dest<span class="ot">=</span> <span class="fu">group_by</span>(flights, dest)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>delay<span class="ot">=</span> <span class="fu">summarise</span>(by_dest, <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>delay<span class="ot">=</span> <span class="fu">filter</span>(delay, count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">"HNL"</span>) <span class="co">#&gt;20 flights, remove Hololulu</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>delay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 4
   dest  count  dist delay
   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ABQ     254 1826   4.38
 2 ACK     265  199   4.85
 3 ALB     439  143  14.4 
 4 ATL   17215  757. 11.3 
 5 AUS    2439 1514.  6.02
 6 AVL     275  584.  8.00
 7 BDL     443  116   7.05
 8 BGR     375  378   8.03
 9 BHM     297  866. 16.9 
10 BNA    6333  758. 11.8 
# … with 86 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-26_9e1117e47f9a62334c9dff462aa22440">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> delay, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> delay)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> count), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-26-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="same-using-pipes" class="slide level2">
<h2>Same using pipes</h2>
<p>Avoid creating intermediate datasets (<code>by_dest</code> in the previous slide)</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-27_8a9f2b894fed43b7645c130ef7568304">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>delays<span class="ot">=</span> flights <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">"HNL"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>delays</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 4
   dest  count  dist delay
   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ABQ     254 1826   4.38
 2 ACK     265  199   4.85
 3 ALB     439  143  14.4 
 4 ATL   17215  757. 11.3 
 5 AUS    2439 1514.  6.02
 6 AVL     275  584.  8.00
 7 BDL     443  116   7.05
 8 BGR     375  378   8.03
 9 BHM     297  866. 16.9 
10 BNA    6333  758. 11.8 
# … with 86 more rows</code></pre>
</div>
</div>
</section>
<section id="useful-summaries" class="slide level2">
<h2>Useful summaries</h2>
<ul>
<li><p>Classical: <code>mean</code>, <code>sd</code>, <code>sum</code>, <code>min</code>, <code>max</code></p></li>
<li><p>Robust to outliers: <code>median</code>, <code>mad</code>, <code>quantile</code>, <code>IQR</code></p></li>
<li><p>Counts: <code>n</code>, <code>sum(is.na())</code>, <code>n_distinct()</code></p></li>
</ul>
<p>Example: number of flights with early departure (&lt;5:00am)</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-28_2df2fd123334db5088ba05ec44741a3d">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_early =</span> <span class="fu">sum</span>(dep_time <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day n_early
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
 1  2013     1     1       0
 2  2013     1     2       3
 3  2013     1     3       4
 4  2013     1     4       3
 5  2013     1     5       3
 6  2013     1     6       2
 7  2013     1     7       2
 8  2013     1     8       1
 9  2013     1     9       3
10  2013     1    10       3
# … with 355 more rows</code></pre>
</div>
</div>
</section>
<section id="ungrouping" class="slide level2">
<h2>Ungrouping</h2>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-29_e6c0e740b32c15ecb3b605b422efdf16">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>daily<span class="ot">=</span> <span class="fu">group_by</span>(flights, year, month, day)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(daily, <span class="at">flights =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day flights
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
 1  2013     1     1     842
 2  2013     1     2     943
 3  2013     1     3     914
 4  2013     1     4     915
 5  2013     1     5     720
 6  2013     1     6     832
 7  2013     1     7     933
 8  2013     1     8     899
 9  2013     1     9     902
10  2013     1    10     932
# … with 355 more rows</code></pre>
</div>
</div>
<p>Ungrouping</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-30_15c9797412e5d3901aa563c7fc966047">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>daily<span class="ot">=</span> <span class="fu">ungroup</span>(daily)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(daily, <span class="at">flights =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  flights
    &lt;int&gt;
1  336776</code></pre>
</div>
</div>
</section></section>
<section>
<section id="further-examples" class="title-slide slide level1 center">
<h1>Further examples</h1>
<p>Cancelled flights have NA departure/arrival delays. Select non-cancelled flights and compute mean delay for each airplane (variable <code>tailnum</code>)</p>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-31_736adcf1d976919cd0020bc3a24e1b88">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>not_cancelled<span class="ot">=</span> <span class="fu">filter</span>(flights, <span class="sc">!</span><span class="fu">is.na</span>(dep_delay), <span class="sc">!</span><span class="fu">is.na</span>(arr_delay))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>delays<span class="ot">=</span> not_cancelled <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tailnum) <span class="sc">|&gt;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(), <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> delays, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> delay)) <span class="sc">+</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-31-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:30%;">
<p>Some airplanes have very large mean delays! What is the reason?</p>
</div>
</div>
</section>
<section class="slide level2">

<p>Extreme mean delays mostly in planes with few flights (central limit theorem in action!). The mean delay is actually pretty constant</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-32_660e1b90a3af08e4fde51e0c254ef4a0">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(delays, <span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">y=</span>delay)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="batting-averages" class="slide level2">
<h2>Batting averages</h2>
<p>For each player, compute batting average (hits <code>H</code> / opportunities to hit the ball <code>AB</code>)</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-33_dc8b7805a30b09aa43ee4a262293c0d5">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>batting<span class="ot">=</span> <span class="fu">as_tibble</span>(Lahman<span class="sc">::</span>Batting)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>batting</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 110,495 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abercda01   1871     1 TRO    NA        1     4     0     0     0     0     0
 2 addybo01    1871     1 RC1    NA       25   118    30    32     6     0     0
 3 allisar01   1871     1 CL1    NA       29   137    28    40     4     5     0
 4 allisdo01   1871     1 WS3    NA       27   133    28    44    10     2     2
 5 ansonca01   1871     1 RC1    NA       25   120    29    39    11     3     0
 6 armstbo01   1871     1 FW1    NA       12    49     9    11     2     1     0
 7 barkeal01   1871     1 RC1    NA        1     4     0     1     0     0     0
 8 barnero01   1871     1 BS1    NA       31   157    66    63    10     9     0
 9 barrebi01   1871     1 FW1    NA        1     5     1     1     1     0     0
10 barrofr01   1871     1 BS1    NA       18    86    13    13     2     1     0
# … with 110,485 more rows, and 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;,
#   CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;, IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;,
#   GIDP &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>batters<span class="ot">=</span> batting <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(playerID) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ba =</span> <span class="fu">sum</span>(H, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(AB, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ab =</span> <span class="fu">sum</span>(AB, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Batting average’s mean &amp; variance associated with opportunities to hit. Can you think of a reason why?</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-34_64f76df63fd9a2f2f2946745f8d6f6f5">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(batters, ab <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ab, <span class="at">y =</span> ba)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Opportunities to hit'</span>, <span class="at">y=</span><span class="st">'Batting average'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section id="counts" class="slide level2">
<h2>Counts</h2>
<p>Two equivalent ways to count: <code>summarise</code> and <code>count</code></p>
<p><strong>Example.</strong> Data <code>diamonds</code>. How many diamonds of each (color, cut)?</p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">summarize</a></li><li><a href="#tabset-3-2">count</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-35_11bc4b5202630f1226abce22f53a8eda">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">=</span> <span class="fu">group_by</span>(diamonds, color, cut) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>())</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 3
# Groups:   color [7]
   color cut       count
   &lt;ord&gt; &lt;ord&gt;     &lt;int&gt;
 1 D     Fair        163
 2 D     Good        662
 3 D     Very Good  1513
 4 D     Premium    1603
 5 D     Ideal      2834
 6 E     Fair        224
 7 E     Good        933
 8 E     Very Good  2400
 9 E     Premium    2337
10 E     Ideal      3903
# … with 25 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-36_ae0caf87475b68635851631a60002b67">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">=</span> <span class="fu">count</span>(diamonds, color, cut)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 3
   color cut           n
   &lt;ord&gt; &lt;ord&gt;     &lt;int&gt;
 1 D     Fair        163
 2 D     Good        662
 3 D     Very Good  1513
 4 D     Premium    1603
 5 D     Ideal      2834
 6 E     Fair        224
 7 E     Good        933
 8 E     Very Good  2400
 9 E     Premium    2337
10 E     Ideal      3903
# … with 25 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="counts-1" class="slide level2">
<h2>Counts</h2>
<p>We can visualize the counts with <code>geom_tile</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-37_3cba96dead6be00b422cc1e6118454a4">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> color, <span class="at">y =</span> cut)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section>
<section id="discretize-continuous-variables" class="slide level2">
<h2>Discretize continuous variables</h2>
<p><code>cut_interval</code>, <code>cut_number</code> and <code>cut_width</code> divide a continuous variable into groups</p>
<p><strong>Example.</strong> Boxplot of diamond price vs.&nbsp;(discretized) carats</p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Mutate</a></li><li><a href="#tabset-4-2">Aesthetic</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-38_f171e66b5ff2bb62d9f3c2fa125a5de5">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>diam2<span class="ot">=</span> <span class="fu">mutate</span>(diamonds, <span class="at">carat_disc=</span> <span class="fu">cut_width</span>(carat, <span class="fl">0.1</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diam2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">group =</span> carat_disc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-38-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-4-2">
<p>Same result, using <code>cut_width</code> within an aesthetic</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-39_f3a4e46a6c34008253fe8ca573babf11">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">cut_width</span>(carat, <span class="fl">0.1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="03_datawrangling_files/figure-revealjs/unnamed-chunk-39-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="exercise" class="title-slide slide level1 center">
<h1>Exercise</h1>

</section>
<section class="slide level2">

<p>To do Exercises 1-2 below load the gapminder data</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-40_4eba5d207c4fe60dcecafdbf9bcb3101">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>gapminder</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Turn in a single html with your solutions <a href="https://drive.google.com/drive/folders/1jhh1CrXM3hqc7qTrOYeQzo2pV8Vly1NY?usp=sharing">here</a>. Name your file firstname_lastname.html</p>
</section>
<section id="exercises" class="slide level2">
<h2>Exercises</h2>
<p><strong>Exercise 1.</strong> Continent-wide life expectancy</p>
<ol type="1">
<li><p>Compute the mean life expectancy and GDP per capita for each (continent, year)</p></li>
<li><p>Do an animated scatterplot of continent life expectancy vs.&nbsp;GDP (<code>transition_time(year)</code>)</p></li>
</ol>
<p><strong>Exercise 2.</strong> Inequality of GDP/capita across countries over time</p>
<ol type="1">
<li><p>For each year, compute the inter-quartile range or the GDP/capita across countries</p></li>
<li><p>Do a scatterplot of IQR vs.&nbsp;year. Add lines to the plot</p></li>
</ol>
</section></section>
<section>
<section id="data-import-and-export" class="title-slide slide level1 center">
<h1>Data import and export</h1>

</section>
<section id="main-functions" class="slide level2">
<h2>Main functions</h2>
<p>In RStudio: <code>File -&gt; Import Dataset</code> makes life easy</p>
<p>Main functions to import data</p>
<ul>
<li><p><code>read.table</code>, <code>read.csv</code>: R base functions for text files</p></li>
<li><p><code>read_csv</code>, <code>read_tsv</code>: (faster) tidyverse functions for comma/tab separated files</p></li>
<li><p><code>readxl</code>: Excel (.xls and .xlsx)</p></li>
<li><p><code>DBI</code>: database queries (SQL)</p></li>
</ul>
<p>Web scraping and much more (packages <code>purrr</code>,<code>jsonlite</code>,<code>xml2</code>, <code>rio</code>…)</p>
<p>Export data</p>
<ul>
<li><code>write.table</code>, <code>write.csv</code></li>
</ul>
</section>
<section id="rdata-files" class="slide level2">
<h2>.RData files</h2>
<p><code>save</code> stores any specified objects in an <code>.RData</code> file (for large files use <code>compress=TRUE</code>).</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-41_e81cd6f779aa4bde8c32bcadd0a32827">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)  <span class="co">#simulate data from a linear regression, errors N(0,1)</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(x, y, fit, <span class="at">file=</span><span class="st">'myfile.RData'</span>, <span class="at">compress=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>load</code> loads the file and all objects saved therein</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-42_6310acb918d3745bf1b3448e9505cbc1">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">'myfile.RData'</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="tidying-data" class="title-slide slide level1 center">
<h1>Tidying data</h1>

</section>
<section class="slide level2">

<p>Data can be stored in different formats. In a tidy dataset, each variable is a column, each observation a row</p>
<p>This dataset is tidy</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-43_708416a10242563ec84119d2d286ef6f">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>country<span class="ot">=</span> <span class="fu">c</span>(<span class="st">'UK'</span>,<span class="st">'UK'</span>,<span class="st">'Spain'</span>,<span class="st">'Spain'</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>year<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">2023</span>,<span class="dv">2022</span>,<span class="dv">2023</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>population<span class="ot">=</span> <span class="fu">c</span>(<span class="fl">80.5</span>,<span class="fl">81.4</span>,<span class="fl">50.1</span>,<span class="fl">50.0</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">=</span> <span class="fu">tibble</span>(country, year, population)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  country  year population
  &lt;chr&gt;   &lt;dbl&gt;      &lt;dbl&gt;
1 UK       2022       80.5
2 UK       2023       81.4
3 Spain    2022       50.1
4 Spain    2023       50  </code></pre>
</div>
</div>
<p>This one has the same data, but is not tidy</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-44_b8e9ca08390282722452d2dd3d857b5d">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>country<span class="ot">=</span> <span class="fu">c</span>(<span class="st">'UK'</span>,<span class="st">'Spain'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>y2022<span class="ot">=</span> <span class="fu">c</span>(<span class="fl">80.5</span>,<span class="fl">50.1</span>); y2023<span class="ot">=</span> <span class="fu">c</span>(<span class="fl">81.4</span>,<span class="fl">50.0</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">=</span> <span class="fu">tibble</span>(country, y2022, y2023)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab2)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]<span class="ot">=</span> <span class="fu">c</span>(<span class="st">'2022'</span>,<span class="st">'2023'</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  country `2022` `2023`
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 UK        80.5   81.4
2 Spain     50.1   50  </code></pre>
</div>
</div>
</section>
<section id="tidying-a-dataset" class="slide level2">
<h2>Tidying a dataset</h2>
<p>Often a dataset is not tidy for one these two reasons</p>
<ol type="1">
<li><p>A single variable is stored in several columns</p></li>
<li><p>A single individual is stored in multiple rows</p></li>
</ol>
<p><code>pivot_longer</code> deals with 1 (data are made longer, i.e.&nbsp;more rows). <code>pivot_shorter</code> deals with 2</p>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<p>Below 2022-2023 are values of the variable year</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-45_6a13681a59697bd287b42b790b83eabd">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  country `2022` `2023`
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 UK        80.5   81.4
2 Spain     50.1   50  </code></pre>
</div>
</div>
<ul>
<li><p>Take columns 2022, 2023</p></li>
<li><p>The column names should be values of variable <code>year</code></p></li>
<li><p>Their values should be in a variable <code>population</code></p></li>
</ul>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-46_dd26bb058e0e1bc9fbee8c6ee3a70408">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(tab2, <span class="at">cols=</span><span class="fu">c</span>(<span class="st">'2022'</span>,<span class="st">'2023'</span>), <span class="at">names_to=</span><span class="st">"year"</span>, <span class="at">values_to=</span> <span class="st">"population"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  country year  population
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;
1 UK      2022        80.5
2 UK      2023        81.4
3 Spain   2022        50.1
4 Spain   2023        50  </code></pre>
</div>
</div>
</section>
<section id="separating-columns" class="slide level2">
<h2>Separating columns</h2>
<p>Sometimes a character needs to be separated into several ones</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-47_c3196f0c5c269e372b9e2abfa02fe10a">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">date=</span><span class="fu">c</span>(<span class="st">"25/12/22"</span>,<span class="st">"26/12/22"</span>), <span class="at">date2=</span><span class="fu">c</span>(<span class="st">"251222"</span>,<span class="st">"261222"</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  date     date2 
  &lt;chr&gt;    &lt;chr&gt; 
1 25/12/22 251222
2 26/12/22 261222</code></pre>
</div>
</div>
<p><code>separate</code>: indicate character to split by. <code>convert=TRUE</code> tries to convert into numeric</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-48_f87d790705f7efa5041f8897ccc498ff">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(tab, <span class="at">col=</span>date, <span class="at">sep=</span><span class="st">'/'</span>, <span class="at">into=</span><span class="fu">c</span>(<span class="st">'day'</span>,<span class="st">'month'</span>,<span class="st">'year'</span>), <span class="at">convert=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
    day month  year date2 
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
1    25    12    22 251222
2    26    12    22 261222</code></pre>
</div>
</div>
<p>Or positions at which to split</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-49_fcad6c8d81fe6706dc230ba2fc30bc82">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(tab, <span class="at">col=</span>date2, <span class="at">sep=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">into=</span><span class="fu">c</span>(<span class="st">'day'</span>,<span class="st">'month'</span>,<span class="st">'year'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  date     day   month year 
  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 25/12/22 25    12    22   
2 26/12/22 26    12    22   </code></pre>
</div>
</div>
</section>
<section id="uniting-columns" class="slide level2">
<h2>Uniting columns</h2>
<p>Consider the dataset <code>stab</code></p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-50_6c0f1223f5b38446190c44b07ce8939e">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>stab<span class="ot">=</span> <span class="fu">separate</span>(tab, <span class="at">col=</span>date2, <span class="at">sep=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">into=</span><span class="fu">c</span>(<span class="st">'day'</span>,<span class="st">'month'</span>,<span class="st">'year'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>stab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  day   month year 
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 25    12    22   
2 26    12    22   </code></pre>
</div>
</div>
<p>We use <code>unite</code> to paste columns together. The 2nd argument is the new column name, then we specify the columns to be pasted. <code>sep</code> is an optional separation character</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-51_16f3e5e2a4962b617ef1d95129656bd6">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unite</span>(stab, date, day, month, year, <span class="at">sep=</span><span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 1
  date    
  &lt;chr&gt;   
1 25-12-22
2 26-12-22</code></pre>
</div>
</div>
</section></section>
<section>
<section id="relational-data" class="title-slide slide level1 center">
<h1>Relational data</h1>

</section>
<section class="slide level2">

<p>Databases may be stored in different tables (saves space and transfer time)</p>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-52_ff0114d6addd432856359219709ad73b">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">flights</a></li><li><a href="#tabset-5-2">airlines</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-53_dc91e2e1e3ffd6feeca19e652e68f146">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 20
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 10 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, fine &lt;dbl&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-54_2f3039a722120edac7f96773451b844e">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>airlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   carrier name                       
   &lt;chr&gt;   &lt;chr&gt;                      
 1 9E      Endeavor Air Inc.          
 2 AA      American Airlines Inc.     
 3 AS      Alaska Airlines Inc.       
 4 B6      JetBlue Airways            
 5 DL      Delta Air Lines Inc.       
 6 EV      ExpressJet Airlines Inc.   
 7 F9      Frontier Airlines Inc.     
 8 FL      AirTran Airways Corporation
 9 HA      Hawaiian Airlines Inc.     
10 MQ      Envoy Air                  
11 OO      SkyWest Airlines Inc.      
12 UA      United Air Lines Inc.      
13 US      US Airways Inc.            
14 VX      Virgin America             
15 WN      Southwest Airlines Co.     
16 YV      Mesa Airlines Inc.         </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="basic-functions" class="slide level2">
<h2>Basic functions</h2>
<ul>
<li><p>R base: <code>merge</code></p></li>
<li><p>dplyr (tidyverse): <code>left_join</code>, <code>right_join</code>, <code>inner_join</code>, <code>full_join</code></p></li>
</ul>
<p>Similar functionality, <code>dplyr</code> usually faster</p>
<table>
<thead>
<tr class="header">
<th>dplyr</th>
<th>Base R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left_join(x,y)</code></td>
<td><code>merge(x,y,all.x=TRUE)</code></td>
</tr>
<tr class="even">
<td><code>right_join(x,y)</code></td>
<td><code>merge(x,y,all.y=TRUE)</code></td>
</tr>
<tr class="odd">
<td><code>inner_join(x,y)</code></td>
<td><code>merge(x,y)</code></td>
</tr>
<tr class="even">
<td><code>left_join(x,y)</code></td>
<td><code>merge(x,y,all.x=TRUE,all.y=TRUE)</code></td>
</tr>
</tbody>
</table>
</section>
<section id="merge" class="slide level2">
<h2>Merge</h2>
<div class="cell" data-hash="03_datawrangling_cache/revealjs/unnamed-chunk-55_d791c9cb7d706a110fe945f34dfdea4a">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>flightsdep<span class="ot">=</span> <span class="fu">select</span>(flights, <span class="fu">c</span>(<span class="st">'year'</span>,<span class="st">'month'</span>,<span class="st">'day'</span>,<span class="st">'dep_time'</span>,<span class="st">'carrier'</span>))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(flightsdep, airlines, <span class="at">by=</span><span class="st">'carrier'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 6
    year month   day dep_time carrier name                    
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;                   
 1  2013     1     1      517 UA      United Air Lines Inc.   
 2  2013     1     1      533 UA      United Air Lines Inc.   
 3  2013     1     1      542 AA      American Airlines Inc.  
 4  2013     1     1      544 B6      JetBlue Airways         
 5  2013     1     1      554 DL      Delta Air Lines Inc.    
 6  2013     1     1      554 UA      United Air Lines Inc.   
 7  2013     1     1      555 B6      JetBlue Airways         
 8  2013     1     1      557 EV      ExpressJet Airlines Inc.
 9  2013     1     1      557 B6      JetBlue Airways         
10  2013     1     1      558 AA      American Airlines Inc.  
# … with 336,766 more rows</code></pre>
</div>
</div>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="03_datawrangling_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="03_datawrangling_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="03_datawrangling_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="03_datawrangling_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>