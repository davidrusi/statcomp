<!DOCTYPE html>
<html lang="en"><head>
<script src="05_basicmodels_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_basicmodels_files/libs/quarto-html/tabby.min.js"></script>
<script src="05_basicmodels_files/libs/quarto-html/popper.min.js"></script>
<script src="05_basicmodels_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="05_basicmodels_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_basicmodels_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="05_basicmodels_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="05_basicmodels_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="David Rossell">
  <title>Modern Statistical Computing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="05_basicmodels_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="05_basicmodels_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="05_basicmodels_files/libs/revealjs/dist/theme/quarto.css">
  <link href="05_basicmodels_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="05_basicmodels_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="05_basicmodels_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="05_basicmodels_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Modern Statistical Computing</h1>
  <p class="subtitle">5. Basic models</p>
  <p class="author">David Rossell</p>
  <p class="institute">Pompeu Fabra University</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/linear-models" id="/toc-linear-models">Linear models</a></li>
<li><a href="#/extracting-inference" id="/toc-extracting-inference">Extracting inference</a></li>
<li><a href="#/residual-analysis" id="/toc-residual-analysis">Residual analysis</a></li>
<li><a href="#/exercise" id="/toc-exercise">Exercise</a></li>
<li><a href="#/interpreting-the-coefficients" id="/toc-interpreting-the-coefficients">Interpreting the coefficients</a></li>
<li><a href="#/linear-contrasts" id="/toc-linear-contrasts">Linear contrasts</a></li>
<li><a href="#/interactions" id="/toc-interactions">Interactions</a></li>
<li><a href="#/nested-models" id="/toc-nested-models">Nested models</a></li>
<li><a href="#/summary-of-useful-functions" id="/toc-summary-of-useful-functions">Summary of useful functions</a></li>
<li><a href="#/exercise-1" id="/toc-exercise-1">Exercise</a></li>
</ul>
</nav>
</section>
<section id="reproducing-these-lecture-notes" class="slide level2">
<h2>Reproducing these lecture notes</h2>
<p>Load the required R packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coefplot)</span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hexbin)</span>
<span id="cb1-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb1-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb1-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also load auxiliary routines stored at <code>routines.R</code> (directory <code>code</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../code/routines.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also source files from RStudio (<code>Code -&gt; Source File</code>)</p>
</section>
<section id="models" class="slide level2">
<h2>Models</h2>
<p>George Box’s famous mantra</p>
<blockquote>
<p>All models are wrong, but some are useful</p>
</blockquote>
<p>Its less well-known context</p>
<blockquote>
<p>Now it would be very remarkable if any system existing in the real world could be exactly represented by any simple model. However, cunningly chosen parsimonious models often do provide remarkably useful approximations. For example, the law PV = RT relating pressure P, volume V and temperature T of an “ideal” gas via a constant R is not exactly true for any real gas, but it frequently provides a useful approximation and furthermore its structure is informative since it springs from a physical view of the behavior of gas molecules.</p>
</blockquote>
<blockquote>
<p>For such a model there is no need to ask the question “Is the model true?”. If “truth” is to be the “whole truth” the answer must be “No”. The only question of interest is “Is the model illuminating and useful?”.</p>
</blockquote>
</section>
<section class="slide level2">

<p>Another quote by Box (he had many!)</p>
<blockquote>
<p>Statisticians, like artists, have the bad habit of falling in love with their models</p>
</blockquote>
<p>Meaning that it’s important to check whether the model fits the main features of the data</p>
</section>
<section>
<section id="linear-models" class="title-slide slide level1 center">
<h1>Linear models</h1>
<p>Models help interpret what’s going on in a dataset</p>
<p><span class="math display">\[
y_i = \beta_0 + \sum_{j=1}^p \beta_j x_{ij} + \epsilon_i
\]</span> where <span class="math inline">\(\epsilon_i \sim N(0,\sigma^2)\)</span> indep <span class="math inline">\(i=1,\ldots,n\)</span></p>
<ul>
<li><p><code>lm</code> fits a linear regression by least-squares in R</p></li>
<li><p><code>glm</code> fits generalized linear models (for non-normal outcomes, e.g.&nbsp;binary)</p></li>
<li><p><code>gam</code> fits generalized additive models</p></li>
</ul>
<p><span class="math display">\[
y_i= \sum_{j=1}^p f_j(x_{ij}) + \epsilon_i \mbox{, unknown } f_j
\]</span></p>
</section>
<section id="reminder" class="slide level2">
<h2>Reminder</h2>
<p><span class="math display">\[y= \begin{pmatrix} y_1 \\ \ldots \\ y_n \end{pmatrix};
X=\begin{pmatrix}
1 &amp; x_{11} &amp; \ldots &amp; x_{1p} \\
\ldots \\
1 &amp; x_{n1} &amp; \ldots &amp; x_{np}
\end{pmatrix}=
\begin{pmatrix}
x_1^T \\
\ldots \\
x_n^T \\
\end{pmatrix}
\]</span></p>
<p>Then (assuming <span class="math inline">\(X^TX\)</span> is invertible) <span class="math display">\[\hat{\beta}= (X^T X)^{-1} X^T y= \arg\min_\beta \sum_{i=1}^n (y_i - x_i^T \beta)^2\]</span></p>
<p>Further, if the model assumptions hold</p>
<p><span class="math display">\[\hat{\beta} \sim N(\beta, V); V= \sigma^2 (X^T X)^{-1}\]</span> Which gives confidence intervals and P-values, e.g. <span class="math inline">\(\hat{\beta}_j \pm 1.96 \sqrt{v_{jj}}\)</span></p>
</section>
<section id="reminder-1" class="slide level2">
<h2>Reminder</h2>
<p>Sometimes we’re interested in linear combinations of parameters</p>
<p><strong>Result.</strong> Let <span class="math inline">\(Z \sim N(\mu, V)\)</span> be a <span class="math inline">\(p\)</span>-dimensional Normal distribution, and <span class="math inline">\(C\)</span> a <span class="math inline">\(q \times p\)</span> matrix with full rank <span class="math inline">\(q \leq p\)</span>. Then <span class="math display">\[
W= C Z \sim N(C \mu, C V C^T)
\]</span> is a <span class="math inline">\(q\)</span>-dimensional normal</p>
<p><strong>Example.</strong> We seek a 95% CI for <span class="math inline">\(\beta_2 - \beta_1\)</span>. Let <span class="math inline">\(C= \begin{pmatrix}
-1 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
\end{pmatrix}\)</span> Then <span class="math display">\[C \begin{pmatrix} \hat{\beta}_1 \\ \hat{\beta}_2 \\ \ldots \\ \hat{\beta}_p \end{pmatrix} = \hat{\beta}_2 - \hat{\beta}_1 \sim N(\beta_2 - \beta_1, \sigma^2 C (X^T X)^{-1} C^T)\]</span></p>
</section>
<section id="example.-diamonds-data" class="slide level2">
<h2>Example. Diamonds data</h2>
<p>What drives diamond prices? Exploration suggests that low-quality diamonds are more expensive (worst diamond color is J (yellow-ish), worst clarity is l1)</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Price vs.&nbsp;cut</a></li><li><a href="#tabset-1-2">Price vs.&nbsp;color</a></li><li><a href="#tabset-1-3">Price vs.&nbsp;clarity</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(cut, price)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(color, price)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(clarity, price)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="diagnosing-the-issue" class="slide level2">
<h2>Diagnosing the issue</h2>
<p>Price is strongly associated with carats (diamond weight)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price)) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Carats also associated with cut, color and clarity</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Carats vs.&nbsp;cut</a></li><li><a href="#tabset-2-2">Carats vs.&nbsp;color</a></li><li><a href="#tabset-2-3">Carats vs.&nbsp;clarity</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(cut, carat)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(color, carat)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(clarity, carat)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>The most important assumption in a linear model: <strong>linearity!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a>diamonds2<span class="ot">=</span> <span class="fu">mutate</span>(diamonds, <span class="at">lprice=</span><span class="fu">log2</span>(price), <span class="at">lcarat=</span><span class="fu">log2</span>(carat))</span>
<span id="cb10-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(lcarat, lprice)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"><p>log2 facilitates interpretation (+1 in log2 scale <span class="math inline">\(\Rightarrow \times 2\)</span> in original scale)</p>
</section>
<section class="slide level2">

<p>Fit linear model and save residuals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmfit<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat, <span class="at">data =</span> diamonds2)</span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a>diamonds2<span class="ot">=</span> <span class="fu">mutate</span>(diamonds2, <span class="at">res=</span> <span class="fu">residuals</span>(lmfit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recall that worst diamond color is J (yellow-ish), worst clarity is l1</p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Residuals vs.&nbsp;cut</a></li><li><a href="#tabset-3-2">Residuals vs.&nbsp;color</a></li><li><a href="#tabset-3-3">Residuals vs.&nbsp;clarity</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(cut, res)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-12-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(color, res)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(clarity, res)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="fitting-the-full-model" class="slide level2">
<h2>Fitting the full model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmfit2<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity, <span class="at">data=</span>diamonds2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Second model has better <span class="math inline">\(R^2\)</span> coefficient. Careful though, comparison not fully reliable due to over-fitting (to be discussed)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9329893</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit2)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9826161</code></pre>
</div>
</div>
<p>Many statistically signif. coefficients in 2nd model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lprice ~ lcarat + cut + color + clarity, data = diamonds2)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.45867 -0.12459 -0.00033  0.12033  2.81005 

Coefficients:
             Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept) 12.200915   0.001685 7242.225  &lt; 2e-16 ***
lcarat       1.883718   0.001129 1668.750  &lt; 2e-16 ***
cut.L        0.174154   0.003396   51.284  &lt; 2e-16 ***
cut.Q       -0.050660   0.002989  -16.950  &lt; 2e-16 ***
cut.C        0.019446   0.002595    7.494 6.77e-14 ***
cut^4       -0.002253   0.002079   -1.084    0.278    
color.L     -0.634174   0.002925 -216.828  &lt; 2e-16 ***
color.Q     -0.137955   0.002687  -51.335  &lt; 2e-16 ***
color.C     -0.021328   0.002515   -8.481  &lt; 2e-16 ***
color^4      0.017098   0.002310    7.403 1.35e-13 ***
color^5     -0.003176   0.002182   -1.455    0.146    
color^6      0.003450   0.001984    1.739    0.082 .  
clarity.L    1.322709   0.005161  256.274  &lt; 2e-16 ***
clarity.Q   -0.350630   0.004804  -72.982  &lt; 2e-16 ***
clarity.C    0.191013   0.004118   46.387  &lt; 2e-16 ***
clarity^4   -0.095368   0.003294  -28.955  &lt; 2e-16 ***
clarity^5    0.039556   0.002689   14.711  &lt; 2e-16 ***
clarity^6   -0.002624   0.002342   -1.120    0.263    
clarity^7    0.048375   0.002066   23.412  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.193 on 53921 degrees of freedom
Multiple R-squared:  0.9826,    Adjusted R-squared:  0.9826 
F-statistic: 1.693e+05 on 18 and 53921 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s plot their predictive accuracy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a>diamonds2<span class="ot">=</span> <span class="fu">mutate</span>(diamonds2, <span class="at">pred1=</span> <span class="fu">predict</span>(lmfit), <span class="at">pred2=</span><span class="fu">predict</span>(lmfit2), <span class="at">res2=</span> <span class="fu">residuals</span>(lmfit2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Model 1</a></li><li><a href="#tabset-4-2">Model 2</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(<span class="at">x=</span>pred1, <span class="at">y=</span>lprice)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(<span class="at">x=</span>pred2, <span class="at">y=</span>lprice)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-20-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="extracting-inference" class="title-slide slide level1 center">
<h1>Extracting inference</h1>

</section>
<section class="slide level2">

<p><code>summary</code> and <code>confint</code> give <span class="math inline">\(\hat{\beta}_j\)</span>, P-values for <span class="math inline">\(H_0:\beta_j=0\)</span> and confidence intervals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit2)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate  Std. Error     t value      Pr(&gt;|t|)
(Intercept) 12.200914981 0.001684691 7242.225315  0.000000e+00
lcarat       1.883717549 0.001128819 1668.750482  0.000000e+00
cut.L        0.174153643 0.003395884   51.283741  0.000000e+00
cut.Q       -0.050659823 0.002988784  -16.949976  2.826672e-64
cut.C        0.019446261 0.002594847    7.494184  6.772916e-14
cut^4       -0.002252861 0.002078739   -1.083763  2.784747e-01
color.L     -0.634174007 0.002924780 -216.827951  0.000000e+00
color.Q     -0.137955445 0.002687342  -51.335276  0.000000e+00
color.C     -0.021327575 0.002514649   -8.481333  2.281798e-17
color^4      0.017098333 0.002309610    7.403125  1.349487e-13
color^5     -0.003175587 0.002182225   -1.455206  1.456182e-01
color^6      0.003449752 0.001983771    1.738987  8.204271e-02
clarity.L    1.322709392 0.005161312  256.273886  0.000000e+00
clarity.Q   -0.350630230 0.004804353  -72.981783  0.000000e+00
clarity.C    0.191012724 0.004117779   46.387318  0.000000e+00
clarity^4   -0.095368362 0.003293646  -28.955258 6.111761e-183
clarity^5    0.039556144 0.002688793   14.711486  6.769060e-49
clarity^6   -0.002623878 0.002342138   -1.120292  2.625945e-01
clarity^7    0.048375011 0.002066229   23.412223 1.286511e-120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lmfit2, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    2.5 %       97.5 %
(Intercept) 12.1976129721 12.204216989
lcarat       1.8815050543  1.885930044
cut.L        0.1674976831  0.180809603
cut.Q       -0.0565178639 -0.044801781
cut.C        0.0143603403  0.024532182
cut^4       -0.0063272067  0.001821485
color.L     -0.6399065990 -0.628441416
color.Q     -0.1432226564 -0.132688233
color.C     -0.0262563069 -0.016398843
color^4      0.0125714787  0.021625188
color^5     -0.0074527657  0.001101593
color^6     -0.0004384544  0.007337958
clarity.L    1.3125931802  1.332825604
clarity.Q   -0.3600467999 -0.341213660
clarity.C    0.1829418441  0.199083603
clarity^4   -0.1018239339 -0.088912790
clarity^5    0.0342860877  0.044826200
clarity^6   -0.0072144877  0.001966732
clarity^7    0.0443251857  0.052424836</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Easier to define a function that summarizes any fitted model. I created function <code>coefSummary</code> (at <code>routines.R</code>) for that purpose</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="" aria-hidden="true" tabindex="-1"></a>coefSummary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (lmfit, level = 0.95, digits = 3, transform) 
{
    require(tidyverse)
    if (!inherits(lmfit, "lm")) 
        stop("lmfit must be of class lm")
    b = coef(lmfit)
    ci = confint(lmfit, level = level)
    if (!missing(transform)) {
        b = transform(b)
        ci = transform(ci)
    }
    b = round(b, digits)
    ci = round(ci, digits)
    ci = paste("(", ci[, 1], ",", ci[, 2], ")", sep = "")
    pval = round(summary(lmfit)$coef[, 4], 5)
    pval[pval &lt; 1e-05] = "&lt;0.00001"
    ans = tibble(names(b), b, ci, pval)
    names(ans) = c("Parameter", "Estimate", "Conf. Int.", "P-value")
    return(ans)
}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(lmfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 4
   Parameter   Estimate `Conf. Int.`    `P-value`
   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;    
 1 (Intercept)   12.2   (12.198,12.204) &lt;0.00001 
 2 lcarat         1.88  (1.882,1.886)   &lt;0.00001 
 3 cut.L          0.174 (0.167,0.181)   &lt;0.00001 
 4 cut.Q         -0.051 (-0.057,-0.045) &lt;0.00001 
 5 cut.C          0.019 (0.014,0.025)   &lt;0.00001 
 6 cut^4         -0.002 (-0.006,0.002)  0.27847  
 7 color.L       -0.634 (-0.64,-0.628)  &lt;0.00001 
 8 color.Q       -0.138 (-0.143,-0.133) &lt;0.00001 
 9 color.C       -0.021 (-0.026,-0.016) &lt;0.00001 
10 color^4        0.017 (0.013,0.022)   &lt;0.00001 
11 color^5       -0.003 (-0.007,0.001)  0.14562  
12 color^6        0.003 (0,0.007)       0.08204  
13 clarity.L      1.32  (1.313,1.333)   &lt;0.00001 
14 clarity.Q     -0.351 (-0.36,-0.341)  &lt;0.00001 
15 clarity.C      0.191 (0.183,0.199)   &lt;0.00001 
16 clarity^4     -0.095 (-0.102,-0.089) &lt;0.00001 
17 clarity^5      0.04  (0.034,0.045)   &lt;0.00001 
18 clarity^6     -0.003 (-0.007,0.002)  0.26259  
19 clarity^7      0.048 (0.044,0.052)   &lt;0.00001 </code></pre>
</div>
</div>
</section>
<section id="organizing-code" class="slide level2">
<h2>Organizing code</h2>
<p>It’s useful to store useful functions separately</p>
<ul>
<li>Put <code>coefSummary</code> in file <code>routines.R</code>. Source it when starting R</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../code/routines.R'</span>) <span class="co">#change path to directory where routines.R is stored</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Create your own R package (to be seen), document and share the code</li>
</ul>
<p>Note: <a href="https://www.tidymodels.org">tidymodels</a> and <a href="https://parsnip.tidymodels.org">parsnip</a> provide a unified interface for many statistical/machine learning models</p>
<p>Note: R package <code>caret</code> does as well (see an <a href="https://topepo.github.io/caret">introduction</a>)</p>
</section>
<section id="plotting-intervals" class="slide level2">
<h2>Plotting intervals</h2>
<p><code>coefplot</code> helps visualize 95% confidence intervals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefplot</span>(lmfit2, <span class="at">predictors=</span><span class="st">"cut"</span>) <span class="co">#show only parameters with name including "cut"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="residual-analysis" class="title-slide slide level1 center">
<h1>Residual analysis</h1>

</section>
<section id="linear-model-assumptions" class="slide level2">
<h2>Linear model assumptions</h2>
<ul>
<li><p>Linearity</p></li>
<li><p>Constant error variance</p></li>
<li><p>Error normality (if <span class="math inline">\(n\)</span> large, only important for predictive intervals)</p></li>
<li><p>Uncorrelated errors</p></li>
</ul>
<p>Residuals vs predicted values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(<span class="at">x=</span>pred2, <span class="at">y=</span>res2)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section>
<section id="assessing-linearity" class="slide level2">
<h2>Assessing linearity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(pred2, res2)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">0</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">'gray'</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Model prediction'</span>, <span class="at">y=</span><span class="st">'Residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Here non-linearity seems mostly due to (log) carats</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(lcarat, lprice)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">col=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch"></section>
<section id="assessing-constant-variance" class="slide level2">
<h2>Assessing constant variance</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(<span class="at">x=</span>pred2, <span class="at">y=</span>res2)) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">cut_width</span>(pred2, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb38-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Model prediction'</span>, <span class="at">y=</span><span class="st">'Residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-29-1.png" width="960" class="r-stretch"></section>
<section id="residual-normality" class="slide level2">
<h2>Residual normality</h2>
<p>Note: qq-normal plots require that residuals have 0 mean, variance=1 (function <code>scale</code>)</p>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Histogram (qqplot)</a></li><li><a href="#tabset-5-2">Histogram (base R)</a></li><li><a href="#tabset-5-3">qq-plot</a></li><li><a href="#tabset-5-4">qq-plot (base R)</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb39-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(<span class="at">x=</span>res)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span> ..density..)) <span class="sc">+</span></span>
<span id="cb39-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_overlay_normal_density</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-30-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">scale</span>(diamonds2<span class="sc">$</span>res), <span class="at">xlab=</span><span class="st">'Residuals'</span>, <span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">''</span>)</span>
<span id="cb40-2"><a href="" aria-hidden="true" tabindex="-1"></a>xseq<span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="at">length=</span><span class="dv">200</span>)</span>
<span id="cb40-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xseq, <span class="fu">dnorm</span>(xseq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-31-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2) <span class="sc">+</span></span>
<span id="cb41-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="fu">aes</span>(<span class="at">sample=</span><span class="fu">scale</span>(res))) <span class="sc">+</span></span>
<span id="cb41-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-32-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">scale</span>(diamonds2<span class="sc">$</span>res))</span>
<span id="cb42-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-33-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="exercise" class="title-slide slide level1 center">
<h1>Exercise</h1>

</section>
<section class="slide level2">

<p>FiveThirtyEight’s <a href="https://fivethirtyeight.com/features/higher-rates-of-hate-crimes-are-tied-to-income-inequality">post</a> on hate crimes around the 2016 USA elections</p>
<p>Dataset <code>hate_crimes</code> (package <code>fivethirtyeight</code>) has this info for each state:</p>
<ul>
<li><p><code>avg_hatecrimes_per_100k_fbi</code>: pre-election number of hate crimes per 100,000 population by the FBI</p></li>
<li><p>education (% adults <span class="math inline">\(\geq\)</span> 25 with high school degree)</p></li>
<li><p>% of people who voted Donald Trump</p></li>
<li><p>Income inequality (Gini index)</p></li>
</ul>
<p>Plus variables about racial diversity, economics etc (see <code>help(hate_crimes)</code>)</p>
</section>
<section class="slide level2 scrollable">

<p>Load the data, select and rename the needed variables, and remove Hawaii (outcome not reported)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fivethirtyeight)</span>
<span id="cb43-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../code/routines.R"</span>)</span>
<span id="cb43-4"><a href="" aria-hidden="true" tabindex="-1"></a>hc<span class="ot">=</span> <span class="fu">transmute</span>(hate_crimes, <span class="at">state=</span>state_abbrev, <span class="at">hatecrimes_fbi=</span>avg_hatecrimes_per_100k_fbi, <span class="at">votes_trump=</span>share_vote_trump, <span class="at">gini=</span>gini_index, <span class="at">hs=</span>share_pop_hs)</span>
<span id="cb43-5"><a href="" aria-hidden="true" tabindex="-1"></a>hc<span class="ot">=</span> <span class="fu">filter</span>(hc, <span class="sc">!</span><span class="fu">is.na</span>(hatecrimes_fbi)) <span class="co">#outcome must be non-missing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p>Fit a linear regression for <code>hatecrimes_fbi</code> vs.&nbsp;<code>votes_trump</code>, <code>gini</code>, <code>hs</code>. Report the point estimate, 95% intervals and P-values for the 3 covariates. Which of them are significantly associated to hate crimes?</p></li>
<li><p>Assess the model assumptions: linearity, constant error variance, error normality. To what extent are they violated?</p></li>
</ol>
<p>Turn in an html with your solution at Aula Global Name your file firstname_lastname.html</p>
</section>
<section class="slide level2">

<p>Challenge: all variables are strongly correlated</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span> <span class="fu">select</span>(hc, <span class="sc">-</span>state) <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use=</span><span class="st">'pairwise.complete.obs'</span>)</span>
<span id="cb44-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(R)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="interpreting-the-coefficients" class="title-slide slide level1 center">
<h1>Interpreting the coefficients</h1>

</section>
<section id="factors" class="slide level2">
<h2>Factors</h2>
<p>To interpret the coefficients of categorical variables, we must understand how they’re coded</p>
<p>To avoid problems, let’s store them as standard unordered factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(diamonds2<span class="sc">$</span>cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Ideal     Premium   Good      Very Good Fair     
Levels: Fair &lt; Good &lt; Very Good &lt; Premium &lt; Ideal</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(diamonds2<span class="sc">$</span>color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] E I J H F G D
Levels: D &lt; E &lt; F &lt; G &lt; H &lt; I &lt; J</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(diamonds2<span class="sc">$</span>clarity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] SI2  SI1  VS1  VS2  VVS2 VVS1 I1   IF  
Levels: I1 &lt; SI2 &lt; SI1 &lt; VS2 &lt; VS1 &lt; VVS2 &lt; VVS1 &lt; IF</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="" aria-hidden="true" tabindex="-1"></a>diamonds2<span class="ot">=</span> <span class="fu">mutate</span>(diamonds2, </span>
<span id="cb51-2"><a href="" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cut=</span><span class="fu">factor</span>(cut, <span class="at">ordered=</span><span class="cn">FALSE</span>), </span>
<span id="cb51-3"><a href="" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span><span class="fu">factor</span>(color, <span class="at">ordered=</span><span class="cn">FALSE</span>), </span>
<span id="cb51-4"><a href="" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clarity=</span><span class="fu">factor</span>(clarity, <span class="at">ordered=</span><span class="cn">FALSE</span>) )</span>
<span id="cb51-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(diamonds2<span class="sc">$</span>cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Ideal     Premium   Good      Very Good Fair     
Levels: Fair Good Very Good Premium Ideal</code></pre>
</div>
</div>
</section>
<section id="model.matrix" class="slide level2">
<h2>model.matrix</h2>
<p>Check how R codes internally the variables. Let’s focus on <code>cut</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> lcarat <span class="sc">+</span> cut, <span class="at">data=</span>diamonds2)</span>
<span id="cb53-2"><a href="" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)    lcarat cutGood cutVery Good cutPremium cutIdeal
1           1 -2.120294       0            0          0        1
2           1 -2.251539       0            0          1        0
3           1 -2.120294       1            0          0        0
4           1 -1.785875       0            0          1        0
5           1 -1.689660       1            0          0        0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">levels</span>(diamonds2<span class="sc">$</span>cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fair"      "Good"      "Very Good" "Premium"   "Ideal"    </code></pre>
</div>
</div>
<p>For <code>cut</code>, “Fair” is the reference category.</p>
</section>
<section class="slide level2">

<p>More precisely, the model is</p>
<p><span class="math display">\[
\mbox{lprice}_i= \beta_0 + \beta_1 \mbox{carat}_i + \beta_2 \mbox{good}_i + \beta_3 \mbox{very good}_i + \beta_4 \mbox{premium}_i + \beta_5 \mbox{ideal}_i + \epsilon_i
\]</span> When <code>cut</code> is fair and good we get (respectively)</p>
<p><span class="math display">\[E(\mbox{lprice}_i \mid \mbox{fair}_i=1, \mbox{carat}_i)= \beta_0 + \beta_1 \mbox{lcarat}_i\]</span></p>
<p><span class="math display">\[
E(\mbox{lprice}_i \mid \mbox{good}_i=1, \mbox{carat}_i)= \beta_0 + \beta_1 \mbox{lcarat}_i + \beta_2
\]</span></p>
<p>The predicted difference cut - fair diamond is hence <span class="math inline">\(\beta_2\)</span>, regardless of carats. To facilitate interpretation, since <span class="math inline">\(\mbox{lprice}_i\)</span> is <span class="math inline">\(\log_2\)</span> price,</p>
<p><span class="math display">\[
\frac{2^{E(\log_2 \mbox{price}_i \mid \mbox{good}_i=1)}}{2^{E(\log_2 \mbox{price}_i \mid \mbox{fair}_i=1)}}= 2^{\beta_2}
\]</span></p>
</section>
<section id="section" class="slide level2">
<h2></h2>
<p>Estimates and CIs in the log2-scale (recall: <code>coefSummary</code> is a function that we defined)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmfit2<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity, <span class="at">data=</span>diamonds2)</span>
<span id="cb57-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(lmfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 4
   Parameter    Estimate `Conf. Int.`    `P-value`
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;    
 1 (Intercept)    11.3   (11.319,11.351) &lt;0.00001 
 2 lcarat          1.88  (1.882,1.886)   &lt;0.00001 
 3 cutGood         0.115 (0.104,0.126)   &lt;0.00001 
 4 cutVery Good    0.169 (0.159,0.179)   &lt;0.00001 
 5 cutPremium      0.201 (0.191,0.211)   &lt;0.00001 
 6 cutIdeal        0.233 (0.223,0.243)   &lt;0.00001 
 7 colorE         -0.078 (-0.084,-0.072) &lt;0.00001 
 8 colorF         -0.136 (-0.143,-0.13)  &lt;0.00001 
 9 colorG         -0.231 (-0.237,-0.225) &lt;0.00001 
10 colorH         -0.362 (-0.369,-0.356) &lt;0.00001 
11 colorI         -0.538 (-0.545,-0.53)  &lt;0.00001 
12 colorJ         -0.737 (-0.746,-0.729) &lt;0.00001 
13 claritySI2      0.617 (0.603,0.632)   &lt;0.00001 
14 claritySI1      0.855 (0.841,0.87)    &lt;0.00001 
15 clarityVS2      1.07  (1.056,1.085)   &lt;0.00001 
16 clarityVS1      1.17  (1.157,1.187)   &lt;0.00001 
17 clarityVVS2     1.37  (1.351,1.382)   &lt;0.00001 
18 clarityVVS1     1.47  (1.454,1.485)   &lt;0.00001 
19 clarityIF       1.61  (1.59,1.624)    &lt;0.00001 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s express them in the original scale. Fair -&gt; Good increases price by 1.08 (i.e.&nbsp;by 8%), Fair -&gt; Very good by 1.12 (i.e.&nbsp;by 12%), etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="" aria-hidden="true" tabindex="-1"></a>power2<span class="ot">=</span> <span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">^</span>x</span>
<span id="cb59-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(lmfit2, <span class="at">transform=</span> power2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 4
   Parameter    Estimate `Conf. Int.`        `P-value`
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;    
 1 (Intercept)  2583.    (2554.392,2612.707) &lt;0.00001 
 2 lcarat          3.69  (3.685,3.696)       &lt;0.00001 
 3 cutGood         1.08  (1.075,1.092)       &lt;0.00001 
 4 cutVery Good    1.12  (1.116,1.132)       &lt;0.00001 
 5 cutPremium      1.15  (1.141,1.158)       &lt;0.00001 
 6 cutIdeal        1.18  (1.167,1.183)       &lt;0.00001 
 7 colorE          0.947 (0.943,0.951)       &lt;0.00001 
 8 colorF          0.91  (0.906,0.914)       &lt;0.00001 
 9 colorG          0.852 (0.848,0.855)       &lt;0.00001 
10 colorH          0.778 (0.775,0.781)       &lt;0.00001 
11 colorI          0.689 (0.686,0.692)       &lt;0.00001 
12 colorJ          0.6   (0.596,0.604)       &lt;0.00001 
13 claritySI2      1.53  (1.519,1.55)        &lt;0.00001 
14 claritySI1      1.81  (1.791,1.828)       &lt;0.00001 
15 clarityVS2      2.1   (2.079,2.122)       &lt;0.00001 
16 clarityVS1      2.25  (2.23,2.276)        &lt;0.00001 
17 clarityVVS2     2.58  (2.551,2.606)       &lt;0.00001 
18 clarityVVS1     2.77  (2.74,2.8)          &lt;0.00001 
19 clarityIF       3.05  (3.01,3.082)        &lt;0.00001 </code></pre>
</div>
</div>
</section>
<section id="changing-the-reference-category" class="slide level2">
<h2>Changing the reference category</h2>
<p>Set J (worst color) as the reference category for <code>color</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="" aria-hidden="true" tabindex="-1"></a>diamonds2<span class="ot">=</span> <span class="fu">mutate</span>(diamonds2, <span class="at">color=</span><span class="fu">factor</span>(color, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'J'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>,<span class="st">'G'</span>,<span class="st">'H'</span>,<span class="st">'I'</span>)))</span>
<span id="cb61-2"><a href="" aria-hidden="true" tabindex="-1"></a>lmfit3<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity, <span class="at">data=</span>diamonds2)</span>
<span id="cb61-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(lmfit3, <span class="at">transform=</span>power2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 4
   Parameter    Estimate `Conf. Int.`       `P-value`
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;              &lt;chr&gt;    
 1 (Intercept)   1550.   (1531.55,1568.241) &lt;0.00001 
 2 lcarat           3.69 (3.685,3.696)      &lt;0.00001 
 3 cutGood          1.08 (1.075,1.092)      &lt;0.00001 
 4 cutVery Good     1.12 (1.116,1.132)      &lt;0.00001 
 5 cutPremium       1.15 (1.141,1.158)      &lt;0.00001 
 6 cutIdeal         1.18 (1.167,1.183)      &lt;0.00001 
 7 colorD           1.67 (1.657,1.677)      &lt;0.00001 
 8 colorE           1.58 (1.57,1.588)       &lt;0.00001 
 9 colorF           1.52 (1.508,1.525)      &lt;0.00001 
10 colorG           1.42 (1.412,1.428)      &lt;0.00001 
11 colorH           1.30 (1.289,1.304)      &lt;0.00001 
12 colorI           1.15 (1.141,1.155)      &lt;0.00001 
13 claritySI2       1.53 (1.519,1.55)       &lt;0.00001 
14 claritySI1       1.81 (1.791,1.828)      &lt;0.00001 
15 clarityVS2       2.1  (2.079,2.122)      &lt;0.00001 
16 clarityVS1       2.25 (2.23,2.276)       &lt;0.00001 
17 clarityVVS2      2.58 (2.551,2.606)      &lt;0.00001 
18 clarityVVS1      2.77 (2.74,2.8)         &lt;0.00001 
19 clarityIF        3.05 (3.01,3.082)       &lt;0.00001 </code></pre>
</div>
</div>
</section>
<section id="displaying-the-predictions" class="slide level2">
<h2>Displaying the predictions</h2>
<p>Functions <code>data_grid</code> and <code>add_predictions</code> in package <code>modelr</code></p>
<ul>
<li><p>Define grid of predictor values</p></li>
<li><p>Store prediction for each</p></li>
<li><p>Unspecified predictors set to mean (continuous) or reference category (discrete)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="" aria-hidden="true" tabindex="-1"></a>mygrid<span class="ot">=</span> <span class="fu">data_grid</span>(diamonds2, cut, color, clarity, <span class="at">.model=</span>lmfit2)</span>
<span id="cb63-2"><a href="" aria-hidden="true" tabindex="-1"></a>mygrid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 280 × 4
   cut   color clarity lcarat
   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
 1 Fair  J     I1      -0.515
 2 Fair  J     SI2     -0.515
 3 Fair  J     SI1     -0.515
 4 Fair  J     VS2     -0.515
 5 Fair  J     VS1     -0.515
 6 Fair  J     VVS2    -0.515
 7 Fair  J     VVS1    -0.515
 8 Fair  J     IF      -0.515
 9 Fair  D     I1      -0.515
10 Fair  D     SI2     -0.515
# ℹ 270 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmpred2<span class="ot">=</span> <span class="fu">add_predictions</span>(mygrid, <span class="at">model=</span>lmfit2)</span>
<span id="cb65-2"><a href="" aria-hidden="true" tabindex="-1"></a>lmpred2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 280 × 5
   cut   color clarity lcarat  pred
   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 Fair  J     I1      -0.515  9.63
 2 Fair  J     SI2     -0.515 10.2 
 3 Fair  J     SI1     -0.515 10.5 
 4 Fair  J     VS2     -0.515 10.7 
 5 Fair  J     VS1     -0.515 10.8 
 6 Fair  J     VVS2    -0.515 11.0 
 7 Fair  J     VVS1    -0.515 11.1 
 8 Fair  J     IF      -0.515 11.2 
 9 Fair  D     I1      -0.515 10.4 
10 Fair  D     SI2     -0.515 11.0 
# ℹ 270 more rows</code></pre>
</div>
</div>
<p><code>add_predictions</code> requires that <code>model</code> is of type <code>lm</code> / object that has a <code>predict</code> method</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lmpred2, <span class="fu">aes</span>(<span class="at">x=</span>clarity, <span class="at">y=</span>pred, <span class="at">color=</span>color)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cut) <span class="sc">+</span></span>
<span id="cb67-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">'log2 (price)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-45-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="linear-contrasts" class="title-slide slide level1 center">
<h1>Linear contrasts</h1>

</section>
<section id="linear-contrasts-1" class="slide level2">
<h2>Linear contrasts</h2>
<p>We wish to obtain a conf. int. for cut= “Ideal” - “Premium”</p>
<ul>
<li><p><span class="math inline">\(\beta_5\)</span>: mean for “Premium” - mean for “Fair” (reference)</p></li>
<li><p><span class="math inline">\(\beta_6\)</span>: mean for “Ideal” - mean for “Fair” (reference)</p></li>
<li><p><span class="math inline">\(\beta_6 - \beta_5\)</span>: mean for “Ideal” - mean for “Premium”</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(lmfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 4
   Parameter    Estimate `Conf. Int.`    `P-value`
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;    
 1 (Intercept)    11.3   (11.319,11.351) &lt;0.00001 
 2 lcarat          1.88  (1.882,1.886)   &lt;0.00001 
 3 cutGood         0.115 (0.104,0.126)   &lt;0.00001 
 4 cutVery Good    0.169 (0.159,0.179)   &lt;0.00001 
 5 cutPremium      0.201 (0.191,0.211)   &lt;0.00001 
 6 cutIdeal        0.233 (0.223,0.243)   &lt;0.00001 
 7 colorE         -0.078 (-0.084,-0.072) &lt;0.00001 
 8 colorF         -0.136 (-0.143,-0.13)  &lt;0.00001 
 9 colorG         -0.231 (-0.237,-0.225) &lt;0.00001 
10 colorH         -0.362 (-0.369,-0.356) &lt;0.00001 
11 colorI         -0.538 (-0.545,-0.53)  &lt;0.00001 
12 colorJ         -0.737 (-0.746,-0.729) &lt;0.00001 
13 claritySI2      0.617 (0.603,0.632)   &lt;0.00001 
14 claritySI1      0.855 (0.841,0.87)    &lt;0.00001 
15 clarityVS2      1.07  (1.056,1.085)   &lt;0.00001 
16 clarityVS1      1.17  (1.157,1.187)   &lt;0.00001 
17 clarityVVS2     1.37  (1.351,1.382)   &lt;0.00001 
18 clarityVVS1     1.47  (1.454,1.485)   &lt;0.00001 
19 clarityIF       1.61  (1.59,1.624)    &lt;0.00001 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p><strong>Goal.</strong> Test <span class="math inline">\(H_0: \beta_6 - \beta_5=0\)</span>. Get 95% confidence interval</p>
<p>Linear contrasts done by <code>glht</code> (general linear hypotheses, R package <code>multcomp</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="" aria-hidden="true" tabindex="-1"></a>C<span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="fu">coef</span>(lmfit2)))</span>
<span id="cb70-2"><a href="" aria-hidden="true" tabindex="-1"></a>C[<span class="dv">1</span>,<span class="dv">5</span>]<span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>; C[<span class="dv">1</span>,<span class="dv">6</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb70-3"><a href="" aria-hidden="true" tabindex="-1"></a>C[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co">#show first 10 columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0  0  0  0 -1  1  0  0  0  0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="" aria-hidden="true" tabindex="-1"></a>PvsI<span class="ot">=</span> <span class="fu">glht</span>(lmfit2, C)</span>
<span id="cb72-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PvsI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lm(formula = lprice ~ lcarat + cut + color + clarity, data = diamonds2)

Linear Hypotheses:
       Estimate Std. Error t value Pr(&gt;|t|)    
1 == 0  0.03156    0.00215   14.68   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(PvsI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Confidence Intervals

Fit: lm(formula = lprice ~ lcarat + cut + color + clarity, data = diamonds2)

Quantile = 1.96
95% family-wise confidence level
 

Linear Hypotheses:
       Estimate lwr     upr    
1 == 0 0.03156  0.02734 0.03577</code></pre>
</div>
</div>
</section>
<section id="doing-it-on-our-own" class="slide level2">
<h2>Doing it on our own</h2>
<p>Recall that <span class="math inline">\(\hat{\beta} \sim N(\beta, V)\)</span>, where <span class="math inline">\(V= \sigma^2 (X^T X)^{-1}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="" aria-hidden="true" tabindex="-1"></a>bhat<span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">coef</span>(lmfit2), <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb76-2"><a href="" aria-hidden="true" tabindex="-1"></a>V<span class="ot">=</span> <span class="fu">vcov</span>(lmfit2)</span>
<span id="cb76-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(V)), <span class="dv">5</span>) <span class="co">#SE's for beta's (compare to summary(lmfit2))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)       lcarat      cutGood cutVery Good   cutPremium     cutIdeal 
     0.00831      0.00113      0.00561      0.00522      0.00516      0.00512 
      colorE       colorF       colorG       colorH       colorI       colorJ 
     0.00306      0.00309      0.00302      0.00321      0.00360      0.00443 
  claritySI2   claritySI1   clarityVS2   clarityVS1  clarityVVS2  clarityVVS1 
     0.00747      0.00743      0.00747      0.00758      0.00782      0.00804 
   clarityIF 
     0.00870 </code></pre>
</div>
</div>
<p>Recall that <span class="math inline">\(C \hat{\beta} \sim N(C \beta, C V C^T)\)</span>. For us <span class="math inline">\(C \hat{\beta}= \hat{\beta}_6 - \hat{\beta}_5\)</span>, <span class="math inline">\(C\beta =\beta_6 - \beta_5\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="" aria-hidden="true" tabindex="-1"></a>dhat<span class="ot">=</span> C <span class="sc">%*%</span> bhat</span>
<span id="cb78-2"><a href="" aria-hidden="true" tabindex="-1"></a>se<span class="ot">=</span> <span class="fu">sqrt</span>(C <span class="sc">%*%</span> V <span class="sc">%*%</span> <span class="fu">t</span>(C))</span>
<span id="cb78-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(se, <span class="dv">5</span>) <span class="co">#matches previous slide</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
[1,] 0.00215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="" aria-hidden="true" tabindex="-1"></a>dhat.ci<span class="ot">=</span> <span class="fu">c</span>(<span class="at">estimate=</span>dhat, <span class="at">ci.low=</span> dhat <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se, <span class="at">ci.up=</span> dhat <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb80-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dhat.ci, <span class="dv">5</span>) <span class="co">#matches previous slide</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>estimate   ci.low    ci.up 
 0.03156  0.02734  0.03577 </code></pre>
</div>
</div>
</section></section>
<section>
<section id="interactions" class="title-slide slide level1 center">
<h1>Interactions</h1>

</section>
<section class="slide level2">

<p>The effect of a covariate may depend on others</p>
<p><strong>Example.</strong> Does effect of carats depend on cut?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2, <span class="fu">aes</span>(lcarat, lprice, <span class="at">color=</span>cut)) <span class="sc">+</span></span>
<span id="cb82-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb82-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-51-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Let’s fit a model with interactions. All coefficients are statistically significant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmfit3<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> lcarat<span class="sc">:</span>cut, <span class="at">data=</span>diamonds2)</span>
<span id="cb83-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(lmfit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   Parameter           Estimate `Conf. Int.`   `P-value`
   &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    
 1 (Intercept)           11.8   (11.794,11.83) &lt;0.00001 
 2 lcarat                 1.50  (1.468,1.521)  &lt;0.00001 
 3 cutGood                0.272 (0.25,0.293)   &lt;0.00001 
 4 cutVery Good           0.382 (0.363,0.402)  &lt;0.00001 
 5 cutPremium             0.346 (0.327,0.365)  &lt;0.00001 
 6 cutIdeal               0.484 (0.465,0.504)  &lt;0.00001 
 7 lcarat:cutGood         0.241 (0.211,0.271)  &lt;0.00001 
 8 lcarat:cutVery Good    0.232 (0.204,0.259)  &lt;0.00001 
 9 lcarat:cutPremium      0.162 (0.135,0.19)   &lt;0.00001 
10 lcarat:cutIdeal        0.212 (0.185,0.24)   &lt;0.00001 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>We just fitted the model</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\mbox{lprice}_i= \beta_0 + \beta_1 \mbox{lcarat}_i + \beta_2 \mbox{good}_i + \beta_3 \mbox{vgood}_i + \beta_4 \mbox{premium}_i + \beta_5 \mbox{ideal}_i +
\\
&amp;
\beta_6 \mbox{lcarat}_i \mbox{good}_i + \beta_7 \mbox{lcarat}_i \mbox{vgood}_i + \beta_8 \mbox{lcarat}_i \mbox{premium}_i + \beta_9 \mbox{lcarat}_i \mbox{ideal}_i + \epsilon_i
\end{aligned}
\]</span></p>
<p>For example, when cut=“fair” <span class="math display">\[
\mbox{lprice}_i= \beta_0 + \beta_1 \mbox{lcarat}_i
\]</span> and when cut=“good” <span class="math display">\[
\mbox{lprice}_i= \beta_0 + \beta_2 + (\beta_1 + \beta_6) \mbox{lcarat}_i
\]</span></p>
<p>How do we interpret <span class="math inline">\(\beta_6\)</span>?</p>
</section>
<section class="slide level2 scrollable">

<p>If <span class="math inline">\(H_0: \beta_6=\beta_7=\beta_8=\beta_9=0\)</span>, then no interactions needed</p>
<ol type="1">
<li><p>Fit models with and without interactions</p></li>
<li><p>Compare with likelihood-ratio test (=ANOVA for linear models)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmfit4<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut, <span class="at">data=</span>diamonds2)</span>
<span id="cb85-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lmfit4, lmfit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: lprice ~ lcarat + cut
Model 2: lprice ~ lcarat + cut + lcarat:cut
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1  53934 7270.0                                  
2  53930 7210.1  4    59.874 111.96 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="the-full-exercise" class="slide level2">
<h2>The full exercise</h2>
<p>Consider all possible interactions. All P-values are highly statistically significant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="" aria-hidden="true" tabindex="-1"></a>lmfull<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity <span class="sc">+</span> lcarat<span class="sc">:</span>cut <span class="sc">+</span> lcarat<span class="sc">:</span>color <span class="sc">+</span> lcarat<span class="sc">:</span>clarity, <span class="at">data=</span>diamonds2)</span>
<span id="cb87-2"><a href="" aria-hidden="true" tabindex="-1"></a>lmdrop1<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity <span class="sc">+</span> lcarat<span class="sc">:</span>color <span class="sc">+</span> lcarat<span class="sc">:</span>clarity, <span class="at">data=</span>diamonds2)</span>
<span id="cb87-3"><a href="" aria-hidden="true" tabindex="-1"></a>pvalue1<span class="ot">=</span> <span class="fu">anova</span>(lmdrop1, lmfull)[[<span class="st">'Pr(&gt;F)'</span>]][<span class="dv">2</span>]</span>
<span id="cb87-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="" aria-hidden="true" tabindex="-1"></a>lmdrop2<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity <span class="sc">+</span> lcarat<span class="sc">:</span>cut <span class="sc">+</span> lcarat<span class="sc">:</span>clarity, <span class="at">data=</span>diamonds2)</span>
<span id="cb87-6"><a href="" aria-hidden="true" tabindex="-1"></a>pvalue2<span class="ot">=</span> <span class="fu">anova</span>(lmdrop2, lmfull)[[<span class="st">'Pr(&gt;F)'</span>]][<span class="dv">2</span>]</span>
<span id="cb87-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="" aria-hidden="true" tabindex="-1"></a>lmdrop3<span class="ot">=</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> lcarat <span class="sc">+</span> cut <span class="sc">+</span> color <span class="sc">+</span> clarity <span class="sc">+</span> lcarat<span class="sc">:</span>cut <span class="sc">+</span> lcarat<span class="sc">:</span>color, <span class="at">data=</span>diamonds2)</span>
<span id="cb87-9"><a href="" aria-hidden="true" tabindex="-1"></a>pvalue3<span class="ot">=</span> <span class="fu">anova</span>(lmdrop3, lmfull)[[<span class="st">'Pr(&gt;F)'</span>]][<span class="dv">2</span>]</span>
<span id="cb87-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(pvalue1, pvalue2, pvalue3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.092037e-272  9.480426e-27 1.017366e-132</code></pre>
</div>
</div>
<p>However, predictions are nearly identical</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit2)<span class="sc">$</span>r.squared <span class="co">#additive model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9826161</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfull)<span class="sc">$</span>r.squared <span class="co">#additive + all pairwise interactions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9832858</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="" aria-hidden="true" tabindex="-1"></a>diamonds2<span class="sc">$</span>predfull<span class="ot">=</span> <span class="fu">predict</span>(lmfull)</span>
<span id="cb93-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(diamonds2<span class="sc">$</span>pred2, diamonds2<span class="sc">$</span>predfull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9996594</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>Earlier we plotted price vs.&nbsp;carat &amp; cut. <code>carat:cut</code> impacted predictions</p></li>
<li><p>Regressing price vs.&nbsp;carat, cut, color &amp; clarity. &lt;interactions don’t change predictions much</p></li>
</ul>
<p>Why? After adding all covariates, estimated interaction coef. became smaller</p>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Carat &amp; Cut</a></li><li><a href="#tabset-6-2">All covariates</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: left;">Conf. Int.</th>
<th style="text-align: left;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lcarat:cutGood</td>
<td style="text-align: right;">0.241</td>
<td style="text-align: left;">(0.211,0.271)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:cutVery Good</td>
<td style="text-align: right;">0.232</td>
<td style="text-align: left;">(0.204,0.259)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:cutPremium</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: left;">(0.135,0.19)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:cutIdeal</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: left;">(0.185,0.24)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: left;">Conf. Int.</th>
<th style="text-align: left;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lcarat:cutGood</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: left;">(0.064,0.095)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:cutVery Good</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: left;">(0.081,0.111)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:cutPremium</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: left;">(-0.004,0.026)</td>
<td style="text-align: left;">0.14689</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:cutIdeal</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: left;">(0.069,0.098)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:colorD</td>
<td style="text-align: right;">-0.004</td>
<td style="text-align: left;">(-0.015,0.006)</td>
<td style="text-align: left;">0.42455</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:colorE</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: left;">(-0.004,0.015)</td>
<td style="text-align: left;">0.27212</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:colorF</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: left;">(0.018,0.037)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:colorG</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: left;">(0.018,0.037)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:colorH</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: left;">(-0.005,0.014)</td>
<td style="text-align: left;">0.33373</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:colorI</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: left;">(0.008,0.028)</td>
<td style="text-align: left;">0.00037</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:claritySI2</td>
<td style="text-align: right;">0.239</td>
<td style="text-align: left;">(0.218,0.261)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:claritySI1</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: left;">(0.233,0.276)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:clarityVS2</td>
<td style="text-align: right;">0.226</td>
<td style="text-align: left;">(0.204,0.247)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:clarityVS1</td>
<td style="text-align: right;">0.238</td>
<td style="text-align: left;">(0.216,0.26)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:clarityVVS2</td>
<td style="text-align: right;">0.229</td>
<td style="text-align: left;">(0.207,0.252)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="even">
<td style="text-align: left;">lcarat:clarityVVS1</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: left;">(0.182,0.228)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcarat:clarityIF</td>
<td style="text-align: right;">0.218</td>
<td style="text-align: left;">(0.194,0.243)</td>
<td style="text-align: left;">&lt;0.00001</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p><code>multiplot</code> visually compares coefficients across models. Interactions lcarat:cut are smaller under the full model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(lmfull, lmfit3, <span class="at">intercept=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-59-1.png" width="960" class="r-stretch"></section>
<section id="specifying-interactions-in-r" class="slide level2">
<h2>Specifying interactions in R</h2>
<p>We simulate some data for illustration</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>); x2<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>); x3<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb96-2"><a href="" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, x1 <span class="sc">+</span> x2<span class="sc">/</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">1</span>)  <span class="co">#y = x1 + x2/2 + e, e ~ N(0,1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Three ways to specify the same regression equation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">:</span>x2 <span class="sc">+</span> x1<span class="sc">:</span>x3 <span class="sc">+</span> x2<span class="sc">:</span>x3)</span>
<span id="cb97-2"><a href="" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> x2<span class="sc">*</span>x3) <span class="co">#with * you can drop the additive terms</span></span>
<span id="cb97-3"><a href="" aria-hidden="true" tabindex="-1"></a>fit3<span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> (x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3)<span class="sc">^</span><span class="dv">2</span>) <span class="co">#^2 adds main effects + interactions in one go</span></span>
<span id="cb97-4"><a href="" aria-hidden="true" tabindex="-1"></a>fit3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ (x1 + x2 + x3)^2)

Coefficients:
(Intercept)           x1           x2           x3        x1:x2        x1:x3  
    0.13701      1.22747      0.52670      0.03152     -0.04235      0.06459  
      x2:x3  
   -0.01678  </code></pre>
</div>
</div>
</section></section>
<section>
<section id="nested-models" class="title-slide slide level1 center">
<h1>Nested models</h1>

</section>
<section class="slide level2">

<p>A particular type of interaction is when data are nested within units (e.g.&nbsp;countries), and we wanna fit a model for each unit</p>
<p><strong>Example</strong> gapminder data (country life expectancy over time)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb99-2"><a href="" aria-hidden="true" tabindex="-1"></a>gapminder</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(year, lifeExp, <span class="at">group =</span> country)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> continent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-63-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Two ways to fit a model separately for each country:</p>
<ul>
<li><p><code>lm</code> plus interaction with country. Check which is the reference country, recover intercept/slopes for the rest</p></li>
<li><p>Use <code>group_by</code> and <code>map_df</code></p></li>
</ul>
<p>Note: better alternatives to fit nested models (random effects/hierarchical models)</p>
<p>First, group by country and <code>nest</code> dataset: each row is a country, and column <code>$data</code> is a list of tibbles</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="" aria-hidden="true" tabindex="-1"></a>gm_country<span class="ot">=</span> <span class="fu">group_by</span>(gapminder, country, continent) <span class="sc">|&gt;</span> <span class="fu">nest</span>() </span>
<span id="cb102-2"><a href="" aria-hidden="true" tabindex="-1"></a>gm_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
# Groups:   country, continent [142]
   country     continent data             
   &lt;fct&gt;       &lt;fct&gt;     &lt;list&gt;           
 1 Afghanistan Asia      &lt;tibble [12 × 4]&gt;
 2 Albania     Europe    &lt;tibble [12 × 4]&gt;
 3 Algeria     Africa    &lt;tibble [12 × 4]&gt;
 4 Angola      Africa    &lt;tibble [12 × 4]&gt;
 5 Argentina   Americas  &lt;tibble [12 × 4]&gt;
 6 Australia   Oceania   &lt;tibble [12 × 4]&gt;
 7 Austria     Europe    &lt;tibble [12 × 4]&gt;
 8 Bahrain     Asia      &lt;tibble [12 × 4]&gt;
 9 Bangladesh  Asia      &lt;tibble [12 × 4]&gt;
10 Belgium     Europe    &lt;tibble [12 × 4]&gt;
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Second, define a function to be applied to each dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="" aria-hidden="true" tabindex="-1"></a>fitmodel<span class="ot">=</span> <span class="cf">function</span>(df) {</span>
<span id="cb104-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Return OLS and R2 for lifeExp ~ year</span></span>
<span id="cb104-3"><a href="" aria-hidden="true" tabindex="-1"></a>  fit<span class="ot">=</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year, <span class="at">data=</span>df)</span>
<span id="cb104-4"><a href="" aria-hidden="true" tabindex="-1"></a>  ans<span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(fit), <span class="fu">summary</span>(fit)<span class="sc">$</span>r.squared)</span>
<span id="cb104-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(ans)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">'b0'</span>,<span class="st">'b1'</span>,<span class="st">'R2'</span>)</span>
<span id="cb104-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ans)</span>
<span id="cb104-7"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, use <code>map_df</code> to apply <code>fitmodel</code> to each entry of the list <code>gm_country$data</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="" aria-hidden="true" tabindex="-1"></a>coef_gm <span class="ot">=</span> <span class="fu">map_df</span>(gm_country<span class="sc">$</span>data, fitmodel)</span>
<span id="cb105-2"><a href="" aria-hidden="true" tabindex="-1"></a>coef_gm <span class="ot">=</span> <span class="fu">cbind</span>(gm_country, coef_gm)</span>
<span id="cb105-3"><a href="" aria-hidden="true" tabindex="-1"></a>coef_gm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 6
# Groups:   country, continent [142]
   country     continent data                  b0    b1    R2
   &lt;fct&gt;       &lt;fct&gt;     &lt;list&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Afghanistan Asia      &lt;tibble [12 × 4]&gt;  -508. 0.275 0.948
 2 Albania     Europe    &lt;tibble [12 × 4]&gt;  -594. 0.335 0.911
 3 Algeria     Africa    &lt;tibble [12 × 4]&gt; -1068. 0.569 0.985
 4 Angola      Africa    &lt;tibble [12 × 4]&gt;  -377. 0.209 0.888
 5 Argentina   Americas  &lt;tibble [12 × 4]&gt;  -390. 0.232 0.996
 6 Australia   Oceania   &lt;tibble [12 × 4]&gt;  -376. 0.228 0.980
 7 Austria     Europe    &lt;tibble [12 × 4]&gt;  -406. 0.242 0.992
 8 Bahrain     Asia      &lt;tibble [12 × 4]&gt;  -860. 0.468 0.967
 9 Bangladesh  Asia      &lt;tibble [12 × 4]&gt;  -936. 0.498 0.989
10 Belgium     Europe    &lt;tibble [12 × 4]&gt;  -340. 0.209 0.995
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>The <span class="math inline">\(R^2\)</span> coefficient is large for most countries, but pretty small for a few</p>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1"><span class="math inline">\(R^2\)</span> histogram</a></li><li><a href="#tabset-7-2">Countries</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(coef_gm, <span class="fu">aes</span>(<span class="at">x=</span>R2)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-67-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr:filter and dplyr::select ensures using functions (filter,select) from package dplyr</span></span>
<span id="cb108-2"><a href="" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(coef_gm, R2 <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(country, continent, R2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
# Groups:   country, continent [13]
   country                  continent     R2
   &lt;fct&gt;                    &lt;fct&gt;      &lt;dbl&gt;
 1 Botswana                 Africa    0.0340
 2 Central African Republic Africa    0.493 
 3 Congo, Dem. Rep.         Africa    0.348 
 4 Cote d'Ivoire            Africa    0.283 
 5 Kenya                    Africa    0.443 
 6 Lesotho                  Africa    0.0849
 7 Namibia                  Africa    0.437 
 8 Rwanda                   Africa    0.0172
 9 South Africa             Africa    0.312 
10 Swaziland                Africa    0.0682
11 Uganda                   Africa    0.342 
12 Zambia                   Africa    0.0598
13 Zimbabwe                 Africa    0.0562</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>Unnest the dataset and add predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="" aria-hidden="true" tabindex="-1"></a>coef_gmu<span class="ot">=</span> <span class="fu">unnest</span>(coef_gm, <span class="at">cols=</span><span class="fu">names</span>(coef_gm)) <span class="sc">|&gt;</span>  <span class="co">#unnest &amp; keep all columns</span></span>
<span id="cb110-2"><a href="" aria-hidden="true" tabindex="-1"></a>          <span class="fu">transform</span>(<span class="at">pred=</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>year) <span class="sc">|&gt;</span>         <span class="co">#add predictions</span></span>
<span id="cb110-3"><a href="" aria-hidden="true" tabindex="-1"></a>          <span class="fu">transform</span>(<span class="at">R2=</span><span class="fu">round</span>(R2,<span class="dv">3</span>), <span class="at">lifeExp=</span><span class="fu">round</span>(lifeExp,<span class="dv">1</span>), <span class="at">pred=</span><span class="fu">round</span>(pred,<span class="dv">1</span>)) <span class="co">#round</span></span>
<span id="cb110-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(coef_gmu, country, year, lifeExp, gdpPercap, R2, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      country year lifeExp   gdpPercap    R2 pred
1                 Afghanistan 1952    28.8    779.4453 0.948 29.9
2                 Afghanistan 1957    30.3    820.8530 0.948 31.3
3                 Afghanistan 1962    32.0    853.1007 0.948 32.7
4                 Afghanistan 1967    34.0    836.1971 0.948 34.0
5                 Afghanistan 1972    36.1    739.9811 0.948 35.4
6                 Afghanistan 1977    38.4    786.1134 0.948 36.8
7                 Afghanistan 1982    39.9    978.0114 0.948 38.2
8                 Afghanistan 1987    40.8    852.3959 0.948 39.5
9                 Afghanistan 1992    41.7    649.3414 0.948 40.9
10                Afghanistan 1997    41.8    635.3414 0.948 42.3
11                Afghanistan 2002    42.1    726.7341 0.948 43.7
12                Afghanistan 2007    43.8    974.5803 0.948 45.1
13                    Albania 1952    55.2   1601.0561 0.911 59.2
14                    Albania 1957    59.3   1942.2842 0.911 60.9
15                    Albania 1962    64.8   2312.8890 0.911 62.6
16                    Albania 1967    66.2   2760.1969 0.911 64.2
17                    Albania 1972    67.7   3313.4222 0.911 65.9
18                    Albania 1977    68.9   3533.0039 0.911 67.6
19                    Albania 1982    70.4   3630.8807 0.911 69.3
20                    Albania 1987    72.0   3738.9327 0.911 70.9
21                    Albania 1992    71.6   2497.4379 0.911 72.6
22                    Albania 1997    73.0   3193.0546 0.911 74.3
23                    Albania 2002    75.7   4604.2117 0.911 76.0
24                    Albania 2007    76.4   5937.0295 0.911 77.6
25                    Algeria 1952    43.1   2449.0082 0.985 43.4
26                    Algeria 1957    45.7   3013.9760 0.985 46.2
27                    Algeria 1962    48.3   2550.8169 0.985 49.1
28                    Algeria 1967    51.4   3246.9918 0.985 51.9
29                    Algeria 1972    54.5   4182.6638 0.985 54.8
30                    Algeria 1977    58.0   4910.4168 0.985 57.6
31                    Algeria 1982    61.4   5745.1602 0.985 60.5
32                    Algeria 1987    65.8   5681.3585 0.985 63.3
33                    Algeria 1992    67.7   5023.2166 0.985 66.1
34                    Algeria 1997    69.2   4797.2951 0.985 69.0
35                    Algeria 2002    71.0   5288.0404 0.985 71.8
36                    Algeria 2007    72.3   6223.3675 0.985 74.7
37                     Angola 1952    30.0   3520.6103 0.888 32.1
38                     Angola 1957    32.0   3827.9405 0.888 33.2
39                     Angola 1962    34.0   4269.2767 0.888 34.2
40                     Angola 1967    36.0   5522.7764 0.888 35.3
41                     Angola 1972    37.9   5473.2880 0.888 36.3
42                     Angola 1977    39.5   3008.6474 0.888 37.4
43                     Angola 1982    39.9   2756.9537 0.888 38.4
44                     Angola 1987    39.9   2430.2083 0.888 39.5
45                     Angola 1992    40.6   2627.8457 0.888 40.5
46                     Angola 1997    41.0   2277.1409 0.888 41.5
47                     Angola 2002    41.0   2773.2873 0.888 42.6
48                     Angola 2007    42.7   4797.2313 0.888 43.6
49                  Argentina 1952    62.5   5911.3151 0.996 62.7
50                  Argentina 1957    64.4   6856.8562 0.996 63.8
51                  Argentina 1962    65.1   7133.1660 0.996 65.0
52                  Argentina 1967    65.6   8052.9530 0.996 66.2
53                  Argentina 1972    67.1   9443.0385 0.996 67.3
54                  Argentina 1977    68.5  10079.0267 0.996 68.5
55                  Argentina 1982    69.9   8997.8974 0.996 69.6
56                  Argentina 1987    70.8   9139.6714 0.996 70.8
57                  Argentina 1992    71.9   9308.4187 0.996 72.0
58                  Argentina 1997    73.3  10967.2820 0.996 73.1
59                  Argentina 2002    74.3   8797.6407 0.996 74.3
60                  Argentina 2007    75.3  12779.3796 0.996 75.4
61                  Australia 1952    69.1  10039.5956 0.980 68.4
62                  Australia 1957    70.3  10949.6496 0.980 69.5
63                  Australia 1962    70.9  12217.2269 0.980 70.7
64                  Australia 1967    71.1  14526.1246 0.980 71.8
65                  Australia 1972    71.9  16788.6295 0.980 73.0
66                  Australia 1977    73.5  18334.1975 0.980 74.1
67                  Australia 1982    74.7  19477.0093 0.980 75.2
68                  Australia 1987    76.3  21888.8890 0.980 76.4
69                  Australia 1992    77.6  23424.7668 0.980 77.5
70                  Australia 1997    78.8  26997.9366 0.980 78.6
71                  Australia 2002    80.4  30687.7547 0.980 79.8
72                  Australia 2007    81.2  34435.3674 0.980 80.9
73                    Austria 1952    66.8   6137.0765 0.992 66.4
74                    Austria 1957    67.5   8842.5980 0.992 67.7
75                    Austria 1962    69.5  10750.7211 0.992 68.9
76                    Austria 1967    70.1  12834.6024 0.992 70.1
77                    Austria 1972    70.6  16661.6256 0.992 71.3
78                    Austria 1977    72.2  19749.4223 0.992 72.5
79                    Austria 1982    73.2  21597.0836 0.992 73.7
80                    Austria 1987    74.9  23687.8261 0.992 74.9
81                    Austria 1992    76.0  27042.0187 0.992 76.1
82                    Austria 1997    77.5  29095.9207 0.992 77.3
83                    Austria 2002    79.0  32417.6077 0.992 78.5
84                    Austria 2007    79.8  36126.4927 0.992 79.8
85                    Bahrain 1952    50.9   9867.0848 0.967 52.7
86                    Bahrain 1957    53.8  11635.7995 0.967 55.1
87                    Bahrain 1962    56.9  12753.2751 0.967 57.4
88                    Bahrain 1967    59.9  14804.6727 0.967 59.8
89                    Bahrain 1972    63.3  18268.6584 0.967 62.1
90                    Bahrain 1977    65.6  19340.1020 0.967 64.4
91                    Bahrain 1982    69.1  19211.1473 0.967 66.8
92                    Bahrain 1987    70.8  18524.0241 0.967 69.1
93                    Bahrain 1992    72.6  19035.5792 0.967 71.4
94                    Bahrain 1997    73.9  20292.0168 0.967 73.8
95                    Bahrain 2002    74.8  23403.5593 0.967 76.1
96                    Bahrain 2007    75.6  29796.0483 0.967 78.5
97                 Bangladesh 1952    37.5    684.2442 0.989 36.1
98                 Bangladesh 1957    39.3    661.6375 0.989 38.6
99                 Bangladesh 1962    41.2    686.3416 0.989 41.1
100                Bangladesh 1967    43.5    721.1861 0.989 43.6
101                Bangladesh 1972    45.3    630.2336 0.989 46.1
102                Bangladesh 1977    46.9    659.8772 0.989 48.6
103                Bangladesh 1982    50.0    676.9819 0.989 51.1
104                Bangladesh 1987    52.8    751.9794 0.989 53.6
105                Bangladesh 1992    56.0    837.8102 0.989 56.1
106                Bangladesh 1997    59.4    972.7700 0.989 58.6
107                Bangladesh 2002    62.0   1136.3904 0.989 61.0
108                Bangladesh 2007    64.1   1391.2538 0.989 63.5
109                   Belgium 1952    68.0   8343.1051 0.995 67.9
110                   Belgium 1957    69.2   9714.9606 0.995 68.9
111                   Belgium 1962    70.2  10991.2068 0.995 70.0
112                   Belgium 1967    70.9  13149.0412 0.995 71.0
113                   Belgium 1972    71.4  16672.1436 0.995 72.1
114                   Belgium 1977    72.8  19117.9745 0.995 73.1
115                   Belgium 1982    73.9  20979.8459 0.995 74.2
116                   Belgium 1987    75.3  22525.5631 0.995 75.2
117                   Belgium 1992    76.5  25575.5707 0.995 76.3
118                   Belgium 1997    77.5  27561.1966 0.995 77.3
119                   Belgium 2002    78.3  30485.8838 0.995 78.3
120                   Belgium 2007    79.4  33692.6051 0.995 79.4
121                     Benin 1952    38.2   1062.7522 0.967 39.6
122                     Benin 1957    40.4    959.6011 0.967 41.3
123                     Benin 1962    42.6    949.4991 0.967 42.9
124                     Benin 1967    44.9   1035.8314 0.967 44.6
125                     Benin 1972    47.0   1085.7969 0.967 46.3
126                     Benin 1977    49.2   1029.1613 0.967 47.9
127                     Benin 1982    50.9   1277.8976 0.967 49.6
128                     Benin 1987    52.3   1225.8560 0.967 51.3
129                     Benin 1992    53.9   1191.2077 0.967 53.0
130                     Benin 1997    54.8   1232.9753 0.967 54.6
131                     Benin 2002    54.4   1372.8779 0.967 56.3
132                     Benin 2007    56.7   1441.2849 0.967 58.0
133                   Bolivia 1952    40.4   2677.3263 0.985 38.8
134                   Bolivia 1957    41.9   2127.6863 0.985 41.3
135                   Bolivia 1962    43.4   2180.9725 0.985 43.8
136                   Bolivia 1967    45.0   2586.8861 0.985 46.3
137                   Bolivia 1972    46.7   2980.3313 0.985 48.8
138                   Bolivia 1977    50.0   3548.0978 0.985 51.3
139                   Bolivia 1982    53.9   3156.5105 0.985 53.8
140                   Bolivia 1987    57.3   2753.6915 0.985 56.3
141                   Bolivia 1992    60.0   2961.6997 0.985 58.8
142                   Bolivia 1997    62.0   3326.1432 0.985 61.3
143                   Bolivia 2002    63.9   3413.2627 0.985 63.8
144                   Bolivia 2007    65.6   3822.1371 0.985 66.3
145    Bosnia and Herzegovina 1952    53.8    973.5332 0.896 58.1
146    Bosnia and Herzegovina 1957    58.5   1353.9892 0.896 59.8
147    Bosnia and Herzegovina 1962    61.9   1709.6837 0.896 61.6
148    Bosnia and Herzegovina 1967    64.8   2172.3524 0.896 63.3
149    Bosnia and Herzegovina 1972    67.4   2860.1698 0.896 65.1
150    Bosnia and Herzegovina 1977    69.9   3528.4813 0.896 66.8
151    Bosnia and Herzegovina 1982    70.7   4126.6132 0.896 68.6
152    Bosnia and Herzegovina 1987    71.1   4314.1148 0.896 70.3
153    Bosnia and Herzegovina 1992    72.2   2546.7814 0.896 72.1
154    Bosnia and Herzegovina 1997    73.2   4766.3559 0.896 73.8
155    Bosnia and Herzegovina 2002    74.1   6018.9752 0.896 75.6
156    Bosnia and Herzegovina 2007    74.9   7446.2988 0.896 77.3
157                  Botswana 1952    47.6    851.2411 0.034 52.9
158                  Botswana 1957    49.6    918.2325 0.034 53.2
159                  Botswana 1962    51.5    983.6540 0.034 53.5
160                  Botswana 1967    53.3   1214.7093 0.034 53.8
161                  Botswana 1972    56.0   2263.6111 0.034 54.1
162                  Botswana 1977    59.3   3214.8578 0.034 54.4
163                  Botswana 1982    61.5   4551.1421 0.034 54.7
164                  Botswana 1987    63.6   6205.8839 0.034 55.1
165                  Botswana 1992    62.7   7954.1116 0.034 55.4
166                  Botswana 1997    52.6   8647.1423 0.034 55.7
167                  Botswana 2002    46.6  11003.6051 0.034 56.0
168                  Botswana 2007    50.7  12569.8518 0.034 56.3
169                    Brazil 1952    50.9   2108.9444 0.998 51.5
170                    Brazil 1957    53.3   2487.3660 0.998 53.5
171                    Brazil 1962    55.7   3336.5858 0.998 55.4
172                    Brazil 1967    57.6   3429.8644 0.998 57.4
173                    Brazil 1972    59.5   4985.7115 0.998 59.3
174                    Brazil 1977    61.5   6660.1187 0.998 61.3
175                    Brazil 1982    63.3   7030.8359 0.998 63.2
176                    Brazil 1987    65.2   7807.0958 0.998 65.2
177                    Brazil 1992    67.1   6950.2830 0.998 67.1
178                    Brazil 1997    69.4   7957.9808 0.998 69.1
179                    Brazil 2002    71.0   8131.2128 0.998 71.0
180                    Brazil 2007    72.4   9065.8008 0.998 73.0
181                  Bulgaria 1952    59.6   2444.2866 0.547 65.7
182                  Bulgaria 1957    66.6   3008.6707 0.547 66.5
183                  Bulgaria 1962    69.5   4254.3378 0.547 67.2
184                  Bulgaria 1967    70.4   5577.0028 0.547 67.9
185                  Bulgaria 1972    70.9   6597.4944 0.547 68.7
186                  Bulgaria 1977    70.8   7612.2404 0.547 69.4
187                  Bulgaria 1982    71.1   8224.1916 0.547 70.1
188                  Bulgaria 1987    71.3   8239.8548 0.547 70.8
189                  Bulgaria 1992    71.2   6302.6234 0.547 71.6
190                  Bulgaria 1997    70.3   5970.3888 0.547 72.3
191                  Bulgaria 2002    72.1   7696.7777 0.547 73.0
192                  Bulgaria 2007    73.0  10680.7928 0.547 73.8
193              Burkina Faso 1952    32.0    543.2552 0.919 34.7
194              Burkina Faso 1957    34.9    617.1835 0.919 36.5
195              Burkina Faso 1962    37.8    722.5120 0.919 38.3
196              Burkina Faso 1967    40.7    794.8266 0.919 40.1
197              Burkina Faso 1972    43.6    854.7360 0.919 42.0
198              Burkina Faso 1977    46.1    743.3870 0.919 43.8
199              Burkina Faso 1982    48.1    807.1986 0.919 45.6
200              Burkina Faso 1987    49.6    912.0631 0.919 47.4
201              Burkina Faso 1992    50.3    931.7528 0.919 49.2
202              Burkina Faso 1997    50.3    946.2950 0.919 51.1
203              Burkina Faso 2002    50.6   1037.6452 0.919 52.9
204              Burkina Faso 2007    52.3   1217.0330 0.919 54.7
205                   Burundi 1952    39.0    339.2965 0.766 40.6
206                   Burundi 1957    40.5    379.5646 0.766 41.3
207                   Burundi 1962    42.0    355.2032 0.766 42.1
208                   Burundi 1967    43.5    412.9775 0.766 42.9
209                   Burundi 1972    44.1    464.0995 0.766 43.7
210                   Burundi 1977    45.9    556.1033 0.766 44.4
211                   Burundi 1982    47.5    559.6032 0.766 45.2
212                   Burundi 1987    48.2    621.8188 0.766 46.0
213                   Burundi 1992    44.7    631.6999 0.766 46.7
214                   Burundi 1997    45.3    463.1151 0.766 47.5
215                   Burundi 2002    47.4    446.4035 0.766 48.3
216                   Burundi 2007    49.6    430.0707 0.766 49.1
217                  Cambodia 1952    39.4    368.4693 0.639 37.0
218                  Cambodia 1957    41.4    434.0383 0.639 39.0
219                  Cambodia 1962    43.4    496.9136 0.639 41.0
220                  Cambodia 1967    45.4    523.4323 0.639 43.0
221                  Cambodia 1972    40.3    421.6240 0.639 44.9
222                  Cambodia 1977    31.2    524.9722 0.639 46.9
223                  Cambodia 1982    51.0    624.4755 0.639 48.9
224                  Cambodia 1987    53.9    683.8956 0.639 50.9
225                  Cambodia 1992    55.8    682.3032 0.639 52.9
226                  Cambodia 1997    56.5    734.2852 0.639 54.8
227                  Cambodia 2002    56.8    896.2260 0.639 56.8
228                  Cambodia 2007    59.7   1713.7787 0.639 58.8
229                  Cameroon 1952    38.5   1172.6677 0.680 41.2
230                  Cameroon 1957    40.4   1313.0481 0.680 42.5
231                  Cameroon 1962    42.6   1399.6074 0.680 43.8
232                  Cameroon 1967    44.8   1508.4531 0.680 45.0
233                  Cameroon 1972    47.0   1684.1465 0.680 46.3
234                  Cameroon 1977    49.4   1783.4329 0.680 47.5
235                  Cameroon 1982    53.0   2367.9833 0.680 48.8
236                  Cameroon 1987    55.0   2602.6642 0.680 50.0
237                  Cameroon 1992    54.3   1793.1633 0.680 51.3
238                  Cameroon 1997    52.2   1694.3375 0.680 52.5
239                  Cameroon 2002    49.9   1934.0114 0.680 53.8
240                  Cameroon 2007    50.4   2042.0952 0.680 55.0
241                    Canada 1952    68.8  11367.1611 0.996 68.9
242                    Canada 1957    70.0  12489.9501 0.996 70.0
243                    Canada 1962    71.3  13462.4855 0.996 71.1
244                    Canada 1967    72.1  16076.5880 0.996 72.2
245                    Canada 1972    72.9  18970.5709 0.996 73.3
246                    Canada 1977    74.2  22090.8831 0.996 74.4
247                    Canada 1982    75.8  22898.7921 0.996 75.4
248                    Canada 1987    76.9  26626.5150 0.996 76.5
249                    Canada 1992    78.0  26342.8843 0.996 77.6
250                    Canada 1997    78.6  28954.9259 0.996 78.7
251                    Canada 2002    79.8  33328.9651 0.996 79.8
252                    Canada 2007    80.7  36319.2350 0.996 80.9
253  Central African Republic 1952    35.5   1071.3107 0.493 38.8
254  Central African Republic 1957    37.5   1190.8443 0.493 39.7
255  Central African Republic 1962    39.5   1193.0688 0.493 40.6
256  Central African Republic 1967    41.5   1136.0566 0.493 41.6
257  Central African Republic 1972    43.5   1070.0133 0.493 42.5
258  Central African Republic 1977    46.8   1109.3743 0.493 43.4
259  Central African Republic 1982    48.3    956.7530 0.493 44.3
260  Central African Republic 1987    50.5    844.8764 0.493 45.2
261  Central African Republic 1992    49.4    747.9055 0.493 46.2
262  Central African Republic 1997    46.1    740.5063 0.493 47.1
263  Central African Republic 2002    43.3    738.6906 0.493 48.0
264  Central African Republic 2007    44.7    706.0165 0.493 48.9
265                      Chad 1952    38.1   1178.6659 0.872 39.8
266                      Chad 1957    39.9   1308.4956 0.872 41.1
267                      Chad 1962    41.7   1389.8176 0.872 42.3
268                      Chad 1967    43.6   1196.8106 0.872 43.6
269                      Chad 1972    45.6   1104.1040 0.872 44.9
270                      Chad 1977    47.4   1133.9850 0.872 46.1
271                      Chad 1982    49.5    797.9081 0.872 47.4
272                      Chad 1987    51.1    952.3861 0.872 48.7
273                      Chad 1992    51.7   1058.0643 0.872 49.9
274                      Chad 1997    51.6   1004.9614 0.872 51.2
275                      Chad 2002    50.5   1156.1819 0.872 52.5
276                      Chad 2007    50.7   1704.0637 0.872 53.7
277                     Chile 1952    54.7   3939.9788 0.983 54.3
278                     Chile 1957    56.1   4315.6227 0.983 56.7
279                     Chile 1962    57.9   4519.0943 0.983 59.1
280                     Chile 1967    60.5   5106.6543 0.983 61.5
281                     Chile 1972    63.4   5494.0244 0.983 63.9
282                     Chile 1977    67.1   4756.7638 0.983 66.2
283                     Chile 1982    70.6   5095.6657 0.983 68.6
284                     Chile 1987    72.5   5547.0638 0.983 71.0
285                     Chile 1992    74.1   7596.1260 0.983 73.4
286                     Chile 1997    75.8  10118.0532 0.983 75.8
287                     Chile 2002    77.9  10778.7838 0.983 78.2
288                     Chile 2007    78.6  13171.6388 0.983 80.5
289                     China 1952    44.0    400.4486 0.871 47.2
290                     China 1957    50.5    575.9870 0.871 49.8
291                     China 1962    44.5    487.6740 0.871 52.5
292                     China 1967    58.4    612.7057 0.871 55.2
293                     China 1972    63.1    676.9001 0.871 57.8
294                     China 1977    64.0    741.2375 0.871 60.5
295                     China 1982    65.5    962.4214 0.871 63.1
296                     China 1987    67.3   1378.9040 0.871 65.8
297                     China 1992    68.7   1655.7842 0.871 68.4
298                     China 1997    70.4   2289.2341 0.871 71.1
299                     China 2002    72.0   3119.2809 0.871 73.7
300                     China 2007    73.0   4959.1149 0.871 76.4
301                  Colombia 1952    50.6   2144.1151 0.968 53.4
302                  Colombia 1957    55.1   2323.8056 0.968 55.3
303                  Colombia 1962    57.9   2492.3511 0.968 57.2
304                  Colombia 1967    60.0   2678.7298 0.968 59.1
305                  Colombia 1972    61.6   3264.6600 0.968 61.0
306                  Colombia 1977    63.8   3815.8079 0.968 62.9
307                  Colombia 1982    66.7   4397.5757 0.968 64.8
308                  Colombia 1987    67.8   4903.2191 0.968 66.8
309                  Colombia 1992    68.4   5444.6486 0.968 68.7
310                  Colombia 1997    70.3   6117.3617 0.968 70.6
311                  Colombia 2002    71.7   5755.2600 0.968 72.5
312                  Colombia 2007    72.9   7006.5804 0.968 74.4
313                   Comoros 1952    40.7   1102.9909 0.997 40.0
314                   Comoros 1957    42.5   1211.1485 0.997 42.2
315                   Comoros 1962    44.5   1406.6483 0.997 44.5
316                   Comoros 1967    46.5   1876.0296 0.997 46.8
317                   Comoros 1972    48.9   1937.5777 0.997 49.0
318                   Comoros 1977    50.9   1172.6030 0.997 51.3
319                   Comoros 1982    52.9   1267.1001 0.997 53.5
320                   Comoros 1987    54.9   1315.9808 0.997 55.8
321                   Comoros 1992    57.9   1246.9074 0.997 58.0
322                   Comoros 1997    60.7   1173.6182 0.997 60.3
323                   Comoros 2002    63.0   1075.8116 0.997 62.5
324                   Comoros 2007    65.2    986.1479 0.997 64.8
325          Congo, Dem. Rep. 1952    39.1    780.5423 0.348 42.0
326          Congo, Dem. Rep. 1957    40.7    905.8602 0.348 42.4
327          Congo, Dem. Rep. 1962    42.1    896.3146 0.348 42.9
328          Congo, Dem. Rep. 1967    44.1    861.5932 0.348 43.4
329          Congo, Dem. Rep. 1972    46.0    904.8961 0.348 43.8
330          Congo, Dem. Rep. 1977    47.8    795.7573 0.348 44.3
331          Congo, Dem. Rep. 1982    47.8    673.7478 0.348 44.8
332          Congo, Dem. Rep. 1987    47.4    672.7748 0.348 45.2
333          Congo, Dem. Rep. 1992    45.5    457.7192 0.348 45.7
334          Congo, Dem. Rep. 1997    42.6    312.1884 0.348 46.2
335          Congo, Dem. Rep. 2002    45.0    241.1659 0.348 46.7
336          Congo, Dem. Rep. 2007    46.5    277.5519 0.348 47.1
337               Congo, Rep. 1952    42.1   2125.6214 0.520 47.1
338               Congo, Rep. 1957    45.1   2315.0566 0.520 48.1
339               Congo, Rep. 1962    48.4   2464.7832 0.520 49.1
340               Congo, Rep. 1967    52.0   2677.9396 0.520 50.1
341               Congo, Rep. 1972    54.9   3213.1527 0.520 51.0
342               Congo, Rep. 1977    55.6   3259.1790 0.520 52.0
343               Congo, Rep. 1982    56.7   4879.5075 0.520 53.0
344               Congo, Rep. 1987    57.5   4201.1949 0.520 54.0
345               Congo, Rep. 1992    56.4   4016.2395 0.520 54.9
346               Congo, Rep. 1997    53.0   3484.1644 0.520 55.9
347               Congo, Rep. 2002    53.0   3484.0620 0.520 56.9
348               Congo, Rep. 2007    55.3   3632.5578 0.520 57.9
349                Costa Rica 1952    57.2   2627.0095 0.962 59.1
350                Costa Rica 1957    60.0   2990.0108 0.962 61.1
351                Costa Rica 1962    62.8   3460.9370 0.962 63.1
352                Costa Rica 1967    65.4   4161.7278 0.962 65.1
353                Costa Rica 1972    67.8   5118.1469 0.962 67.2
354                Costa Rica 1977    70.8   5926.8770 0.962 69.2
355                Costa Rica 1982    73.4   5262.7348 0.962 71.2
356                Costa Rica 1987    74.8   5629.9153 0.962 73.2
357                Costa Rica 1992    75.7   6160.4163 0.962 75.2
358                Costa Rica 1997    77.3   6677.0453 0.962 77.2
359                Costa Rica 2002    78.1   7723.4472 0.962 79.2
360                Costa Rica 2007    78.8   9645.0614 0.962 81.3
361             Cote d'Ivoire 1952    40.5   1388.5947 0.283 44.8
362             Cote d'Ivoire 1957    42.5   1500.8959 0.283 45.5
363             Cote d'Ivoire 1962    44.9   1728.8694 0.283 46.2
364             Cote d'Ivoire 1967    47.4   2052.0505 0.283 46.8
365             Cote d'Ivoire 1972    49.8   2378.2011 0.283 47.5
366             Cote d'Ivoire 1977    52.4   2517.7365 0.283 48.1
367             Cote d'Ivoire 1982    54.0   2602.7102 0.283 48.8
368             Cote d'Ivoire 1987    54.7   2156.9561 0.283 49.4
369             Cote d'Ivoire 1992    52.0   1648.0738 0.283 50.1
370             Cote d'Ivoire 1997    48.0   1786.2654 0.283 50.7
371             Cote d'Ivoire 2002    46.8   1648.8008 0.283 51.4
372             Cote d'Ivoire 2007    48.3   1544.7501 0.283 52.0
373                   Croatia 1952    61.2   3119.2365 0.932 63.9
374                   Croatia 1957    64.8   4338.2316 0.932 65.0
375                   Croatia 1962    67.1   5477.8900 0.932 66.1
376                   Croatia 1967    68.5   6960.2979 0.932 67.2
377                   Croatia 1972    69.6   9164.0901 0.932 68.4
378                   Croatia 1977    70.6  11305.3852 0.932 69.5
379                   Croatia 1982    70.5  13221.8218 0.932 70.6
380                   Croatia 1987    71.5  13822.5839 0.932 71.7
381                   Croatia 1992    72.5   8447.7949 0.932 72.9
382                   Croatia 1997    73.7   9875.6045 0.932 74.0
383                   Croatia 2002    74.9  11628.3890 0.932 75.1
384                   Croatia 2007    75.7  14619.2227 0.932 76.3
385                      Cuba 1952    59.4   5586.5388 0.924 62.2
386                      Cuba 1957    62.3   6092.1744 0.924 63.8
387                      Cuba 1962    65.2   5180.7559 0.924 65.4
388                      Cuba 1967    68.3   5690.2680 0.924 67.0
389                      Cuba 1972    70.7   5305.4453 0.924 68.6
390                      Cuba 1977    72.6   6380.4950 0.924 70.2
391                      Cuba 1982    73.7   7316.9181 0.924 71.8
392                      Cuba 1987    74.2   7532.9248 0.924 73.5
393                      Cuba 1992    74.4   5592.8440 0.924 75.1
394                      Cuba 1997    76.2   5431.9904 0.924 76.7
395                      Cuba 2002    77.2   6340.6467 0.924 78.3
396                      Cuba 2007    78.3   8948.1029 0.924 79.9
397            Czech Republic 1952    66.9   6876.1403 0.917 67.5
398            Czech Republic 1957    69.0   8256.3439 0.917 68.3
399            Czech Republic 1962    69.9  10136.8671 0.917 69.0
400            Czech Republic 1967    70.4  11399.4449 0.917 69.7
401            Czech Republic 1972    70.3  13108.4536 0.917 70.4
402            Czech Republic 1977    70.7  14800.1606 0.917 71.1
403            Czech Republic 1982    71.0  15377.2285 0.917 71.9
404            Czech Republic 1987    71.6  16310.4434 0.917 72.6
405            Czech Republic 1992    72.4  14297.0212 0.917 73.3
406            Czech Republic 1997    74.0  16048.5142 0.917 74.0
407            Czech Republic 2002    75.5  17596.2102 0.917 74.8
408            Czech Republic 2007    76.5  22833.3085 0.917 75.5
409                   Denmark 1952    70.8   9692.3852 0.971 71.0
410                   Denmark 1957    71.8  11099.6593 0.971 71.6
411                   Denmark 1962    72.3  13583.3135 0.971 72.2
412                   Denmark 1967    73.0  15937.2112 0.971 72.9
413                   Denmark 1972    73.5  18866.2072 0.971 73.5
414                   Denmark 1977    74.7  20422.9015 0.971 74.1
415                   Denmark 1982    74.6  21688.0405 0.971 74.7
416                   Denmark 1987    74.8  25116.1758 0.971 75.3
417                   Denmark 1992    75.3  26406.7399 0.971 75.9
418                   Denmark 1997    76.1  29804.3457 0.971 76.5
419                   Denmark 2002    77.2  32166.5001 0.971 77.1
420                   Denmark 2007    78.3  35278.4187 0.971 77.7
421                  Djibouti 1952    34.8   2669.5295 0.974 36.3
422                  Djibouti 1957    37.3   2864.9691 0.974 38.1
423                  Djibouti 1962    39.7   3020.9893 0.974 40.0
424                  Djibouti 1967    42.1   3020.0505 0.974 41.8
425                  Djibouti 1972    44.4   3694.2124 0.974 43.6
426                  Djibouti 1977    46.5   3081.7610 0.974 45.5
427                  Djibouti 1982    48.8   2879.4681 0.974 47.3
428                  Djibouti 1987    50.0   2880.1026 0.974 49.1
429                  Djibouti 1992    51.6   2377.1562 0.974 51.0
430                  Djibouti 1997    53.2   1895.0170 0.974 52.8
431                  Djibouti 2002    53.4   1908.2609 0.974 54.6
432                  Djibouti 2007    54.8   2082.4816 0.974 56.5
433        Dominican Republic 1952    45.9   1397.7171 0.971 48.6
434        Dominican Republic 1957    49.8   1544.4030 0.971 51.0
435        Dominican Republic 1962    53.5   1662.1374 0.971 53.3
436        Dominican Republic 1967    56.8   1653.7230 0.971 55.7
437        Dominican Republic 1972    59.6   2189.8745 0.971 58.0
438        Dominican Republic 1977    61.8   2681.9889 0.971 60.4
439        Dominican Republic 1982    63.7   2861.0924 0.971 62.7
440        Dominican Republic 1987    66.0   2899.8422 0.971 65.1
441        Dominican Republic 1992    68.5   3044.2142 0.971 67.4
442        Dominican Republic 1997    70.0   3614.1013 0.971 69.8
443        Dominican Republic 2002    70.8   4563.8082 0.971 72.2
444        Dominican Republic 2007    72.2   6025.3748 0.971 74.5
445                   Ecuador 1952    48.4   3522.1107 0.995 49.1
446                   Ecuador 1957    51.4   3780.5467 0.995 51.6
447                   Ecuador 1962    54.6   4086.1141 0.995 54.1
448                   Ecuador 1967    56.7   4579.0742 0.995 56.6
449                   Ecuador 1972    58.8   5280.9947 0.995 59.1
450                   Ecuador 1977    61.3   6679.6233 0.995 61.6
451                   Ecuador 1982    64.3   7213.7913 0.995 64.1
452                   Ecuador 1987    67.2   6481.7770 0.995 66.6
453                   Ecuador 1992    69.6   7103.7026 0.995 69.1
454                   Ecuador 1997    72.3   7429.4559 0.995 71.6
455                   Ecuador 2002    74.2   5773.0445 0.995 74.1
456                   Ecuador 2007    75.0   6873.2623 0.995 76.6
457                     Egypt 1952    41.9   1418.8224 0.990 41.0
458                     Egypt 1957    44.4   1458.9153 0.990 43.7
459                     Egypt 1962    47.0   1693.3359 0.990 46.5
460                     Egypt 1967    49.3   1814.8807 0.990 49.3
461                     Egypt 1972    51.1   2024.0081 0.990 52.1
462                     Egypt 1977    53.3   2785.4936 0.990 54.9
463                     Egypt 1982    56.0   3503.7296 0.990 57.6
464                     Egypt 1987    59.8   3885.4607 0.990 60.4
465                     Egypt 1992    63.7   3794.7552 0.990 63.2
466                     Egypt 1997    67.2   4173.1818 0.990 66.0
467                     Egypt 2002    69.8   4754.6044 0.990 68.7
468                     Egypt 2007    71.3   5581.1810 0.990 71.5
469               El Salvador 1952    45.3   3048.3029 0.956 46.5
470               El Salvador 1957    48.6   3421.5232 0.956 48.9
471               El Salvador 1962    52.3   3776.8036 0.956 51.3
472               El Salvador 1967    55.9   4358.5954 0.956 53.7
473               El Salvador 1972    58.2   4520.2460 0.956 56.1
474               El Salvador 1977    56.7   5138.9224 0.956 58.4
475               El Salvador 1982    56.6   4098.3442 0.956 60.8
476               El Salvador 1987    63.2   4140.4421 0.956 63.2
477               El Salvador 1992    66.8   4444.2317 0.956 65.6
478               El Salvador 1997    69.5   5154.8255 0.956 68.0
479               El Salvador 2002    70.7   5351.5687 0.956 70.4
480               El Salvador 2007    71.9   5728.3535 0.956 72.8
481         Equatorial Guinea 1952    34.5    375.6431 0.997 34.4
482         Equatorial Guinea 1957    36.0    426.0964 0.997 36.0
483         Equatorial Guinea 1962    37.5    582.8420 0.997 37.5
484         Equatorial Guinea 1967    39.0    915.5960 0.997 39.1
485         Equatorial Guinea 1972    40.5    672.4123 0.997 40.6
486         Equatorial Guinea 1977    42.0    958.5668 0.997 42.2
487         Equatorial Guinea 1982    43.7    927.8253 0.997 43.7
488         Equatorial Guinea 1987    45.7    966.8968 0.997 45.3
489         Equatorial Guinea 1992    47.5   1132.0550 0.997 46.8
490         Equatorial Guinea 1997    48.2   2814.4808 0.997 48.4
491         Equatorial Guinea 2002    49.3   7703.4959 0.997 49.9
492         Equatorial Guinea 2007    51.6  12154.0897 0.997 51.5
493                   Eritrea 1952    35.9    328.9406 0.957 35.7
494                   Eritrea 1957    38.0    344.1619 0.957 37.6
495                   Eritrea 1962    40.2    380.9958 0.957 39.4
496                   Eritrea 1967    42.2    468.7950 0.957 41.3
497                   Eritrea 1972    44.1    514.3242 0.957 43.2
498                   Eritrea 1977    44.5    505.7538 0.957 45.1
499                   Eritrea 1982    43.9    524.8758 0.957 46.9
500                   Eritrea 1987    46.5    521.1341 0.957 48.8
501                   Eritrea 1992    50.0    582.8585 0.957 50.7
502                   Eritrea 1997    53.4    913.4708 0.957 52.6
503                   Eritrea 2002    55.2    765.3500 0.957 54.4
504                   Eritrea 2007    58.0    641.3695 0.957 56.3
505                  Ethiopia 1952    34.1    362.1463 0.969 36.0
506                  Ethiopia 1957    36.7    378.9042 0.969 37.6
507                  Ethiopia 1962    40.1    419.4564 0.969 39.1
508                  Ethiopia 1967    42.1    516.1186 0.969 40.6
509                  Ethiopia 1972    43.5    566.2439 0.969 42.2
510                  Ethiopia 1977    44.5    556.8084 0.969 43.7
511                  Ethiopia 1982    44.9    577.8607 0.969 45.2
512                  Ethiopia 1987    46.7    573.7413 0.969 46.8
513                  Ethiopia 1992    48.1    421.3535 0.969 48.3
514                  Ethiopia 1997    49.4    515.8894 0.969 49.9
515                  Ethiopia 2002    50.7    530.0535 0.969 51.4
516                  Ethiopia 2007    52.9    690.8056 0.969 52.9
517                   Finland 1952    66.6   6424.5191 0.994 66.4
518                   Finland 1957    67.5   7545.4154 0.994 67.6
519                   Finland 1962    68.8   9371.8426 0.994 68.8
520                   Finland 1967    69.8  10921.6363 0.994 70.0
521                   Finland 1972    70.9  14358.8759 0.994 71.2
522                   Finland 1977    72.5  15605.4228 0.994 72.4
523                   Finland 1982    74.6  18533.1576 0.994 73.6
524                   Finland 1987    74.8  21141.0122 0.994 74.8
525                   Finland 1992    75.7  20647.1650 0.994 76.0
526                   Finland 1997    77.1  23723.9502 0.994 77.2
527                   Finland 2002    78.4  28204.5906 0.994 78.3
528                   Finland 2007    79.3  33207.0844 0.994 79.5
529                    France 1952    67.4   7029.8093 0.998 67.8
530                    France 1957    68.9   8662.8349 0.998 69.0
531                    France 1962    70.5  10560.4855 0.998 70.2
532                    France 1967    71.6  12999.9177 0.998 71.4
533                    France 1972    72.4  16107.1917 0.998 72.6
534                    France 1977    73.8  18292.6351 0.998 73.8
535                    France 1982    74.9  20293.8975 0.998 74.9
536                    France 1987    76.3  22066.4421 0.998 76.1
537                    France 1992    77.5  24703.7961 0.998 77.3
538                    France 1997    78.6  25889.7849 0.998 78.5
539                    France 2002    79.6  28926.0323 0.998 79.7
540                    France 2007    80.7  30470.0167 0.998 80.9
541                     Gabon 1952    37.0   4293.4765 0.813 38.9
542                     Gabon 1957    39.0   4976.1981 0.813 41.2
543                     Gabon 1962    40.5   6631.4592 0.813 43.4
544                     Gabon 1967    44.6   8358.7620 0.813 45.6
545                     Gabon 1972    48.7  11401.9484 0.813 47.9
546                     Gabon 1977    52.8  21745.5733 0.813 50.1
547                     Gabon 1982    56.6  15113.3619 0.813 52.3
548                     Gabon 1987    60.2  11864.4084 0.813 54.6
549                     Gabon 1992    61.4  13522.1575 0.813 56.8
550                     Gabon 1997    60.5  14722.8419 0.813 59.0
551                     Gabon 2002    56.8  12521.7139 0.813 61.3
552                     Gabon 2007    56.7  13206.4845 0.813 63.5
553                    Gambia 1952    30.0    485.2307 0.989 28.4
554                    Gambia 1957    32.1    520.9267 0.989 31.3
555                    Gambia 1962    33.9    599.6503 0.989 34.2
556                    Gambia 1967    35.9    734.7829 0.989 37.1
557                    Gambia 1972    38.3    756.0868 0.989 40.0
558                    Gambia 1977    41.8    884.7553 0.989 42.9
559                    Gambia 1982    45.6    835.8096 0.989 45.9
560                    Gambia 1987    49.3    611.6589 0.989 48.8
561                    Gambia 1992    52.6    665.6244 0.989 51.7
562                    Gambia 1997    55.9    653.7302 0.989 54.6
563                    Gambia 2002    58.0    660.5856 0.989 57.5
564                    Gambia 2007    59.4    752.7497 0.989 60.4
565                   Germany 1952    67.5   7144.1144 0.990 67.6
566                   Germany 1957    69.1  10187.8267 0.990 68.6
567                   Germany 1962    70.3  12902.4629 0.990 69.7
568                   Germany 1967    70.8  14745.6256 0.990 70.8
569                   Germany 1972    71.0  18016.1803 0.990 71.8
570                   Germany 1977    72.5  20512.9212 0.990 72.9
571                   Germany 1982    73.8  22031.5327 0.990 74.0
572                   Germany 1987    74.8  24639.1857 0.990 75.0
573                   Germany 1992    76.1  26505.3032 0.990 76.1
574                   Germany 1997    77.3  27788.8842 0.990 77.2
575                   Germany 2002    78.7  30035.8020 0.990 78.3
576                   Germany 2007    79.4  32170.3744 0.990 79.3
577                     Ghana 1952    43.1    911.2989 0.984 43.5
578                     Ghana 1957    44.8   1043.5615 0.984 45.1
579                     Ghana 1962    46.5   1190.0411 0.984 46.7
580                     Ghana 1967    48.1   1125.6972 0.984 48.3
581                     Ghana 1972    49.9   1178.2237 0.984 49.9
582                     Ghana 1977    51.8    993.2240 0.984 51.5
583                     Ghana 1982    53.7    876.0326 0.984 53.1
584                     Ghana 1987    55.7    847.0061 0.984 54.8
585                     Ghana 1992    57.5    925.0602 0.984 56.4
586                     Ghana 1997    58.6   1005.2458 0.984 58.0
587                     Ghana 2002    58.5   1111.9846 0.984 59.6
588                     Ghana 2007    60.0   1327.6089 0.984 61.2
589                    Greece 1952    65.9   3530.6901 0.972 67.1
590                    Greece 1957    67.9   4916.2999 0.972 68.3
591                    Greece 1962    69.5   6017.1907 0.972 69.5
592                    Greece 1967    71.0   8513.0970 0.972 70.7
593                    Greece 1972    72.3  12724.8296 0.972 71.9
594                    Greece 1977    73.7  14195.5243 0.972 73.1
595                    Greece 1982    75.2  15268.4209 0.972 74.3
596                    Greece 1987    76.7  16120.5284 0.972 75.6
597                    Greece 1992    77.0  17541.4963 0.972 76.8
598                    Greece 1997    77.9  18747.6981 0.972 78.0
599                    Greece 2002    78.3  22514.2548 0.972 79.2
600                    Greece 2007    79.5  27538.4119 0.972 80.4
601                 Guatemala 1952    42.0   2428.2378 0.997 42.1
602                 Guatemala 1957    44.1   2617.1560 0.997 44.8
603                 Guatemala 1962    47.0   2750.3644 0.997 47.4
604                 Guatemala 1967    50.0   3242.5311 0.997 50.1
605                 Guatemala 1972    53.7   4031.4083 0.997 52.7
606                 Guatemala 1977    56.0   4879.9927 0.997 55.4
607                 Guatemala 1982    58.1   4820.4948 0.997 58.1
608                 Guatemala 1987    60.8   4246.4860 0.997 60.7
609                 Guatemala 1992    63.4   4439.4508 0.997 63.4
610                 Guatemala 1997    66.3   4684.3138 0.997 66.0
611                 Guatemala 2002    69.0   4858.3475 0.997 68.7
612                 Guatemala 2007    70.3   5186.0500 0.997 71.3
613                    Guinea 1952    33.6    510.1965 0.978 31.6
614                    Guinea 1957    34.6    576.2670 0.978 33.7
615                    Guinea 1962    35.8    686.3737 0.978 35.8
616                    Guinea 1967    37.2    708.7595 0.978 37.9
617                    Guinea 1972    38.8    741.6662 0.978 40.1
618                    Guinea 1977    40.8    874.6859 0.978 42.2
619                    Guinea 1982    42.9    857.2504 0.978 44.3
620                    Guinea 1987    45.6    805.5725 0.978 46.4
621                    Guinea 1992    48.6    794.3484 0.978 48.6
622                    Guinea 1997    51.5    869.4498 0.978 50.7
623                    Guinea 2002    53.7    945.5836 0.978 52.8
624                    Guinea 2007    56.0    942.6542 0.978 54.9
625             Guinea-Bissau 1952    32.5    299.8503 0.985 31.7
626             Guinea-Bissau 1957    33.5    431.7905 0.985 33.1
627             Guinea-Bissau 1962    34.5    522.0344 0.985 34.5
628             Guinea-Bissau 1967    35.5    715.5806 0.985 35.8
629             Guinea-Bissau 1972    36.5    820.2246 0.985 37.2
630             Guinea-Bissau 1977    37.5    764.7260 0.985 38.5
631             Guinea-Bissau 1982    39.3    838.1240 0.985 39.9
632             Guinea-Bissau 1987    41.2    736.4154 0.985 41.2
633             Guinea-Bissau 1992    43.3    745.5399 0.985 42.6
634             Guinea-Bissau 1997    44.9    796.6645 0.985 44.0
635             Guinea-Bissau 2002    45.5    575.7047 0.985 45.3
636             Guinea-Bissau 2007    46.4    579.2317 0.985 46.7
637                     Haiti 1952    37.6   1840.3669 0.988 39.2
638                     Haiti 1957    40.7   1726.8879 0.988 41.2
639                     Haiti 1962    43.6   1796.5890 0.988 43.2
640                     Haiti 1967    46.2   1452.0577 0.988 45.2
641                     Haiti 1972    48.0   1654.4569 0.988 47.2
642                     Haiti 1977    49.9   1874.2989 0.988 49.2
643                     Haiti 1982    51.5   2011.1595 0.988 51.2
644                     Haiti 1987    53.6   1823.0160 0.988 53.1
645                     Haiti 1992    55.1   1456.3095 0.988 55.1
646                     Haiti 1997    56.7   1341.7269 0.988 57.1
647                     Haiti 2002    58.1   1270.3649 0.988 59.1
648                     Haiti 2007    60.9   1201.6372 0.988 61.1
649                  Honduras 1952    41.9   2194.9262 0.977 43.0
650                  Honduras 1957    44.7   2220.4877 0.977 45.7
651                  Honduras 1962    48.0   2291.1568 0.977 48.4
652                  Honduras 1967    50.9   2538.2694 0.977 51.1
653                  Honduras 1972    53.9   2529.8423 0.977 53.8
654                  Honduras 1977    57.4   3203.2081 0.977 56.6
655                  Honduras 1982    60.9   3121.7608 0.977 59.3
656                  Honduras 1987    64.5   3023.0967 0.977 62.0
657                  Honduras 1992    66.4   3081.6946 0.977 64.7
658                  Honduras 1997    67.7   3160.4549 0.977 67.4
659                  Honduras 2002    68.6   3099.7287 0.977 70.1
660                  Honduras 2007    70.2   3548.3308 0.977 72.8
661          Hong Kong, China 1952    61.0   3054.4212 0.972 63.4
662          Hong Kong, China 1957    64.8   3629.0765 0.972 65.3
663          Hong Kong, China 1962    67.7   4692.6483 0.972 67.1
664          Hong Kong, China 1967    70.0   6197.9628 0.972 68.9
665          Hong Kong, China 1972    72.0   8315.9281 0.972 70.7
666          Hong Kong, China 1977    73.6  11186.1413 0.972 72.6
667          Hong Kong, China 1982    75.4  14560.5305 0.972 74.4
668          Hong Kong, China 1987    76.2  20038.4727 0.972 76.2
669          Hong Kong, China 1992    77.6  24757.6030 0.972 78.1
670          Hong Kong, China 1997    80.0  28377.6322 0.972 79.9
671          Hong Kong, China 2002    81.5  30209.0152 0.972 81.7
672          Hong Kong, China 2007    82.2  39724.9787 0.972 83.6
673                   Hungary 1952    64.0   5263.6738 0.795 66.0
674                   Hungary 1957    66.4   6040.1800 0.795 66.6
675                   Hungary 1962    68.0   7550.3599 0.795 67.2
676                   Hungary 1967    69.5   9326.6447 0.795 67.8
677                   Hungary 1972    69.8  10168.6561 0.795 68.5
678                   Hungary 1977    70.0  11674.8374 0.795 69.1
679                   Hungary 1982    69.4  12545.9907 0.795 69.7
680                   Hungary 1987    69.6  12986.4800 0.795 70.3
681                   Hungary 1992    69.2  10535.6285 0.795 70.9
682                   Hungary 1997    71.0  11712.7768 0.795 71.6
683                   Hungary 2002    72.6  14843.9356 0.795 72.2
684                   Hungary 2007    73.3  18008.9444 0.795 72.8
685                   Iceland 1952    72.5   7267.6884 0.970 72.0
686                   Iceland 1957    73.5   9244.0014 0.970 72.8
687                   Iceland 1962    73.7  10350.1591 0.970 73.6
688                   Iceland 1967    73.7  13319.8957 0.970 74.4
689                   Iceland 1972    74.5  15798.0636 0.970 75.3
690                   Iceland 1977    76.1  19654.9625 0.970 76.1
691                   Iceland 1982    77.0  23269.6075 0.970 76.9
692                   Iceland 1987    77.2  26923.2063 0.970 77.8
693                   Iceland 1992    78.8  25144.3920 0.970 78.6
694                   Iceland 1997    79.0  28061.0997 0.970 79.4
695                   Iceland 2002    80.5  31163.2020 0.970 80.2
696                   Iceland 2007    81.8  36180.7892 0.970 81.1
697                     India 1952    37.4    546.5657 0.968 39.3
698                     India 1957    40.2    590.0620 0.968 41.8
699                     India 1962    43.6    658.3472 0.968 44.3
700                     India 1967    47.2    700.7706 0.968 46.8
701                     India 1972    50.7    724.0325 0.968 49.4
702                     India 1977    54.2    813.3373 0.968 51.9
703                     India 1982    56.6    855.7235 0.968 54.4
704                     India 1987    58.6    976.5127 0.968 57.0
705                     India 1992    60.2   1164.4068 0.968 59.5
706                     India 1997    61.8   1458.8174 0.968 62.0
707                     India 2002    62.9   1746.7695 0.968 64.5
708                     India 2007    64.7   2452.2104 0.968 67.1
709                 Indonesia 1952    37.5    749.6817 0.997 36.9
710                 Indonesia 1957    39.9    858.9003 0.997 40.1
711                 Indonesia 1962    42.5    849.2898 0.997 43.2
712                 Indonesia 1967    46.0    762.4318 0.997 46.4
713                 Indonesia 1972    49.2   1111.1079 0.997 49.6
714                 Indonesia 1977    52.7   1382.7021 0.997 52.7
715                 Indonesia 1982    56.2   1516.8730 0.997 55.9
716                 Indonesia 1987    60.1   1748.3570 0.997 59.1
717                 Indonesia 1992    62.7   2383.1409 0.997 62.3
718                 Indonesia 1997    66.0   3119.3356 0.997 65.4
719                 Indonesia 2002    68.6   2873.9129 0.997 68.6
720                 Indonesia 2007    70.7   3540.6516 0.997 71.8
721                      Iran 1952    44.9   3035.3260 0.995 45.0
722                      Iran 1957    47.2   3290.2576 0.995 47.5
723                      Iran 1962    49.3   4187.3298 0.995 49.9
724                      Iran 1967    52.5   5906.7318 0.995 52.4
725                      Iran 1972    55.2   9613.8186 0.995 54.9
726                      Iran 1977    57.7  11888.5951 0.995 57.4
727                      Iran 1982    59.6   7608.3346 0.995 59.9
728                      Iran 1987    63.0   6642.8814 0.995 62.4
729                      Iran 1992    65.7   7235.6532 0.995 64.8
730                      Iran 1997    68.0   8263.5903 0.995 67.3
731                      Iran 2002    69.5   9240.7620 0.995 69.8
732                      Iran 2007    71.0  11605.7145 0.995 72.3
733                      Iraq 1952    45.3   4129.7661 0.546 50.1
734                      Iraq 1957    48.4   6229.3336 0.546 51.3
735                      Iraq 1962    51.5   8341.7378 0.546 52.5
736                      Iraq 1967    54.5   8931.4598 0.546 53.6
737                      Iraq 1972    57.0   9576.0376 0.546 54.8
738                      Iraq 1977    60.4  14688.2351 0.546 56.0
739                      Iraq 1982    62.0  14517.9071 0.546 57.2
740                      Iraq 1987    65.0  11643.5727 0.546 58.3
741                      Iraq 1992    59.5   3745.6407 0.546 59.5
742                      Iraq 1997    58.8   3076.2398 0.546 60.7
743                      Iraq 2002    57.0   4390.7173 0.546 61.9
744                      Iraq 2007    59.5   4471.0619 0.546 63.1
745                   Ireland 1952    66.9   5210.2803 0.984 67.5
746                   Ireland 1957    68.9   5599.0779 0.984 68.5
747                   Ireland 1962    70.3   6631.5973 0.984 69.5
748                   Ireland 1967    71.1   7655.5690 0.984 70.5
749                   Ireland 1972    71.3   9530.7729 0.984 71.5
750                   Ireland 1977    72.0  11150.9811 0.984 72.5
751                   Ireland 1982    73.1  12618.3214 0.984 73.5
752                   Ireland 1987    74.4  13872.8665 0.984 74.5
753                   Ireland 1992    75.5  17558.8155 0.984 75.5
754                   Ireland 1997    76.1  24521.9471 0.984 76.5
755                   Ireland 2002    77.8  34077.0494 0.984 77.5
756                   Ireland 2007    78.9  40675.9964 0.984 78.5
757                    Israel 1952    65.4   4086.5221 0.995 66.3
758                    Israel 1957    67.8   5385.2785 0.995 67.6
759                    Israel 1962    69.4   7105.6307 0.995 69.0
760                    Israel 1967    70.8   8393.7414 0.995 70.3
761                    Israel 1972    71.6  12786.9322 0.995 71.6
762                    Israel 1977    73.1  13306.6192 0.995 73.0
763                    Israel 1982    74.4  15367.0292 0.995 74.3
764                    Israel 1987    75.6  17122.4799 0.995 75.6
765                    Israel 1992    76.9  18051.5225 0.995 77.0
766                    Israel 1997    78.3  20896.6092 0.995 78.3
767                    Israel 2002    79.7  21905.5951 0.995 79.7
768                    Israel 2007    80.7  25523.2771 0.995 81.0
769                     Italy 1952    65.9   4931.4042 0.993 66.6
770                     Italy 1957    67.8   6248.6562 0.993 67.9
771                     Italy 1962    69.2   8243.5823 0.993 69.3
772                     Italy 1967    71.1  10022.4013 0.993 70.6
773                     Italy 1972    72.2  12269.2738 0.993 72.0
774                     Italy 1977    73.5  14255.9847 0.993 73.3
775                     Italy 1982    75.0  16537.4835 0.993 74.7
776                     Italy 1987    76.4  19207.2348 0.993 76.0
777                     Italy 1992    77.4  22013.6449 0.993 77.4
778                     Italy 1997    78.8  24675.0245 0.993 78.7
779                     Italy 2002    80.2  27968.0982 0.993 80.1
780                     Italy 2007    80.5  28569.7197 0.993 81.4
781                   Jamaica 1952    58.5   2898.5309 0.806 62.7
782                   Jamaica 1957    62.6   4756.5258 0.806 63.8
783                   Jamaica 1962    65.6   5246.1075 0.806 64.9
784                   Jamaica 1967    67.5   6124.7035 0.806 66.0
785                   Jamaica 1972    69.0   7433.8893 0.806 67.1
786                   Jamaica 1977    70.1   6650.1956 0.806 68.2
787                   Jamaica 1982    71.2   6068.0513 0.806 69.3
788                   Jamaica 1987    71.8   6351.2375 0.806 70.4
789                   Jamaica 1992    71.8   7404.9237 0.806 71.5
790                   Jamaica 1997    72.3   7121.9247 0.806 72.6
791                   Jamaica 2002    72.0   6994.7749 0.806 73.7
792                   Jamaica 2007    72.6   7320.8803 0.806 74.8
793                     Japan 1952    63.0   3216.9563 0.960 65.1
794                     Japan 1957    65.5   4317.6944 0.960 66.9
795                     Japan 1962    68.7   6576.6495 0.960 68.7
796                     Japan 1967    71.4   9847.7886 0.960 70.4
797                     Japan 1972    73.4  14778.7864 0.960 72.2
798                     Japan 1977    75.4  16610.3770 0.960 73.9
799                     Japan 1982    77.1  19384.1057 0.960 75.7
800                     Japan 1987    78.7  22375.9419 0.960 77.5
801                     Japan 1992    79.4  26824.8951 0.960 79.2
802                     Japan 1997    80.7  28816.5850 0.960 81.0
803                     Japan 2002    82.0  28604.5919 0.960 82.8
804                     Japan 2007    82.6  31656.0681 0.960 84.5
805                    Jordan 1952    43.2   1546.9078 0.970 44.1
806                    Jordan 1957    45.7   1886.0806 0.970 46.9
807                    Jordan 1962    48.1   2348.0092 0.970 49.8
808                    Jordan 1967    51.6   2741.7963 0.970 52.6
809                    Jordan 1972    56.5   2110.8563 0.970 55.5
810                    Jordan 1977    61.1   2852.3516 0.970 58.4
811                    Jordan 1982    63.7   4161.4160 0.970 61.2
812                    Jordan 1987    65.9   4448.6799 0.970 64.1
813                    Jordan 1992    68.0   3431.5936 0.970 66.9
814                    Jordan 1997    69.8   3645.3796 0.970 69.8
815                    Jordan 2002    71.3   3844.9172 0.970 72.7
816                    Jordan 2007    72.5   4519.4612 0.970 75.5
817                     Kenya 1952    42.3    853.5409 0.443 47.0
818                     Kenya 1957    44.7    944.4383 0.443 48.0
819                     Kenya 1962    47.9    896.9664 0.443 49.1
820                     Kenya 1967    50.7   1056.7365 0.443 50.1
821                     Kenya 1972    53.6   1222.3600 0.443 51.1
822                     Kenya 1977    56.2   1267.6132 0.443 52.2
823                     Kenya 1982    58.8   1348.2258 0.443 53.2
824                     Kenya 1987    59.3   1361.9369 0.443 54.2
825                     Kenya 1992    59.3   1341.9217 0.443 55.3
826                     Kenya 1997    54.4   1360.4850 0.443 56.3
827                     Kenya 2002    51.0   1287.5147 0.443 57.3
828                     Kenya 2007    54.1   1463.2493 0.443 58.4
829          Korea, Dem. Rep. 1952    50.1   1088.2778 0.703 54.9
830          Korea, Dem. Rep. 1957    54.1   1571.1347 0.703 56.5
831          Korea, Dem. Rep. 1962    56.7   1621.6936 0.703 58.1
832          Korea, Dem. Rep. 1967    59.9   2143.5406 0.703 59.7
833          Korea, Dem. Rep. 1972    64.0   3701.6215 0.703 61.2
834          Korea, Dem. Rep. 1977    67.2   4106.3012 0.703 62.8
835          Korea, Dem. Rep. 1982    69.1   4106.5253 0.703 64.4
836          Korea, Dem. Rep. 1987    70.6   4106.4923 0.703 66.0
837          Korea, Dem. Rep. 1992    70.0   3726.0635 0.703 67.6
838          Korea, Dem. Rep. 1997    67.7   1690.7568 0.703 69.1
839          Korea, Dem. Rep. 2002    66.7   1646.7582 0.703 70.7
840          Korea, Dem. Rep. 2007    67.3   1593.0655 0.703 72.3
841               Korea, Rep. 1952    47.5   1030.5922 0.988 49.7
842               Korea, Rep. 1957    52.7   1487.5935 0.988 52.5
843               Korea, Rep. 1962    55.3   1536.3444 0.988 55.3
844               Korea, Rep. 1967    57.7   2029.2281 0.988 58.1
845               Korea, Rep. 1972    62.6   3030.8767 0.988 60.8
846               Korea, Rep. 1977    64.8   4657.2210 0.988 63.6
847               Korea, Rep. 1982    67.1   5622.9425 0.988 66.4
848               Korea, Rep. 1987    69.8   8533.0888 0.988 69.2
849               Korea, Rep. 1992    72.2  12104.2787 0.988 71.9
850               Korea, Rep. 1997    74.6  15993.5280 0.988 74.7
851               Korea, Rep. 2002    77.0  19233.9882 0.988 77.5
852               Korea, Rep. 2007    78.6  23348.1397 0.988 80.3
853                    Kuwait 1952    55.6 108382.3529 0.952 57.5
854                    Kuwait 1957    58.0 113523.1329 0.952 59.5
855                    Kuwait 1962    60.5  95458.1118 0.952 61.6
856                    Kuwait 1967    64.6  80894.8833 0.952 63.7
857                    Kuwait 1972    67.7 109347.8670 0.952 65.8
858                    Kuwait 1977    69.3  59265.4771 0.952 67.9
859                    Kuwait 1982    71.3  31354.0357 0.952 70.0
860                    Kuwait 1987    74.2  28118.4300 0.952 72.0
861                    Kuwait 1992    75.2  34932.9196 0.952 74.1
862                    Kuwait 1997    76.2  40300.6200 0.952 76.2
863                    Kuwait 2002    76.9  35110.1057 0.952 78.3
864                    Kuwait 2007    77.6  47306.9898 0.952 80.4
865                   Lebanon 1952    55.9   4834.8041 0.942 58.7
866                   Lebanon 1957    59.5   6089.7869 0.942 60.0
867                   Lebanon 1962    62.1   5714.5606 0.942 61.3
868                   Lebanon 1967    63.9   6006.9830 0.942 62.6
869                   Lebanon 1972    65.4   7486.3843 0.942 63.9
870                   Lebanon 1977    66.1   8659.6968 0.942 65.2
871                   Lebanon 1982    67.0   7640.5195 0.942 66.5
872                   Lebanon 1987    67.9   5377.0913 0.942 67.8
873                   Lebanon 1992    69.3   6890.8069 0.942 69.1
874                   Lebanon 1997    70.3   8754.9639 0.942 70.4
875                   Lebanon 2002    71.0   9313.9388 0.942 71.7
876                   Lebanon 2007    72.0  10461.0587 0.942 73.0
877                   Lesotho 1952    42.1    298.8462 0.085 47.4
878                   Lesotho 1957    45.0    335.9971 0.085 47.9
879                   Lesotho 1962    47.7    411.8006 0.085 48.3
880                   Lesotho 1967    48.5    498.6390 0.085 48.8
881                   Lesotho 1972    49.8    496.5816 0.085 49.3
882                   Lesotho 1977    52.2    745.3695 0.085 49.8
883                   Lesotho 1982    55.1    797.2631 0.085 50.2
884                   Lesotho 1987    57.2    773.9932 0.085 50.7
885                   Lesotho 1992    59.7    977.4863 0.085 51.2
886                   Lesotho 1997    55.6   1186.1480 0.085 51.7
887                   Lesotho 2002    44.6   1275.1846 0.085 52.2
888                   Lesotho 2007    42.6   1569.3314 0.085 52.6
889                   Liberia 1952    38.5    575.5730 0.512 39.8
890                   Liberia 1957    39.5    620.9700 0.512 40.3
891                   Liberia 1962    40.5    634.1952 0.512 40.8
892                   Liberia 1967    41.5    713.6036 0.512 41.3
893                   Liberia 1972    42.6    803.0055 0.512 41.8
894                   Liberia 1977    43.8    640.3224 0.512 42.2
895                   Liberia 1982    44.9    572.1996 0.512 42.7
896                   Liberia 1987    46.0    506.1139 0.512 43.2
897                   Liberia 1992    40.8    636.6229 0.512 43.7
898                   Liberia 1997    42.2    609.1740 0.512 44.2
899                   Liberia 2002    43.8    531.4824 0.512 44.6
900                   Liberia 2007    45.7    414.5073 0.512 45.1
901                     Libya 1952    42.7   2387.5481 0.983 42.1
902                     Libya 1957    45.3   3448.2844 0.983 45.2
903                     Libya 1962    47.8   6757.0308 0.983 48.4
904                     Libya 1967    50.2  18772.7517 0.983 51.5
905                     Libya 1972    52.8  21011.4972 0.983 54.6
906                     Libya 1977    57.4  21951.2118 0.983 57.7
907                     Libya 1982    62.2  17364.2754 0.983 60.9
908                     Libya 1987    66.2  11770.5898 0.983 64.0
909                     Libya 1992    68.8   9640.1385 0.983 67.1
910                     Libya 1997    71.6   9467.4461 0.983 70.3
911                     Libya 2002    72.7   9534.6775 0.983 73.4
912                     Libya 2007    74.0  12057.4993 0.983 76.5
913                Madagascar 1952    36.7   1443.0117 0.995 36.7
914                Madagascar 1957    38.9   1589.2027 0.995 38.7
915                Madagascar 1962    40.8   1643.3871 0.995 40.7
916                Madagascar 1967    42.9   1634.0473 0.995 42.7
917                Madagascar 1972    44.9   1748.5630 0.995 44.7
918                Madagascar 1977    46.9   1544.2286 0.995 46.8
919                Madagascar 1982    49.0   1302.8787 0.995 48.8
920                Madagascar 1987    49.4   1155.4419 0.995 50.8
921                Madagascar 1992    52.2   1040.6762 0.995 52.8
922                Madagascar 1997    55.0    986.2959 0.995 54.8
923                Madagascar 2002    57.3    894.6371 0.995 56.9
924                Madagascar 2007    59.4   1044.7701 0.995 58.9
925                    Malawi 1952    36.3    369.1651 0.840 36.9
926                    Malawi 1957    37.2    416.3698 0.840 38.1
927                    Malawi 1962    38.4    427.9011 0.840 39.3
928                    Malawi 1967    39.5    495.5148 0.840 40.4
929                    Malawi 1972    41.8    584.6220 0.840 41.6
930                    Malawi 1977    43.8    663.2237 0.840 42.8
931                    Malawi 1982    45.6    632.8039 0.840 43.9
932                    Malawi 1987    47.5    635.5174 0.840 45.1
933                    Malawi 1992    49.4    563.2000 0.840 46.3
934                    Malawi 1997    47.5    692.2758 0.840 47.5
935                    Malawi 2002    45.0    665.4231 0.840 48.6
936                    Malawi 2007    48.3    759.3499 0.840 49.8
937                  Malaysia 1952    48.5   1831.1329 0.947 51.5
938                  Malaysia 1957    52.1   1810.0670 0.947 53.8
939                  Malaysia 1962    55.7   2036.8849 0.947 56.2
940                  Malaysia 1967    59.4   2277.7424 0.947 58.5
941                  Malaysia 1972    63.0   2849.0948 0.947 60.8
942                  Malaysia 1977    65.3   3827.9216 0.947 63.1
943                  Malaysia 1982    68.0   4920.3560 0.947 65.4
944                  Malaysia 1987    69.5   5249.8027 0.947 67.8
945                  Malaysia 1992    70.7   7277.9128 0.947 70.1
946                  Malaysia 1997    71.9  10132.9096 0.947 72.4
947                  Malaysia 2002    73.0  10206.9779 0.947 74.7
948                  Malaysia 2007    74.2  12451.6558 0.947 77.1
949                      Mali 1952    33.7    452.3370 0.995 33.1
950                      Mali 1957    35.3    490.3822 0.995 34.9
951                      Mali 1962    36.9    496.1743 0.995 36.8
952                      Mali 1967    38.5    545.0099 0.995 38.7
953                      Mali 1972    40.0    581.3689 0.995 40.6
954                      Mali 1977    41.7    686.3953 0.995 42.5
955                      Mali 1982    43.9    618.0141 0.995 44.4
956                      Mali 1987    46.4    684.1716 0.995 46.2
957                      Mali 1992    48.4    739.0144 0.995 48.1
958                      Mali 1997    49.9    790.2580 0.995 50.0
959                      Mali 2002    51.8    951.4098 0.995 51.9
960                      Mali 2007    54.5   1042.5816 0.995 53.8
961                Mauritania 1952    40.5    743.1159 0.998 40.0
962                Mauritania 1957    42.3    846.1203 0.998 42.3
963                Mauritania 1962    44.2   1055.8960 0.998 44.5
964                Mauritania 1967    46.3   1421.1452 0.998 46.7
965                Mauritania 1972    48.4   1586.8518 0.998 49.0
966                Mauritania 1977    50.9   1497.4922 0.998 51.2
967                Mauritania 1982    53.6   1481.1502 0.998 53.4
968                Mauritania 1987    56.1   1421.6036 0.998 55.7
969                Mauritania 1992    58.3   1361.3698 0.998 57.9
970                Mauritania 1997    60.4   1483.1361 0.998 60.1
971                Mauritania 2002    62.2   1579.0195 0.998 62.3
972                Mauritania 2007    64.2   1803.1515 0.998 64.6
973                 Mauritius 1952    51.0   1967.9557 0.935 55.4
974                 Mauritius 1957    58.1   2034.0380 0.935 57.1
975                 Mauritius 1962    60.2   2529.0675 0.935 58.9
976                 Mauritius 1967    61.6   2475.3876 0.935 60.6
977                 Mauritius 1972    62.9   2575.4842 0.935 62.3
978                 Mauritius 1977    64.9   3710.9830 0.935 64.1
979                 Mauritius 1982    66.7   3688.0377 0.935 65.8
980                 Mauritius 1987    68.7   4783.5869 0.935 67.6
981                 Mauritius 1992    69.7   6058.2538 0.935 69.3
982                 Mauritius 1997    70.7   7425.7053 0.935 71.1
983                 Mauritius 2002    72.0   9021.8159 0.935 72.8
984                 Mauritius 2007    72.8  10956.9911 0.935 74.5
985                    Mexico 1952    50.8   3478.1255 0.985 53.0
986                    Mexico 1957    55.2   4131.5466 0.985 55.3
987                    Mexico 1962    58.3   4581.6094 0.985 57.5
988                    Mexico 1967    60.1   5754.7339 0.985 59.8
989                    Mexico 1972    62.4   6809.4067 0.985 62.0
990                    Mexico 1977    65.0   7674.9291 0.985 64.3
991                    Mexico 1982    67.4   9611.1475 0.985 66.5
992                    Mexico 1987    69.5   8688.1560 0.985 68.8
993                    Mexico 1992    71.5   9472.3843 0.985 71.0
994                    Mexico 1997    73.7   9767.2975 0.985 73.3
995                    Mexico 2002    74.9  10742.4405 0.985 75.6
996                    Mexico 2007    76.2  11977.5750 0.985 77.8
997                  Mongolia 1952    42.2    786.5669 0.987 43.8
998                  Mongolia 1957    45.2    912.6626 0.987 46.0
999                  Mongolia 1962    48.3   1056.3540 0.987 48.2
1000                 Mongolia 1967    51.3   1226.0411 0.987 50.4
1001                 Mongolia 1972    53.8   1421.7420 0.987 52.6
1002                 Mongolia 1977    55.5   1647.5117 0.987 54.8
1003                 Mongolia 1982    57.5   2000.6031 0.987 57.0
1004                 Mongolia 1987    60.2   2338.0083 0.987 59.2
1005                 Mongolia 1992    61.3   1785.4020 0.987 61.4
1006                 Mongolia 1997    63.6   1902.2521 0.987 63.6
1007                 Mongolia 2002    65.0   2140.7393 0.987 65.8
1008                 Mongolia 2007    66.8   3095.7723 0.987 68.0
1009               Montenegro 1952    59.2   2647.5856 0.802 62.2
1010               Montenegro 1957    61.4   3682.2599 0.802 63.7
1011               Montenegro 1962    63.7   4649.5938 0.802 65.2
1012               Montenegro 1967    67.2   5907.8509 0.802 66.6
1013               Montenegro 1972    70.6   7778.4140 0.802 68.1
1014               Montenegro 1977    73.1   9595.9299 0.802 69.6
1015               Montenegro 1982    74.1  11222.5876 0.802 71.0
1016               Montenegro 1987    74.9  11732.5102 0.802 72.5
1017               Montenegro 1992    75.4   7003.3390 0.802 74.0
1018               Montenegro 1997    75.4   6465.6133 0.802 75.4
1019               Montenegro 2002    74.0   6557.1943 0.802 76.9
1020               Montenegro 2007    74.5   9253.8961 0.802 78.4
1021                  Morocco 1952    42.9   1688.2036 0.995 42.7
1022                  Morocco 1957    45.4   1642.0023 0.995 45.4
1023                  Morocco 1962    47.9   1566.3535 0.995 48.1
1024                  Morocco 1967    50.3   1711.0448 0.995 50.8
1025                  Morocco 1972    52.9   1930.1950 0.995 53.5
1026                  Morocco 1977    55.7   2370.6200 0.995 56.3
1027                  Morocco 1982    59.6   2702.6204 0.995 59.0
1028                  Morocco 1987    62.7   2755.0470 0.995 61.7
1029                  Morocco 1992    65.4   2948.0473 0.995 64.4
1030                  Morocco 1997    67.7   2982.1019 0.995 67.1
1031                  Morocco 2002    69.6   3258.4956 0.995 69.8
1032                  Morocco 2007    71.2   3820.1752 0.995 72.5
1033               Mozambique 1952    31.3    468.5260 0.774 34.2
1034               Mozambique 1957    33.8    495.5868 0.774 35.3
1035               Mozambique 1962    36.2    556.6864 0.774 36.5
1036               Mozambique 1967    38.1    566.6692 0.774 37.6
1037               Mozambique 1972    40.3    724.9178 0.774 38.7
1038               Mozambique 1977    42.5    502.3197 0.774 39.8
1039               Mozambique 1982    42.8    462.2114 0.774 40.9
1040               Mozambique 1987    42.9    389.8762 0.774 42.1
1041               Mozambique 1992    44.3    410.8968 0.774 43.2
1042               Mozambique 1997    46.3    472.3461 0.774 44.3
1043               Mozambique 2002    44.0    633.6179 0.774 45.4
1044               Mozambique 2007    42.1    823.6856 0.774 46.6
1045                  Myanmar 1952    36.3    331.0000 0.879 41.4
1046                  Myanmar 1957    41.9    350.0000 0.879 43.6
1047                  Myanmar 1962    45.1    388.0000 0.879 45.7
1048                  Myanmar 1967    49.4    349.0000 0.879 47.9
1049                  Myanmar 1972    53.1    357.0000 0.879 50.1
1050                  Myanmar 1977    56.1    371.0000 0.879 52.2
1051                  Myanmar 1982    58.1    424.0000 0.879 54.4
1052                  Myanmar 1987    58.3    385.0000 0.879 56.6
1053                  Myanmar 1992    59.3    347.0000 0.879 58.7
1054                  Myanmar 1997    60.3    415.0000 0.879 60.9
1055                  Myanmar 2002    59.9    611.0000 0.879 63.1
1056                  Myanmar 2007    62.1    944.0000 0.879 65.2
1057                  Namibia 1952    41.7   2423.7804 0.437 47.1
1058                  Namibia 1957    45.2   2621.4481 0.437 48.3
1059                  Namibia 1962    48.4   3173.2156 0.437 49.4
1060                  Namibia 1967    51.2   3793.6948 0.437 50.6
1061                  Namibia 1972    53.9   3746.0809 0.437 51.8
1062                  Namibia 1977    56.4   3876.4860 0.437 52.9
1063                  Namibia 1982    59.0   4191.1005 0.437 54.1
1064                  Namibia 1987    60.8   3693.7313 0.437 55.2
1065                  Namibia 1992    62.0   3804.5380 0.437 56.4
1066                  Namibia 1997    58.9   3899.5243 0.437 57.5
1067                  Namibia 2002    51.5   4072.3248 0.437 58.7
1068                  Namibia 2007    52.9   4811.0604 0.437 59.8
1069                    Nepal 1952    36.2    545.8657 0.992 34.4
1070                    Nepal 1957    37.7    597.9364 0.992 37.1
1071                    Nepal 1962    39.4    652.3969 0.992 39.7
1072                    Nepal 1967    41.5    676.4422 0.992 42.4
1073                    Nepal 1972    44.0    674.7881 0.992 45.0
1074                    Nepal 1977    46.7    694.1124 0.992 47.7
1075                    Nepal 1982    49.6    718.3731 0.992 50.3
1076                    Nepal 1987    52.5    775.6325 0.992 53.0
1077                    Nepal 1992    55.7    897.7404 0.992 55.6
1078                    Nepal 1997    59.4   1010.8921 0.992 58.2
1079                    Nepal 2002    61.3   1057.2063 0.992 60.9
1080                    Nepal 2007    63.8   1091.3598 0.992 63.5
1081              Netherlands 1952    72.1   8941.5719 0.982 71.9
1082              Netherlands 1957    73.0  11276.1934 0.982 72.6
1083              Netherlands 1962    73.2  12790.8496 0.982 73.3
1084              Netherlands 1967    73.8  15363.2514 0.982 73.9
1085              Netherlands 1972    73.8  18794.7457 0.982 74.6
1086              Netherlands 1977    75.2  21209.0592 0.982 75.3
1087              Netherlands 1982    76.0  21399.4605 0.982 76.0
1088              Netherlands 1987    76.8  23651.3236 0.982 76.7
1089              Netherlands 1992    77.4  26790.9496 0.982 77.4
1090              Netherlands 1997    78.0  30246.1306 0.982 78.0
1091              Netherlands 2002    78.5  33724.7578 0.982 78.7
1092              Netherlands 2007    79.8  36797.9333 0.982 79.4
1093              New Zealand 1952    69.4  10556.5757 0.954 68.7
1094              New Zealand 1957    70.3  12247.3953 0.954 69.7
1095              New Zealand 1962    71.2  13175.6780 0.954 70.6
1096              New Zealand 1967    71.5  14463.9189 0.954 71.6
1097              New Zealand 1972    71.9  16046.0373 0.954 72.5
1098              New Zealand 1977    72.2  16233.7177 0.954 73.5
1099              New Zealand 1982    73.8  17632.4104 0.954 74.5
1100              New Zealand 1987    74.3  19007.1913 0.954 75.4
1101              New Zealand 1992    76.3  18363.3249 0.954 76.4
1102              New Zealand 1997    77.6  21050.4138 0.954 77.4
1103              New Zealand 2002    79.1  23189.8014 0.954 78.3
1104              New Zealand 2007    80.2  25185.0091 0.954 79.3
1105                Nicaragua 1952    42.3   3112.3639 0.997 43.0
1106                Nicaragua 1957    45.4   3457.4159 0.997 45.8
1107                Nicaragua 1962    48.6   3634.3644 0.997 48.6
1108                Nicaragua 1967    51.9   4643.3935 0.997 51.4
1109                Nicaragua 1972    55.2   4688.5933 0.997 54.2
1110                Nicaragua 1977    57.5   5486.3711 0.997 57.0
1111                Nicaragua 1982    59.3   3470.3382 0.997 59.7
1112                Nicaragua 1987    62.0   2955.9844 0.997 62.5
1113                Nicaragua 1992    65.8   2170.1517 0.997 65.3
1114                Nicaragua 1997    68.4   2253.0230 0.997 68.1
1115                Nicaragua 2002    70.8   2474.5488 0.997 70.9
1116                Nicaragua 2007    72.9   2749.3210 0.997 73.7
1117                    Niger 1952    37.4    761.8794 0.898 35.2
1118                    Niger 1957    38.6    835.5234 0.898 36.9
1119                    Niger 1962    39.5    997.7661 0.898 38.6
1120                    Niger 1967    40.1   1054.3849 0.898 40.3
1121                    Niger 1972    40.5    954.2092 0.898 42.0
1122                    Niger 1977    41.3    808.8971 0.898 43.7
1123                    Niger 1982    42.6    909.7221 0.898 45.4
1124                    Niger 1987    44.6    668.3000 0.898 47.1
1125                    Niger 1992    47.4    581.1827 0.898 48.8
1126                    Niger 1997    51.3    580.3052 0.898 50.5
1127                    Niger 2002    54.5    601.0745 0.898 52.3
1128                    Niger 2007    56.9    619.6769 0.898 54.0
1129                  Nigeria 1952    36.3   1077.2819 0.870 37.9
1130                  Nigeria 1957    37.8   1100.5926 0.870 38.9
1131                  Nigeria 1962    39.4   1150.9275 0.870 39.9
1132                  Nigeria 1967    41.0   1014.5141 0.870 41.0
1133                  Nigeria 1972    42.8   1698.3888 0.870 42.0
1134                  Nigeria 1977    44.5   1981.9518 0.870 43.1
1135                  Nigeria 1982    45.8   1576.9738 0.870 44.1
1136                  Nigeria 1987    46.9   1385.0296 0.870 45.1
1137                  Nigeria 1992    47.5   1619.8482 0.870 46.2
1138                  Nigeria 1997    47.5   1624.9413 0.870 47.2
1139                  Nigeria 2002    46.6   1615.2864 0.870 48.3
1140                  Nigeria 2007    46.9   2013.9773 0.870 49.3
1141                   Norway 1952    72.7  10095.4217 0.963 72.2
1142                   Norway 1957    73.4  11653.9730 0.963 72.9
1143                   Norway 1962    73.5  13450.4015 0.963 73.5
1144                   Norway 1967    74.1  16361.8765 0.963 74.2
1145                   Norway 1972    74.3  18965.0555 0.963 74.9
1146                   Norway 1977    75.4  23311.3494 0.963 75.5
1147                   Norway 1982    76.0  26298.6353 0.963 76.2
1148                   Norway 1987    75.9  31540.9748 0.963 76.8
1149                   Norway 1992    77.3  33965.6611 0.963 77.5
1150                   Norway 1997    78.3  41283.1643 0.963 78.2
1151                   Norway 2002    79.0  44683.9753 0.963 78.8
1152                   Norway 2007    80.2  49357.1902 0.963 79.5
1153                     Oman 1952    37.6   1828.2303 0.975 37.2
1154                     Oman 1957    40.1   2242.7466 0.975 41.1
1155                     Oman 1962    43.2   2924.6381 0.975 44.9
1156                     Oman 1967    47.0   4720.9427 0.975 48.8
1157                     Oman 1972    52.1  10618.0385 0.975 52.7
1158                     Oman 1977    57.4  11848.3439 0.975 56.5
1159                     Oman 1982    62.7  12954.7910 0.975 60.4
1160                     Oman 1987    67.7  18115.2231 0.975 64.2
1161                     Oman 1992    71.2  18616.7069 0.975 68.1
1162                     Oman 1997    72.5  19702.0558 0.975 72.0
1163                     Oman 2002    74.2  19774.8369 0.975 75.8
1164                     Oman 2007    75.6  22316.1929 0.975 79.7
1165                 Pakistan 1952    43.4    684.5971 0.997 43.7
1166                 Pakistan 1957    45.6    747.0835 0.997 45.8
1167                 Pakistan 1962    47.7    803.3427 0.997 47.8
1168                 Pakistan 1967    49.8    942.4083 0.997 49.8
1169                 Pakistan 1972    51.9   1049.9390 0.997 51.8
1170                 Pakistan 1977    54.0   1175.9212 0.997 53.9
1171                 Pakistan 1982    56.2   1443.4298 0.997 55.9
1172                 Pakistan 1987    58.2   1704.6866 0.997 57.9
1173                 Pakistan 1992    60.8   1971.8295 0.997 60.0
1174                 Pakistan 1997    61.8   2049.3505 0.997 62.0
1175                 Pakistan 2002    63.6   2092.7124 0.997 64.0
1176                 Pakistan 2007    65.5   2605.9476 0.997 66.0
1177                   Panama 1952    55.2   2480.3803 0.951 58.1
1178                   Panama 1957    59.2   2961.8009 0.951 59.8
1179                   Panama 1962    61.8   3536.5403 0.951 61.6
1180                   Panama 1967    64.1   4421.0091 0.951 63.4
1181                   Panama 1972    66.2   5364.2497 0.951 65.1
1182                   Panama 1977    68.7   5351.9121 0.951 66.9
1183                   Panama 1982    70.5   7009.6016 0.951 68.7
1184                   Panama 1987    71.5   7034.7792 0.951 70.5
1185                   Panama 1992    72.5   6618.7431 0.951 72.2
1186                   Panama 1997    73.7   7113.6923 0.951 74.0
1187                   Panama 2002    74.7   7356.0319 0.951 75.8
1188                   Panama 2007    75.5   9809.1856 0.951 77.5
1189                 Paraguay 1952    62.6   1952.3087 0.983 62.5
1190                 Paraguay 1957    63.2   2046.1547 0.983 63.3
1191                 Paraguay 1962    64.4   2148.0271 0.983 64.1
1192                 Paraguay 1967    65.0   2299.3763 0.983 64.8
1193                 Paraguay 1972    65.8   2523.3380 0.983 65.6
1194                 Paraguay 1977    66.4   3248.3733 0.983 66.4
1195                 Paraguay 1982    66.9   4258.5036 0.983 67.2
1196                 Paraguay 1987    67.4   3998.8757 0.983 68.0
1197                 Paraguay 1992    68.2   4196.4111 0.983 68.8
1198                 Paraguay 1997    69.4   4247.4003 0.983 69.6
1199                 Paraguay 2002    70.8   3783.6742 0.983 70.3
1200                 Paraguay 2007    71.8   4172.8385 0.983 71.1
1201                     Peru 1952    43.9   3758.5234 0.988 44.3
1202                     Peru 1957    46.3   4245.2567 0.988 47.0
1203                     Peru 1962    49.1   4957.0380 0.988 49.6
1204                     Peru 1967    51.4   5788.0933 0.988 52.3
1205                     Peru 1972    55.4   5937.8273 0.988 54.9
1206                     Peru 1977    58.4   6281.2909 0.988 57.5
1207                     Peru 1982    61.4   6434.5018 0.988 60.2
1208                     Peru 1987    64.1   6360.9434 0.988 62.8
1209                     Peru 1992    66.5   4446.3809 0.988 65.5
1210                     Peru 1997    68.4   5838.3477 0.988 68.1
1211                     Peru 2002    69.9   5909.0201 0.988 70.7
1212                     Peru 2007    71.4   7408.9056 0.988 73.4
1213              Philippines 1952    47.8   1272.8810 0.991 49.4
1214              Philippines 1957    51.3   1547.9448 0.991 51.5
1215              Philippines 1962    54.8   1649.5522 0.991 53.6
1216              Philippines 1967    56.4   1814.1274 0.991 55.7
1217              Philippines 1972    58.1   1989.3741 0.991 57.8
1218              Philippines 1977    60.1   2373.2043 0.991 59.9
1219              Philippines 1982    62.1   2603.2738 0.991 62.0
1220              Philippines 1987    64.2   2189.6350 0.991 64.1
1221              Philippines 1992    66.5   2279.3240 0.991 66.2
1222              Philippines 1997    68.6   2536.5349 0.991 68.3
1223              Philippines 2002    70.3   2650.9211 0.991 70.4
1224              Philippines 2007    71.7   3190.4810 0.991 72.5
1225                   Poland 1952    61.3   4029.3297 0.840 64.8
1226                   Poland 1957    65.8   4734.2530 0.840 65.8
1227                   Poland 1962    67.6   5338.7521 0.840 66.7
1228                   Poland 1967    69.6   6557.1528 0.840 67.7
1229                   Poland 1972    70.8   8006.5070 0.840 68.7
1230                   Poland 1977    70.7   9508.1415 0.840 69.7
1231                   Poland 1982    71.3   8451.5310 0.840 70.7
1232                   Poland 1987    71.0   9082.3512 0.840 71.6
1233                   Poland 1992    71.0   7738.8812 0.840 72.6
1234                   Poland 1997    72.8  10159.5837 0.840 73.6
1235                   Poland 2002    74.7  12002.2391 0.840 74.6
1236                   Poland 2007    75.6  15389.9247 0.840 75.6
1237                 Portugal 1952    59.8   3068.3199 0.969 61.1
1238                 Portugal 1957    61.5   3774.5717 0.969 62.8
1239                 Portugal 1962    64.4   4727.9549 0.969 64.5
1240                 Portugal 1967    66.6   6361.5180 0.969 66.2
1241                 Portugal 1972    69.3   9022.2474 0.969 67.9
1242                 Portugal 1977    70.4  10172.4857 0.969 69.6
1243                 Portugal 1982    72.8  11753.8429 0.969 71.3
1244                 Portugal 1987    74.1  13039.3088 0.969 72.9
1245                 Portugal 1992    74.9  16207.2666 0.969 74.6
1246                 Portugal 1997    76.0  17641.0316 0.969 76.3
1247                 Portugal 2002    77.3  19970.9079 0.969 78.0
1248                 Portugal 2007    78.1  20509.6478 0.969 79.7
1249              Puerto Rico 1952    64.3   3081.9598 0.908 66.9
1250              Puerto Rico 1957    68.5   3907.1562 0.908 68.0
1251              Puerto Rico 1962    69.6   5108.3446 0.908 69.1
1252              Puerto Rico 1967    71.1   6929.2777 0.908 70.1
1253              Puerto Rico 1972    72.2   9123.0417 0.908 71.2
1254              Puerto Rico 1977    73.4   9770.5249 0.908 72.2
1255              Puerto Rico 1982    73.8  10330.9891 0.908 73.3
1256              Puerto Rico 1987    74.6  12281.3419 0.908 74.3
1257              Puerto Rico 1992    73.9  14641.5871 0.908 75.4
1258              Puerto Rico 1997    74.9  16999.4333 0.908 76.4
1259              Puerto Rico 2002    77.8  18855.6062 0.908 77.5
1260              Puerto Rico 2007    78.7  19328.7090 0.908 78.5
1261                  Reunion 1952    52.7   2718.8853 0.966 54.0
1262                  Reunion 1957    55.1   2769.4518 0.966 56.3
1263                  Reunion 1962    57.7   3173.7233 0.966 58.6
1264                  Reunion 1967    60.5   4021.1757 0.966 60.9
1265                  Reunion 1972    64.3   5047.6586 0.966 63.2
1266                  Reunion 1977    67.1   4319.8041 0.966 65.5
1267                  Reunion 1982    69.9   5267.2194 0.966 67.8
1268                  Reunion 1987    71.9   5303.3775 0.966 70.1
1269                  Reunion 1992    73.6   6101.2558 0.966 72.4
1270                  Reunion 1997    74.8   6071.9414 0.966 74.7
1271                  Reunion 2002    75.7   6316.1652 0.966 77.0
1272                  Reunion 2007    76.4   7670.1226 0.966 79.3
1273                  Romania 1952    61.0   3144.6132 0.806 64.0
1274                  Romania 1957    64.1   3943.3702 0.806 64.7
1275                  Romania 1962    66.8   4734.9976 0.806 65.5
1276                  Romania 1967    66.8   6470.8665 0.806 66.3
1277                  Romania 1972    69.2   8011.4144 0.806 67.1
1278                  Romania 1977    69.5   9356.3972 0.806 67.9
1279                  Romania 1982    69.7   9605.3141 0.806 68.7
1280                  Romania 1987    69.5   9696.2733 0.806 69.5
1281                  Romania 1992    69.4   6598.4099 0.806 70.3
1282                  Romania 1997    69.7   7346.5476 0.806 71.0
1283                  Romania 2002    71.3   7885.3601 0.806 71.8
1284                  Romania 2007    72.5  10808.4756 0.806 72.6
1285                   Rwanda 1952    40.0    493.3239 0.017 42.7
1286                   Rwanda 1957    41.5    540.2894 0.017 42.5
1287                   Rwanda 1962    43.0    597.4731 0.017 42.3
1288                   Rwanda 1967    44.1    510.9637 0.017 42.1
1289                   Rwanda 1972    44.6    590.5807 0.017 41.8
1290                   Rwanda 1977    45.0    670.0806 0.017 41.6
1291                   Rwanda 1982    46.2    881.5706 0.017 41.4
1292                   Rwanda 1987    44.0    847.9912 0.017 41.1
1293                   Rwanda 1992    23.6    737.0686 0.017 40.9
1294                   Rwanda 1997    36.1    589.9445 0.017 40.7
1295                   Rwanda 2002    43.4    785.6538 0.017 40.5
1296                   Rwanda 2007    46.2    863.0885 0.017 40.2
1297    Sao Tome and Principe 1952    46.5    879.5836 0.955 48.5
1298    Sao Tome and Principe 1957    48.9    860.7369 0.955 50.2
1299    Sao Tome and Principe 1962    51.9   1071.5511 0.955 51.9
1300    Sao Tome and Principe 1967    54.4   1384.8406 0.955 53.6
1301    Sao Tome and Principe 1972    56.5   1532.9853 0.955 55.3
1302    Sao Tome and Principe 1977    58.5   1737.5617 0.955 57.0
1303    Sao Tome and Principe 1982    60.4   1890.2181 0.955 58.7
1304    Sao Tome and Principe 1987    61.7   1516.5255 0.955 60.5
1305    Sao Tome and Principe 1992    62.7   1428.7778 0.955 62.2
1306    Sao Tome and Principe 1997    63.3   1339.0760 0.955 63.9
1307    Sao Tome and Principe 2002    64.3   1353.0924 0.955 65.6
1308    Sao Tome and Principe 2007    65.5   1598.4351 0.955 67.3
1309             Saudi Arabia 1952    39.9   6459.5548 0.972 40.8
1310             Saudi Arabia 1957    42.9   8157.5912 0.972 44.1
1311             Saudi Arabia 1962    45.9  11626.4197 0.972 47.3
1312             Saudi Arabia 1967    49.9  16903.0489 0.972 50.6
1313             Saudi Arabia 1972    53.9  24837.4287 0.972 53.8
1314             Saudi Arabia 1977    58.7  34167.7626 0.972 57.1
1315             Saudi Arabia 1982    63.0  33693.1753 0.972 60.3
1316             Saudi Arabia 1987    66.3  21198.2614 0.972 63.6
1317             Saudi Arabia 1992    68.8  24841.6178 0.972 66.8
1318             Saudi Arabia 1997    70.5  20586.6902 0.972 70.0
1319             Saudi Arabia 2002    71.6  19014.5412 0.972 73.3
1320             Saudi Arabia 2007    72.8  21654.8319 0.972 76.5
1321                  Senegal 1952    37.3   1450.3570 0.991 36.7
1322                  Senegal 1957    39.3   1567.6530 0.991 39.3
1323                  Senegal 1962    41.5   1654.9887 0.991 41.8
1324                  Senegal 1967    43.6   1612.4046 0.991 44.3
1325                  Senegal 1972    45.8   1597.7121 0.991 46.8
1326                  Senegal 1977    48.9   1561.7691 0.991 49.4
1327                  Senegal 1982    52.4   1518.4800 0.991 51.9
1328                  Senegal 1987    55.8   1441.7207 0.991 54.4
1329                  Senegal 1992    58.2   1367.8994 0.991 56.9
1330                  Senegal 1997    60.2   1392.3683 0.991 59.5
1331                  Senegal 2002    61.6   1519.6353 0.991 62.0
1332                  Senegal 2007    63.1   1712.4721 0.991 64.5
1333                   Serbia 1952    58.0   3581.4594 0.879 61.5
1334                   Serbia 1957    61.7   4981.0909 0.879 62.8
1335                   Serbia 1962    64.5   6289.6292 0.879 64.1
1336                   Serbia 1967    66.9   7991.7071 0.879 65.4
1337                   Serbia 1972    68.7  10522.0675 0.879 66.6
1338                   Serbia 1977    70.3  12980.6696 0.879 67.9
1339                   Serbia 1982    70.2  15181.0927 0.879 69.2
1340                   Serbia 1987    71.2  15870.8785 0.879 70.5
1341                   Serbia 1992    71.7   9325.0682 0.879 71.7
1342                   Serbia 1997    72.2   7914.3203 0.879 73.0
1343                   Serbia 2002    73.2   7236.0753 0.879 74.3
1344                   Serbia 2007    74.0   9786.5347 0.879 75.6
1345             Sierra Leone 1952    30.3    879.7877 0.960 30.9
1346             Sierra Leone 1957    31.6   1004.4844 0.960 32.0
1347             Sierra Leone 1962    32.8   1116.6399 0.960 33.0
1348             Sierra Leone 1967    34.1   1206.0435 0.960 34.1
1349             Sierra Leone 1972    35.4   1353.7598 0.960 35.2
1350             Sierra Leone 1977    36.8   1348.2852 0.960 36.2
1351             Sierra Leone 1982    38.4   1465.0108 0.960 37.3
1352             Sierra Leone 1987    40.0   1294.4478 0.960 38.4
1353             Sierra Leone 1992    38.3   1068.6963 0.960 39.4
1354             Sierra Leone 1997    39.9    574.6482 0.960 40.5
1355             Sierra Leone 2002    41.0    699.4897 0.960 41.6
1356             Sierra Leone 2007    42.6    862.5408 0.960 42.7
1357                Singapore 1952    60.4   2315.1382 0.988 61.8
1358                Singapore 1957    63.2   2843.1044 0.988 63.6
1359                Singapore 1962    65.8   3674.7356 0.988 65.3
1360                Singapore 1967    67.9   4977.4185 0.988 67.0
1361                Singapore 1972    69.5   8597.7562 0.988 68.7
1362                Singapore 1977    70.8  11210.0895 0.988 70.4
1363                Singapore 1982    71.8  15169.1611 0.988 72.1
1364                Singapore 1987    73.6  18861.5308 0.988 73.8
1365                Singapore 1992    75.8  24769.8912 0.988 75.5
1366                Singapore 1997    77.2  33519.4766 0.988 77.2
1367                Singapore 2002    78.8  36023.1054 0.988 78.9
1368                Singapore 2007    80.0  47143.1796 0.988 80.6
1369          Slovak Republic 1952    64.4   5074.6591 0.792 67.0
1370          Slovak Republic 1957    67.4   6093.2630 0.792 67.7
1371          Slovak Republic 1962    70.3   7481.1076 0.792 68.4
1372          Slovak Republic 1967    71.0   8412.9024 0.792 69.0
1373          Slovak Republic 1972    70.3   9674.1676 0.792 69.7
1374          Slovak Republic 1977    70.4  10922.6640 0.792 70.4
1375          Slovak Republic 1982    70.8  11348.5459 0.792 71.0
1376          Slovak Republic 1987    71.1  12037.2676 0.792 71.7
1377          Slovak Republic 1992    71.4   9498.4677 0.792 72.4
1378          Slovak Republic 1997    72.7  12126.2306 0.792 73.0
1379          Slovak Republic 2002    73.8  13638.7784 0.792 73.7
1380          Slovak Republic 2007    74.7  18678.3144 0.792 74.4
1381                 Slovenia 1952    65.6   4215.0417 0.966 66.1
1382                 Slovenia 1957    67.8   5862.2766 0.966 67.1
1383                 Slovenia 1962    69.2   7402.3034 0.966 68.1
1384                 Slovenia 1967    69.2   9405.4894 0.966 69.1
1385                 Slovenia 1972    69.8  12383.4862 0.966 70.1
1386                 Slovenia 1977    71.0  15277.0302 0.966 71.1
1387                 Slovenia 1982    71.1  17866.7218 0.966 72.1
1388                 Slovenia 1987    72.2  18678.5349 0.966 73.1
1389                 Slovenia 1992    73.6  14214.7168 0.966 74.1
1390                 Slovenia 1997    75.1  17161.1073 0.966 75.1
1391                 Slovenia 2002    76.7  20660.0194 0.966 76.1
1392                 Slovenia 2007    77.9  25768.2576 0.966 77.1
1393                  Somalia 1952    33.0   1135.7498 0.844 34.7
1394                  Somalia 1957    35.0   1258.1474 0.844 35.8
1395                  Somalia 1962    37.0   1369.4883 0.844 37.0
1396                  Somalia 1967    39.0   1284.7332 0.844 38.1
1397                  Somalia 1972    41.0   1254.5761 0.844 39.3
1398                  Somalia 1977    42.0   1450.9925 0.844 40.4
1399                  Somalia 1982    43.0   1176.8070 0.844 41.6
1400                  Somalia 1987    44.5   1093.2450 0.844 42.7
1401                  Somalia 1992    39.7    926.9603 0.844 43.9
1402                  Somalia 1997    43.8    930.5964 0.844 45.0
1403                  Somalia 2002    45.9    882.0818 0.844 46.2
1404                  Somalia 2007    48.2    926.1411 0.844 47.3
1405             South Africa 1952    45.0   4725.2955 0.312 49.3
1406             South Africa 1957    48.0   5487.1042 0.312 50.2
1407             South Africa 1962    50.0   5768.7297 0.312 51.0
1408             South Africa 1967    51.9   7114.4780 0.312 51.9
1409             South Africa 1972    53.7   7765.9626 0.312 52.7
1410             South Africa 1977    55.5   8028.6514 0.312 53.6
1411             South Africa 1982    58.2   8568.2662 0.312 54.4
1412             South Africa 1987    60.8   7825.8234 0.312 55.3
1413             South Africa 1992    61.9   7225.0693 0.312 56.1
1414             South Africa 1997    60.2   7479.1882 0.312 57.0
1415             South Africa 2002    53.4   7710.9464 0.312 57.8
1416             South Africa 2007    49.3   9269.6578 0.312 58.6
1417                    Spain 1952    64.9   3834.0347 0.965 66.5
1418                    Spain 1957    66.7   4564.8024 0.965 67.9
1419                    Spain 1962    69.7   5693.8439 0.965 69.3
1420                    Spain 1967    71.4   7993.5123 0.965 70.7
1421                    Spain 1972    73.1  10638.7513 0.965 72.1
1422                    Spain 1977    74.4  13236.9212 0.965 73.5
1423                    Spain 1982    76.3  13926.1700 0.965 74.9
1424                    Spain 1987    76.9  15764.9831 0.965 76.3
1425                    Spain 1992    77.6  18603.0645 0.965 77.7
1426                    Spain 1997    78.8  20445.2990 0.965 79.1
1427                    Spain 2002    79.8  24835.4717 0.965 80.5
1428                    Spain 2007    80.9  28821.0637 0.965 81.9
1429                Sri Lanka 1952    57.6   1083.5320 0.948 59.8
1430                Sri Lanka 1957    61.5   1072.5466 0.948 61.0
1431                Sri Lanka 1962    62.2   1074.4720 0.948 62.2
1432                Sri Lanka 1967    64.3   1135.5143 0.948 63.5
1433                Sri Lanka 1972    65.0   1213.3955 0.948 64.7
1434                Sri Lanka 1977    65.9   1348.7757 0.948 65.9
1435                Sri Lanka 1982    68.8   1648.0798 0.948 67.1
1436                Sri Lanka 1987    69.0   1876.7668 0.948 68.4
1437                Sri Lanka 1992    70.4   2153.7392 0.948 69.6
1438                Sri Lanka 1997    70.5   2664.4773 0.948 70.8
1439                Sri Lanka 2002    70.8   3015.3788 0.948 72.0
1440                Sri Lanka 2007    72.4   3970.0954 0.948 73.3
1441                    Sudan 1952    38.6   1615.9911 0.992 37.9
1442                    Sudan 1957    39.6   1770.3371 0.992 39.8
1443                    Sudan 1962    40.9   1959.5938 0.992 41.7
1444                    Sudan 1967    42.9   1687.9976 0.992 43.6
1445                    Sudan 1972    45.1   1659.6528 0.992 45.5
1446                    Sudan 1977    47.8   2202.9884 0.992 47.4
1447                    Sudan 1982    50.3   1895.5441 0.992 49.4
1448                    Sudan 1987    51.7   1507.8192 0.992 51.3
1449                    Sudan 1992    53.6   1492.1970 0.992 53.2
1450                    Sudan 1997    55.4   1632.2108 0.992 55.1
1451                    Sudan 2002    56.4   1993.3983 0.992 57.0
1452                    Sudan 2007    58.6   2602.3950 0.992 58.9
1453                Swaziland 1952    41.4   1148.3766 0.068 46.4
1454                Swaziland 1957    43.4   1244.7084 0.068 46.9
1455                Swaziland 1962    45.0   1856.1821 0.068 47.3
1456                Swaziland 1967    46.6   2613.1017 0.068 47.8
1457                Swaziland 1972    49.6   3364.8366 0.068 48.3
1458                Swaziland 1977    52.5   3781.4106 0.068 48.8
1459                Swaziland 1982    55.6   3895.3840 0.068 49.2
1460                Swaziland 1987    57.7   3984.8398 0.068 49.7
1461                Swaziland 1992    58.5   3553.0224 0.068 50.2
1462                Swaziland 1997    54.3   3876.7685 0.068 50.7
1463                Swaziland 2002    43.9   4128.1169 0.068 51.1
1464                Swaziland 2007    39.6   4513.4806 0.068 51.6
1465                   Sweden 1952    71.9   8527.8447 0.995 71.6
1466                   Sweden 1957    72.5   9911.8782 0.995 72.4
1467                   Sweden 1962    73.4  12329.4419 0.995 73.3
1468                   Sweden 1967    74.2  15258.2970 0.995 74.1
1469                   Sweden 1972    74.7  17832.0246 0.995 74.9
1470                   Sweden 1977    75.4  18855.7252 0.995 75.8
1471                   Sweden 1982    76.4  20667.3812 0.995 76.6
1472                   Sweden 1987    77.2  23586.9293 0.995 77.4
1473                   Sweden 1992    78.2  23880.0168 0.995 78.3
1474                   Sweden 1997    79.4  25266.5950 0.995 79.1
1475                   Sweden 2002    80.0  29341.6309 0.995 79.9
1476                   Sweden 2007    80.9  33859.7484 0.995 80.7
1477              Switzerland 1952    69.6  14734.2327 0.997 69.5
1478              Switzerland 1957    70.6  17909.4897 0.997 70.6
1479              Switzerland 1962    71.3  20431.0927 0.997 71.7
1480              Switzerland 1967    72.8  22966.1443 0.997 72.8
1481              Switzerland 1972    73.8  27195.1130 0.997 73.9
1482              Switzerland 1977    75.4  26982.2905 0.997 75.0
1483              Switzerland 1982    76.2  28397.7151 0.997 76.1
1484              Switzerland 1987    77.4  30281.7046 0.997 77.2
1485              Switzerland 1992    78.0  31871.5303 0.997 78.3
1486              Switzerland 1997    79.4  32135.3230 0.997 79.5
1487              Switzerland 2002    80.6  34480.9577 0.997 80.6
1488              Switzerland 2007    81.7  37506.4191 0.997 81.7
1489                    Syria 1952    45.9   1643.4854 0.984 46.1
1490                    Syria 1957    48.3   2117.2349 0.984 48.9
1491                    Syria 1962    50.3   2193.0371 0.984 51.6
1492                    Syria 1967    53.7   1881.9236 0.984 54.4
1493                    Syria 1972    57.3   2571.4230 0.984 57.2
1494                    Syria 1977    61.2   3195.4846 0.984 60.0
1495                    Syria 1982    64.6   3761.8377 0.984 62.7
1496                    Syria 1987    67.0   3116.7743 0.984 65.5
1497                    Syria 1992    69.2   3340.5428 0.984 68.3
1498                    Syria 1997    71.5   4014.2390 0.984 71.0
1499                    Syria 2002    73.1   4090.9253 0.984 73.8
1500                    Syria 2007    74.1   4184.5481 0.984 76.6
1501                   Taiwan 1952    58.5   1206.9479 0.957 61.3
1502                   Taiwan 1957    62.4   1507.8613 0.957 63.0
1503                   Taiwan 1962    65.2   1822.8790 0.957 64.6
1504                   Taiwan 1967    67.5   2643.8587 0.957 66.2
1505                   Taiwan 1972    69.4   4062.5239 0.957 67.9
1506                   Taiwan 1977    70.6   5596.5198 0.957 69.5
1507                   Taiwan 1982    72.2   7426.3548 0.957 71.2
1508                   Taiwan 1987    73.4  11054.5618 0.957 72.8
1509                   Taiwan 1992    74.3  15215.6579 0.957 74.4
1510                   Taiwan 1997    75.2  20206.8210 0.957 76.1
1511                   Taiwan 2002    77.0  23235.4233 0.957 77.7
1512                   Taiwan 2007    78.4  28718.2768 0.957 79.3
1513                 Tanzania 1952    41.2    716.6501 0.764 43.1
1514                 Tanzania 1957    43.0    698.5356 0.764 44.0
1515                 Tanzania 1962    44.2    722.0038 0.764 44.9
1516                 Tanzania 1967    45.8    848.2187 0.764 45.7
1517                 Tanzania 1972    47.6    915.9851 0.764 46.6
1518                 Tanzania 1977    49.9    962.4923 0.764 47.5
1519                 Tanzania 1982    50.6    874.2426 0.764 48.3
1520                 Tanzania 1987    51.5    831.8221 0.764 49.2
1521                 Tanzania 1992    50.4    825.6825 0.764 50.1
1522                 Tanzania 1997    48.5    789.1862 0.764 51.0
1523                 Tanzania 2002    49.7    899.0742 0.764 51.8
1524                 Tanzania 2007    52.5   1107.4822 0.764 52.7
1525                 Thailand 1952    50.8    757.7974 0.967 52.7
1526                 Thailand 1957    53.6    793.5774 0.967 54.4
1527                 Thailand 1962    56.1   1002.1992 0.967 56.1
1528                 Thailand 1967    58.3   1295.4607 0.967 57.9
1529                 Thailand 1972    60.4   1524.3589 0.967 59.6
1530                 Thailand 1977    62.5   1961.2246 0.967 61.3
1531                 Thailand 1982    64.6   2393.2198 0.967 63.1
1532                 Thailand 1987    66.1   2982.6538 0.967 64.8
1533                 Thailand 1992    67.3   4616.8965 0.967 66.5
1534                 Thailand 1997    67.5   5852.6255 0.967 68.3
1535                 Thailand 2002    68.6   5913.1875 0.967 70.0
1536                 Thailand 2007    70.6   7458.3963 0.967 71.7
1537                     Togo 1952    38.6    859.8087 0.906 41.0
1538                     Togo 1957    41.2    925.9083 0.906 42.9
1539                     Togo 1962    43.9   1067.5348 0.906 44.8
1540                     Togo 1967    46.8   1477.5968 0.906 46.7
1541                     Togo 1972    49.8   1649.6602 0.906 48.6
1542                     Togo 1977    52.9   1532.7770 0.906 50.5
1543                     Togo 1982    55.5   1344.5780 0.906 52.5
1544                     Togo 1987    56.9   1202.2014 0.906 54.4
1545                     Togo 1992    58.1   1034.2989 0.906 56.3
1546                     Togo 1997    58.4    982.2869 0.906 58.2
1547                     Togo 2002    57.6    886.2206 0.906 60.1
1548                     Togo 2007    58.4    882.9699 0.906 62.0
1549      Trinidad and Tobago 1952    59.1   3023.2719 0.798 62.1
1550      Trinidad and Tobago 1957    61.8   4100.3934 0.798 62.9
1551      Trinidad and Tobago 1962    64.9   4997.5240 0.798 63.8
1552      Trinidad and Tobago 1967    65.4   5621.3685 0.798 64.7
1553      Trinidad and Tobago 1972    65.9   6619.5514 0.798 65.5
1554      Trinidad and Tobago 1977    68.3   7899.5542 0.798 66.4
1555      Trinidad and Tobago 1982    68.8   9119.5286 0.798 67.3
1556      Trinidad and Tobago 1987    69.6   7388.5978 0.798 68.1
1557      Trinidad and Tobago 1992    69.9   7370.9909 0.798 69.0
1558      Trinidad and Tobago 1997    69.5   8792.5731 0.798 69.9
1559      Trinidad and Tobago 2002    69.0  11460.6002 0.798 70.7
1560      Trinidad and Tobago 2007    69.8  18008.5092 0.798 71.6
1561                  Tunisia 1952    44.6   1468.4756 0.981 44.6
1562                  Tunisia 1957    47.1   1395.2325 0.981 47.5
1563                  Tunisia 1962    49.6   1660.3032 0.981 50.4
1564                  Tunisia 1967    52.1   1932.3602 0.981 53.4
1565                  Tunisia 1972    55.6   2753.2860 0.981 56.3
1566                  Tunisia 1977    59.8   3120.8768 0.981 59.3
1567                  Tunisia 1982    64.0   3560.2332 0.981 62.2
1568                  Tunisia 1987    66.9   3810.4193 0.981 65.1
1569                  Tunisia 1992    70.0   4332.7202 0.981 68.1
1570                  Tunisia 1997    72.0   4876.7986 0.981 71.0
1571                  Tunisia 2002    73.0   5722.8957 0.981 73.9
1572                  Tunisia 2007    73.9   7092.9230 0.981 76.9
1573                   Turkey 1952    43.6   1969.1010 0.985 46.0
1574                   Turkey 1957    48.1   2218.7543 0.985 48.5
1575                   Turkey 1962    52.1   2322.8699 0.985 51.0
1576                   Turkey 1967    54.3   2826.3564 0.985 53.5
1577                   Turkey 1972    57.0   3450.6964 0.985 56.0
1578                   Turkey 1977    59.5   4269.1223 0.985 58.5
1579                   Turkey 1982    61.0   4241.3563 0.985 60.9
1580                   Turkey 1987    63.1   5089.0437 0.985 63.4
1581                   Turkey 1992    66.1   5678.3483 0.985 65.9
1582                   Turkey 1997    68.8   6601.4299 0.985 68.4
1583                   Turkey 2002    70.8   6508.0857 0.985 70.9
1584                   Turkey 2007    71.8   8458.2764 0.985 73.4
1585                   Uganda 1952    40.0    734.7535 0.342 44.3
1586                   Uganda 1957    42.6    774.3711 0.342 44.9
1587                   Uganda 1962    45.3    767.2717 0.342 45.5
1588                   Uganda 1967    48.1    908.9185 0.342 46.1
1589                   Uganda 1972    51.0    950.7359 0.342 46.7
1590                   Uganda 1977    50.4    843.7331 0.342 47.3
1591                   Uganda 1982    49.8    682.2662 0.342 47.9
1592                   Uganda 1987    51.5    617.7244 0.342 48.5
1593                   Uganda 1992    48.8    644.1708 0.342 49.1
1594                   Uganda 1997    44.6    816.5591 0.342 49.7
1595                   Uganda 2002    47.8    927.7210 0.342 50.4
1596                   Uganda 2007    51.5   1056.3801 0.342 51.0
1597           United Kingdom 1952    69.2   9979.5085 0.984 68.8
1598           United Kingdom 1957    70.4  11283.1779 0.984 69.7
1599           United Kingdom 1962    70.8  12477.1771 0.984 70.7
1600           United Kingdom 1967    71.4  14142.8509 0.984 71.6
1601           United Kingdom 1972    72.0  15895.1164 0.984 72.5
1602           United Kingdom 1977    72.8  17428.7485 0.984 73.5
1603           United Kingdom 1982    74.0  18232.4245 0.984 74.4
1604           United Kingdom 1987    75.0  21664.7877 0.984 75.3
1605           United Kingdom 1992    76.4  22705.0925 0.984 76.2
1606           United Kingdom 1997    77.2  26074.5314 0.984 77.2
1607           United Kingdom 2002    78.5  29478.9992 0.984 78.1
1608           United Kingdom 2007    79.4  33203.2613 0.984 79.0
1609            United States 1952    68.4  13990.4821 0.986 68.4
1610            United States 1957    69.5  14847.1271 0.986 69.3
1611            United States 1962    70.2  16173.1459 0.986 70.3
1612            United States 1967    70.8  19530.3656 0.986 71.2
1613            United States 1972    71.3  21806.0359 0.986 72.1
1614            United States 1977    73.4  24072.6321 0.986 73.0
1615            United States 1982    74.7  25009.5591 0.986 73.9
1616            United States 1987    75.0  29884.3504 0.986 74.9
1617            United States 1992    76.1  32003.9322 0.986 75.8
1618            United States 1997    76.8  35767.4330 0.986 76.7
1619            United States 2002    77.3  39097.0995 0.986 77.6
1620            United States 2007    78.2  42951.6531 0.986 78.5
1621                  Uruguay 1952    66.1   5716.7667 0.977 65.7
1622                  Uruguay 1957    67.0   6150.7730 0.977 66.7
1623                  Uruguay 1962    68.3   5603.3577 0.977 67.6
1624                  Uruguay 1967    68.5   5444.6196 0.977 68.5
1625                  Uruguay 1972    68.7   5703.4089 0.977 69.4
1626                  Uruguay 1977    69.5   6504.3397 0.977 70.3
1627                  Uruguay 1982    70.8   6920.2231 0.977 71.2
1628                  Uruguay 1987    71.9   7452.3990 0.977 72.2
1629                  Uruguay 1992    72.8   8137.0048 0.977 73.1
1630                  Uruguay 1997    74.2   9230.2407 0.977 74.0
1631                  Uruguay 2002    75.3   7727.0020 0.977 74.9
1632                  Uruguay 2007    76.4  10611.4630 0.977 75.8
1633                Venezuela 1952    55.1   7689.7998 0.947 57.5
1634                Venezuela 1957    57.9   9802.4665 0.947 59.2
1635                Venezuela 1962    60.8   8422.9742 0.947 60.8
1636                Venezuela 1967    63.5   9541.4742 0.947 62.5
1637                Venezuela 1972    65.7  10505.2597 0.947 64.1
1638                Venezuela 1977    67.5  13143.9510 0.947 65.8
1639                Venezuela 1982    68.6  11152.4101 0.947 67.4
1640                Venezuela 1987    70.2   9883.5846 0.947 69.1
1641                Venezuela 1992    71.2  10733.9263 0.947 70.7
1642                Venezuela 1997    72.1  10165.4952 0.947 72.4
1643                Venezuela 2002    72.8   8605.0478 0.947 74.0
1644                Venezuela 2007    73.7  11415.8057 0.947 75.6
1645                  Vietnam 1952    40.4    605.0665 0.989 39.0
1646                  Vietnam 1957    42.9    676.2854 0.989 42.4
1647                  Vietnam 1962    45.4    772.0492 0.989 45.7
1648                  Vietnam 1967    47.8    637.1233 0.989 49.1
1649                  Vietnam 1972    50.3    699.5016 0.989 52.4
1650                  Vietnam 1977    55.8    713.5371 0.989 55.8
1651                  Vietnam 1982    58.8    707.2358 0.989 59.2
1652                  Vietnam 1987    62.8    820.7994 0.989 62.5
1653                  Vietnam 1992    67.7    989.0231 0.989 65.9
1654                  Vietnam 1997    70.7   1385.8968 0.989 69.2
1655                  Vietnam 2002    73.0   1764.4567 0.989 72.6
1656                  Vietnam 2007    74.2   2441.5764 0.989 75.9
1657       West Bank and Gaza 1952    43.2   1515.5923 0.970 43.8
1658       West Bank and Gaza 1957    45.7   1827.0677 0.970 46.8
1659       West Bank and Gaza 1962    48.1   2198.9563 0.970 49.8
1660       West Bank and Gaza 1967    51.6   2649.7150 0.970 52.8
1661       West Bank and Gaza 1972    56.5   3133.4093 0.970 55.8
1662       West Bank and Gaza 1977    60.8   3682.8315 0.970 58.8
1663       West Bank and Gaza 1982    64.4   4336.0321 0.970 61.8
1664       West Bank and Gaza 1987    67.0   5107.1974 0.970 64.8
1665       West Bank and Gaza 1992    69.7   6017.6548 0.970 67.8
1666       West Bank and Gaza 1997    71.1   7110.6676 0.970 70.8
1667       West Bank and Gaza 2002    72.4   4515.4876 0.970 73.9
1668       West Bank and Gaza 2007    73.4   3025.3498 0.970 76.9
1669              Yemen, Rep. 1952    32.5    781.7176 0.981 30.1
1670              Yemen, Rep. 1957    34.0    804.8305 0.981 33.2
1671              Yemen, Rep. 1962    35.2    825.6232 0.981 36.2
1672              Yemen, Rep. 1967    37.0    862.4421 0.981 39.2
1673              Yemen, Rep. 1972    39.8   1265.0470 0.981 42.2
1674              Yemen, Rep. 1977    44.2   1829.7652 0.981 45.3
1675              Yemen, Rep. 1982    49.1   1977.5570 0.981 48.3
1676              Yemen, Rep. 1987    52.9   1971.7415 0.981 51.3
1677              Yemen, Rep. 1992    55.6   1879.4967 0.981 54.3
1678              Yemen, Rep. 1997    58.0   2117.4845 0.981 57.4
1679              Yemen, Rep. 2002    60.3   2234.8208 0.981 60.4
1680              Yemen, Rep. 2007    62.7   2280.7699 0.981 63.4
1681                   Zambia 1952    42.0   1147.3888 0.060 47.7
1682                   Zambia 1957    44.1   1311.9568 0.060 47.4
1683                   Zambia 1962    46.0   1452.7258 0.060 47.1
1684                   Zambia 1967    47.8   1777.0773 0.060 46.8
1685                   Zambia 1972    50.1   1773.4983 0.060 46.4
1686                   Zambia 1977    51.4   1588.6883 0.060 46.1
1687                   Zambia 1982    51.8   1408.6786 0.060 45.8
1688                   Zambia 1987    50.8   1213.3151 0.060 45.5
1689                   Zambia 1992    46.1   1210.8846 0.060 45.2
1690                   Zambia 1997    40.2   1071.3538 0.060 44.9
1691                   Zambia 2002    39.2   1071.6139 0.060 44.6
1692                   Zambia 2007    42.4   1271.2116 0.060 44.3
1693                 Zimbabwe 1952    48.5    406.8841 0.056 55.2
1694                 Zimbabwe 1957    50.5    518.7643 0.056 54.8
1695                 Zimbabwe 1962    52.4    527.2722 0.056 54.3
1696                 Zimbabwe 1967    54.0    569.7951 0.056 53.8
1697                 Zimbabwe 1972    55.6    799.3622 0.056 53.4
1698                 Zimbabwe 1977    57.7    685.5877 0.056 52.9
1699                 Zimbabwe 1982    60.4    788.8550 0.056 52.4
1700                 Zimbabwe 1987    62.4    706.1573 0.056 52.0
1701                 Zimbabwe 1992    60.4    693.4208 0.056 51.5
1702                 Zimbabwe 1997    46.8    792.4500 0.056 51.0
1703                 Zimbabwe 2002    40.0    672.0386 0.056 50.6
1704                 Zimbabwe 2007    43.5    469.7093 0.056 50.1</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="" aria-hidden="true" tabindex="-1"></a>poorfit<span class="ot">=</span> <span class="fu">filter</span>(coef_gmu, R2 <span class="sc">&lt;</span> <span class="fl">0.25</span>) <span class="co">#countries with low R2</span></span>
<span id="cb112-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(poorfit) <span class="sc">+</span></span>
<span id="cb112-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(year, lifeExp)) <span class="sc">+</span></span>
<span id="cb112-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(year, pred), <span class="at">col=</span><span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_basicmodels_files/figure-revealjs/unnamed-chunk-70-1.png" width="960" class="r-stretch"><p>Can you explain any of these patterns?</p>
</section></section>
<section>
<section id="summary-of-useful-functions" class="title-slide slide level1 center">
<h1>Summary of useful functions</h1>

</section>
<section id="useful-functions" class="slide level2">
<h2>Useful functions</h2>
<ul>
<li><p>Fitting the model: <code>lm</code>, <code>predict</code>, <code>residuals</code></p></li>
<li><p>Extract inference from fitted model: <code>summary</code>, <code>confint</code></p></li>
<li><p>Plot coefficients: <code>coefplot</code>, <code>multiplot</code></p></li>
<li><p>Plot predictions: <code>data_grid</code>, <code>add_predictions</code></p></li>
<li><p>Diagnostics: <code>geom_smooth</code>, <code>geom_boxplot</code>, <code>geom_qq</code></p></li>
</ul>
</section></section>
<section>
<section id="exercise-1" class="title-slide slide level1 center">
<h1>Exercise</h1>
<p>Select 3 countries, create factor <code>country</code> with 3 levels. Create <code>years_since_1952</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb113-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb113-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../code/routines.R"</span>)</span>
<span id="cb113-4"><a href="" aria-hidden="true" tabindex="-1"></a>gm3<span class="ot">=</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb113-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'France'</span>,<span class="st">'Italy'</span>,<span class="st">'Spain'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb113-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">country=</span> <span class="fu">factor</span>(country), <span class="at">years_since_1952=</span> year <span class="sc">-</span> <span class="dv">1952</span>)</span>
<span id="cb113-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> years_since_1952 <span class="sc">+</span> country, <span class="at">data=</span>gm3)</span>
<span id="cb113-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  Parameter        Estimate `Conf. Int.`    `P-value`
  &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;    
1 (Intercept)        67.1   (66.551,67.679) &lt;0.00001 
2 years_since_1952    0.263 (0.249,0.277)   &lt;0.00001 
3 countryItaly       -0.335 (-0.922,0.252)  0.25348  
4 countrySpain       -0.145 (-0.732,0.441)  0.61706  </code></pre>
</div>
</div>
<ul>
<li><p>For France: <span class="math inline">\(E(y_i)= \beta_0 + \beta_1 (\mbox{year}_i - 1952)\)</span></p></li>
<li><p>For Italy: <span class="math inline">\(E(y_i)= \beta_0 + \beta_2 + \beta_1 (\mbox{year}_i - 1952)\)</span></p></li>
</ul>
<p>How do we interpret <span class="math inline">\(\beta_0\)</span>? And <span class="math inline">\(\beta_0 + \beta_2\)</span>?</p>
</section>
<section class="slide level2">

<p><code>country</code> has 3 levels. <code>contrasts</code> shows how they’re coded</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gm3<span class="sc">$</span>country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "France" "Italy"  "Spain" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(gm3<span class="sc">$</span>country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Italy Spain
France     0     0
Italy      1     0
Spain      0     1</code></pre>
</div>
</div>
<p>Recall that <span class="math inline">\(x_{i1}\)</span> is the year. Internally R defines</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
x_{i2}= \begin{cases} 1 \mbox{, if country}_i=\mbox{Italy} \\ 0 \mbox{, else} \end{cases}
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
x_{i3}= \begin{cases} 1 \mbox{, if country}_i=\mbox{Spain} \\ 0 \mbox{, else} \end{cases}
\]</span></p>
</div></div>
<p>Alternative to 0/1 coding: <strong>sum-to-zero constraint</strong>. In our example</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
x_{i2}= \begin{cases} 1 \mbox{, if country}_i=\mbox{France} \\ -1 \mbox{, if country}_i=\mbox{Spain} \\ 0 \mbox{, else} \end{cases}
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
x_{i3}= \begin{cases} 1 \mbox{, if country}_i=\mbox{Italy} \\ -1 \mbox{, if country}_i=\mbox{Spain}  \\ 0 \mbox{, else} \end{cases}
\]</span></p>
</div></div>
</section>
<section class="slide level2">

<p>sum-to-zero coding can be done with <code>contrasts</code> and <code>contr.sum</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">contr.sum</span>(<span class="fu">levels</span>(gm3<span class="sc">$</span>country)) <span class="co">#check what the sum-to-zero codes look like</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1] [,2]
France    1    0
Italy     0    1
Spain    -1   -1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="" aria-hidden="true" tabindex="-1"></a>gm3<span class="sc">$</span>country0<span class="ot">=</span> gm3<span class="sc">$</span>country <span class="co">#create new variable</span></span>
<span id="cb121-2"><a href="" aria-hidden="true" tabindex="-1"></a>c0<span class="ot">=</span> <span class="fu">contr.sum</span>(<span class="fu">levels</span>(gm3<span class="sc">$</span>country0)) <span class="co">#tell contr.sum the factor levels</span></span>
<span id="cb121-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(c0)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">'France'</span>,<span class="st">'Italy'</span>)   <span class="co">#set column names to facilitate interpreting coef.</span></span>
<span id="cb121-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(gm3<span class="sc">$</span>country0) <span class="ot">=</span> c0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s fit the model with the new coding</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> years_since_1952 <span class="sc">+</span> country0, <span class="at">data=</span>gm3)</span>
<span id="cb122-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">coefSummary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  Parameter        Estimate `Conf. Int.`    `P-value`
  &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;    
1 (Intercept)        67.0   (66.504,67.406) &lt;0.00001 
2 years_since_1952    0.263 (0.249,0.277)   &lt;0.00001 
3 country0France      0.16  (-0.179,0.499)  0.34281  
4 country0Italy      -0.175 (-0.514,0.164)  0.30103  </code></pre>
</div>
</div>
<p>Results for <span class="math inline">\(\beta_1\)</span> (years) as before. Different for <span class="math inline">\((\hat{\beta}_0, \hat{\beta}_2, \hat{\beta}_3)\)</span></p>
</section>
<section id="interpretation" class="slide level2">
<h2>Interpretation</h2>
<p><span class="math display">\[
E(y_i)= \beta_0 + \beta_1 (x_{i1} - 1952) + \beta_2 x_{i2} + \beta_3 x_{i3}
\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
x_{i2}= \begin{cases} 1 \mbox{, if country}_i=\mbox{France} \\ -1 \mbox{, if country}_i=\mbox{Spain} \\ 0 \mbox{, else} \end{cases}
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
x_{i3}= \begin{cases} 1 \mbox{, if country}_i=\mbox{Italy} \\ -1 \mbox{, if country}_i=\mbox{Spain}  \\ 0 \mbox{, else} \end{cases}
\]</span></p>
</div></div>
<ul>
<li><p>For France: <span class="math inline">\(E(y_i)= \beta_0 + \beta_2 + \beta_1 (x_{i1} - 1952)\)</span></p></li>
<li><p>For Italy: <span class="math inline">\(E(y_i)= \beta_0 + \beta_3 + \beta_1 (x_{i1} - 1952)\)</span></p></li>
<li><p>For Spain: <span class="math inline">\(E(y_i)= \beta_0 - \beta_2 - \beta_3 + \beta_1 (x_{i1} - 1952)\)</span></p></li>
<li><p>Average across countries: <span class="math inline">\(E(y_i)= \beta_0 + \beta_1 (x_{i1} - 1952)\)</span></p></li>
</ul>
<p><span class="math inline">\(\beta_0\)</span> is the mean life exp. at 1952 across countries</p>
<p><span class="math inline">\(\beta_2\)</span> is France’s deviation from that mean. <span class="math inline">\(\beta_3\)</span> is Italy’s. <span class="math inline">\(-\beta_2 - \beta_3\)</span> is Spain’s</p>
</section>
<section id="exercise-2" class="slide level2">
<h2>Exercise</h2>
<p>Fit a model with interactions with the 0/1 coding and with the sum-to-zero coding. Interpret the estimated parameter values from each model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="" aria-hidden="true" tabindex="-1"></a>fit3<span class="ot">=</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> years_since_1952 <span class="sc">+</span> country <span class="sc">+</span> years_since_1952<span class="sc">:</span>country, <span class="at">data=</span>gm3)</span>
<span id="cb124-2"><a href="" aria-hidden="true" tabindex="-1"></a>fit4<span class="ot">=</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> years_since_1952 <span class="sc">+</span> country0 <span class="sc">+</span> years_since_1952<span class="sc">:</span>country0, <span class="at">data=</span>gm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="05_basicmodels_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="05_basicmodels_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="05_basicmodels_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="05_basicmodels_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>